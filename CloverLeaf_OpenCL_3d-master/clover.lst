


PGF90 (Version     13.5)          07/18/2014  14:45:11      page 1

Switches: -noasm -nodclchk -debug -nodlines -line -list
          -idir /usr/mpi/pgi/mvapich2-1.7-qlc/include
          -idir /usr/mpi/pgi/mvapich2-1.7-qlc/include
          -inform severe -opt 2 -nosave -object -noonetrip
          -depchk on -nostandard     
          -symbol -noupcase    

Filename: clover.f90

(    1) !Crown Copyright 2012 AWE.
(    2) !
(    3) ! This file is part of CloverLeaf.
(    4) !
(    5) ! CloverLeaf is free software: you can redistribute it and/or modify it under 
(    6) ! the terms of the GNU General Public License as published by the 
(    7) ! Free Software Foundation, either version 3 of the License, or (at your option) 
(    8) ! any later version.
(    9) !
(   10) ! CloverLeaf is distributed in the hope that it will be useful, but 
(   11) ! WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or 
(   12) ! FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more 
(   13) ! details.
(   14) !
(   15) ! You should have received a copy of the GNU General Public License along with 
(   16) ! CloverLeaf. If not, see http://www.gnu.org/licenses/.
(   17) 
(   18) !>  @brief Communication Utilities
(   19) !>  @author Wayne Gaudin, Ollie Perks
(   20) !>  @details Contains all utilities required to run CloverLeaf in a distributed
(   21) !>  environment, including initialisation, mesh decompostion, reductions and
(   22) !>  halo exchange using explicit buffers.
(   23) !>
(   24) !>  Note the halo exchange is currently coded as simply as possible and no 
(   25) !>  optimisations have been implemented, such as post receives before sends or packing
(   26) !>  buffers with multiple data fields. This is intentional so the effect of these
(   27) !>  optimisations can be measured on large systems, as and when they are added.
(   28) !>
(   29) !>  Even without these modifications CloverLeaf weak scales well on moderately sized
(   30) !>  systems of the order of 10K cores.
(   31) 
(   32) MODULE clover_module
(   33) 
(   34)   USE data_module
(   35)   USE definitions_module
(   36)   USE MPI
(   37) 
(   38)   IMPLICIT NONE
(   39) 
(   40) CONTAINS
(   41) 
(   42) SUBROUTINE clover_barrier
(   43) 
(   44)   INTEGER :: err
(   45) 
(   46)   CALL MPI_BARRIER(MPI_COMM_WORLD,err)
(   47) 
(   48) END SUBROUTINE clover_barrier
(   49) 
(   50) SUBROUTINE clover_abort






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 2

(   51) 
(   52)   INTEGER :: ierr,err
(   53) 
(   54)   CALL MPI_ABORT(MPI_COMM_WORLD,ierr,err)
(   55) 
(   56) END SUBROUTINE clover_abort
(   57) 
(   58) SUBROUTINE clover_finalize
(   59) 
(   60)   INTEGER :: err
(   61) 
(   62)   CLOSE(g_out)
(   63)   CALL FLUSH(0)
(   64)   CALL FLUSH(6)
(   65)   CALL FLUSH(g_out)
(   66)   CALL MPI_FINALIZE(err)
(   67) 
(   68) END SUBROUTINE clover_finalize
(   69) 
(   70) SUBROUTINE clover_init_comms
(   71) 
(   72)   IMPLICIT NONE
(   73) 
(   74)   INTEGER :: err,rank,size
(   75) 
(   76)   rank=0
(   77)   size=1
(   78) 
(   79)   CALL MPI_INIT(err) 
(   80) 
(   81)   CALL MPI_COMM_RANK(MPI_COMM_WORLD,rank,err) 
(   82)   CALL MPI_COMM_SIZE(MPI_COMM_WORLD,size,err) 
(   83) 
(   84)   parallel%parallel=.TRUE.
(   85)   parallel%task=rank
(   86) 
(   87)   IF(rank.EQ.0) THEN
(   88)     parallel%boss=.TRUE.
(   89)   ENDIF
(   90) 
(   91)   parallel%boss_task=0
(   92)   parallel%max_task=size
(   93) 
(   94) END SUBROUTINE clover_init_comms
(   95) 
(   96) SUBROUTINE clover_get_num_chunks(count)
(   97) 
(   98)   IMPLICIT NONE
(   99) 
(  100)   INTEGER :: count
(  101) 
(  102) ! Should be changed so there can be more than one chunk per mpi task
(  103) 
(  104)   count=parallel%max_task
(  105) 
(  106) END SUBROUTINE clover_get_num_chunks
(  107) 
(  108) SUBROUTINE clover_decompose(x_cells,y_cells,z_cells,left,right,bottom,top,back,front)






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 3

(  109) 
(  110)   ! This decomposes the mesh into a number of chunks.
(  111)   ! The number of chunks may be a multiple of the number of mpi tasks
(  112)   ! Picks split with minimal surface area to volume ratio
(  113) 
(  114)   IMPLICIT NONE
(  115) 
(  116)   INTEGER :: x_cells,y_cells,z_cells,left(:),right(:),top(:),bottom(:),back(:),front(:)
(  117)   INTEGER :: c,delta_x,delta_y,delta_z
(  118) 
(  119)   REAL(KIND=8) :: surface,volume,best_metric,current_metric
(  120)   INTEGER  :: chunk_x,chunk_y,chunk_z,mod_x,mod_y,mod_z
(  121) 
(  122)   INTEGER  :: cx,cy,cz,chunk,add_x,add_y,add_z,add_x_prev,add_y_prev,add_z_prev
(  123)   INTEGER  :: div1,j,current_x,current_y,current_z
(  124) 
(  125)   ! 3D Decomposition of the mesh
(  126) 
(  127)   current_x = 1
(  128)   current_y = 1
(  129)   current_z = number_of_chunks
(  130) 
(  131)   ! Initialise metric
(  132)   surface = (((1.0*x_cells)/current_x)*((1.0*y_cells)/current_y)*2) &
(  133)           + (((1.0*x_cells)/current_x)*((1.0*z_cells)/current_z)*2) &
(  134)           + (((1.0*y_cells)/current_y)*((1.0*z_cells)/current_z)*2)
(  135)   volume  = ((1.0*x_cells)/current_x)*((1.0*y_cells)/current_y)*((1.0*z_cells)/current_z)
(  136)   best_metric = surface/volume
(  137)   chunk_x=current_x
(  138)   chunk_y=current_y
(  139)   chunk_z=current_z
(  140) 
(  141)   DO c=1,number_of_chunks
(  142) 
(  143)     ! If doesn't evenly divide loop
(  144)     IF(MOD(number_of_chunks,c).NE.0) CYCLE
(  145) 
(  146)     current_x=c
(  147) 
(  148)     div1 = number_of_chunks/c
(  149) 
(  150)     DO j=1,div1
(  151)       IF(MOD(div1,j).NE.0) CYCLE
(  152)       current_y = j
(  153) 
(  154)       IF(MOD(number_of_chunks,(c*j)).NE.0) CYCLE
(  155) 
(  156)       current_z = number_of_chunks/(c*j)
(  157) 
(  158)       surface = (((1.0*x_cells)/current_x)*((1.0*y_cells)/current_y)*2) &
(  159)               + (((1.0*x_cells)/current_x)*((1.0*z_cells)/current_z)*2) &
(  160)               + (((1.0*y_cells)/current_y)*((1.0*z_cells)/current_z)*2)
(  161)       volume  = ((1.0*x_cells)/current_x)*((1.0*y_cells)/current_y)*((1.0*z_cells)/current_z)
(  162) 
(  163)       current_metric = surface/volume
(  164) 
(  165)       IF(current_metric < best_metric) THEN
(  166)         chunk_x=current_x






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 4

(  167)         chunk_y=current_y
(  168)         chunk_z=current_z
(  169)         best_metric=current_metric
(  170)       ENDIF
(  171) 
(  172)     ENDDO
(  173) 
(  174)   ENDDO
(  175) 
(  176)   ! Set up chunk mesh ranges and chunk connectivity
(  177) 
(  178)   delta_x=x_cells/chunk_x
(  179)   delta_y=y_cells/chunk_y
(  180)   delta_z=z_cells/chunk_z
(  181)   mod_x=MOD(x_cells,chunk_x)
(  182)   mod_y=MOD(y_cells,chunk_y)
(  183)   mod_z=MOD(z_cells,chunk_z)
(  184)   add_x_prev=0
(  185)   add_y_prev=0
(  186)   add_z_prev=0
(  187)   chunk=1
(  188)   DO cz=1,chunk_z
(  189)     DO cy=1,chunk_y
(  190)       DO cx=1,chunk_x
(  191)         add_x=0
(  192)         add_y=0
(  193)         add_z=0
(  194)         IF(cx.LE.mod_x)add_x=1
(  195)         IF(cy.LE.mod_y)add_y=1
(  196)         IF(cz.LE.mod_z)add_z=1
(  197)         IF (chunk .EQ. parallel%task+1) THEN
(  198)           ! Mesh chunks
(  199)           left(1)=(cx-1)*delta_x+1+add_x_prev
(  200)           right(1)=left(1)+delta_x-1+add_x
(  201)           bottom(1)=(cy-1)*delta_y+1+add_y_prev
(  202)           top(1)=bottom(1)+delta_y-1+add_y
(  203)           back(1)=(cz-1)*delta_z+1+add_z_prev
(  204)           front(1)=back(1)+delta_z-1+add_z
(  205)           ! Chunk connectivity
(  206)           chunks(1)%chunk_neighbours(chunk_left)=  chunk-1
(  207)           chunks(1)%chunk_neighbours(chunk_right)= chunk+1
(  208)           chunks(1)%chunk_neighbours(chunk_bottom)=chunk-chunk_x
(  209)           chunks(1)%chunk_neighbours(chunk_top)=   chunk+chunk_x
(  210)           chunks(1)%chunk_neighbours(chunk_back)=  chunk-chunk_x*chunk_y
(  211)           chunks(1)%chunk_neighbours(chunk_front)= chunk+chunk_x*chunk_y
(  212)           IF(cx.EQ.1)chunks(1)%chunk_neighbours(chunk_left)=external_face
(  213)           IF(cx.EQ.chunk_x)chunks(1)%chunk_neighbours(chunk_right)=external_face
(  214)           IF(cy.EQ.1)chunks(1)%chunk_neighbours(chunk_bottom)=external_face
(  215)           IF(cy.EQ.chunk_y)chunks(1)%chunk_neighbours(chunk_top)=external_face
(  216)           IF(cz.EQ.1)chunks(1)%chunk_neighbours(chunk_back)=external_face
(  217)           IF(cz.EQ.chunk_z)chunks(1)%chunk_neighbours(chunk_front)=external_face
(  218)         ENDIF
(  219)         IF(cx.LE.mod_x)add_x_prev=add_x_prev+1
(  220)         chunk=chunk+1
(  221)       ENDDO
(  222)       add_x_prev=0
(  223)       IF(cy.LE.mod_y)add_y_prev=add_y_prev+1
(  224)     ENDDO






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 5

(  225)     add_x_prev=0
(  226)     add_y_prev=0
(  227)     IF(cz.LE.mod_z)add_z_prev=add_z_prev+1
(  228)   ENDDO
(  229) 
(  230)   IF(parallel%boss)THEN
(  231)     WRITE(g_out,*)
(  232)     WRITE(g_out,*)"Decomposing the mesh into ",chunk_x," by ",chunk_y," by ",chunk_z," chunks"
(  233)     WRITE(g_out,*)
(  234)   ENDIF
(  235) 
(  236) END SUBROUTINE clover_decompose
(  237) 
(  238) SUBROUTINE clover_allocate_buffers(chunk)
(  239) 
(  240)   IMPLICIT NONE
(  241) 
(  242)   INTEGER      :: chunk
(  243)   
(  244)   ! Unallocated buffers for external boundaries caused issues on some systems so they are now
(  245)   !  all allocated
(  246)   IF(parallel%task.EQ.chunks(chunk)%task)THEN
(  247)       ALLOCATE(chunks(chunk)%left_snd_buffer(19*2*(chunks(chunk)%field%y_max+5)*(chunks(chunk)%field%z_max+5)))
(  248)       ALLOCATE(chunks(chunk)%left_rcv_buffer(19*2*(chunks(chunk)%field%y_max+5)*(chunks(chunk)%field%z_max+5)))
(  249)       ALLOCATE(chunks(chunk)%right_snd_buffer(19*2*(chunks(chunk)%field%y_max+5)*(chunks(chunk)%field%z_max+5)))
(  250)       ALLOCATE(chunks(chunk)%right_rcv_buffer(19*2*(chunks(chunk)%field%y_max+5)*(chunks(chunk)%field%z_max+5)))
(  251)       ALLOCATE(chunks(chunk)%bottom_snd_buffer(19*2*(chunks(chunk)%field%x_max+5)*(chunks(chunk)%field%z_max+5)))
(  252)       ALLOCATE(chunks(chunk)%bottom_rcv_buffer(19*2*(chunks(chunk)%field%x_max+5)*(chunks(chunk)%field%z_max+5)))
(  253)       ALLOCATE(chunks(chunk)%top_snd_buffer(19*2*(chunks(chunk)%field%x_max+5)*(chunks(chunk)%field%z_max+5)))
(  254)       ALLOCATE(chunks(chunk)%top_rcv_buffer(19*2*(chunks(chunk)%field%x_max+5)*(chunks(chunk)%field%z_max+5)))
(  255)       ALLOCATE(chunks(chunk)%back_snd_buffer(19*2*(chunks(chunk)%field%x_max+5)*(chunks(chunk)%field%y_max+5)))
(  256)       ALLOCATE(chunks(chunk)%back_rcv_buffer(19*2*(chunks(chunk)%field%x_max+5)*(chunks(chunk)%field%y_max+5)))
(  257)       ALLOCATE(chunks(chunk)%front_snd_buffer(19*2*(chunks(chunk)%field%x_max+5)*(chunks(chunk)%field%y_max+5)))
(  258)       ALLOCATE(chunks(chunk)%front_rcv_buffer(19*2*(chunks(chunk)%field%x_max+5)*(chunks(chunk)%field%y_max+5)))
(  259)   ENDIF
(  260) 
(  261) END SUBROUTINE clover_allocate_buffers
(  262) 
(  263) SUBROUTINE clover_exchange(fields,depth)
(  264) 
(  265)     IMPLICIT NONE
(  266) 
(  267)     INTEGER      :: fields(:),depth, chunk
(  268)     INTEGER      :: left_right_offset(19),bottom_top_offset(19),back_front_offset(19)
(  269)     INTEGER      :: request(4)
(  270)     INTEGER      :: message_count,err
(  271)     INTEGER      :: status(MPI_STATUS_SIZE,4)
(  272)     INTEGER      :: end_pack_index_left_right, end_pack_index_bottom_top,end_pack_index_back_front,field
(  273) 
(  274)     ! Assuming 1 patch per task, this will be changed
(  275) 
(  276)     request=0
(  277)     message_count=0
(  278) 
(  279)     chunk = 1 
(  280) 
(  281)     end_pack_index_left_right=0
(  282)     end_pack_index_bottom_top=0






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 6

(  283)     end_pack_index_back_front=0
(  284)     DO field=1,19
(  285)       IF(fields(field).EQ.1) THEN
(  286)         left_right_offset(field)=end_pack_index_left_right
(  287)         bottom_top_offset(field)=end_pack_index_bottom_top
(  288)         back_front_offset(field)=end_pack_index_back_front
(  289)         end_pack_index_left_right=end_pack_index_left_right+depth*(chunks(chunk)%field%y_max+5)*(chunks(chunk)%field%z_max+5)
(  290)         end_pack_index_bottom_top=end_pack_index_bottom_top+depth*(chunks(chunk)%field%x_max+5)*(chunks(chunk)%field%z_max+5)
(  291)         end_pack_index_back_front=end_pack_index_back_front+depth*(chunks(chunk)%field%x_max+5)*(chunks(chunk)%field%y_max+5)
(  292)       ENDIF
(  293)     ENDDO
(  294) 
(  295)     IF(chunks(chunk)%chunk_neighbours(chunk_left).NE.external_face) THEN
(  296)       ! do left exchanges
(  297)       CALL clover_pack_left(chunk, fields, depth, left_right_offset)
(  298) 
(  299)       !send and recv messagse to the left
(  300)       CALL clover_send_recv_message_left(chunks(chunk)%left_snd_buffer,                      &
(  301)                                          chunks(chunk)%left_rcv_buffer,                      &
(  302)                                          chunk,end_pack_index_left_right,                    &
(  303)                                          1, 2,                                               &
(  304)                                          request(message_count+1), request(message_count+2))
(  305)       message_count = message_count + 2
(  306)     ENDIF
(  307) 
(  308)     IF(chunks(chunk)%chunk_neighbours(chunk_right).NE.external_face) THEN
(  309)       ! do right exchanges
(  310)       CALL clover_pack_right(chunk, fields, depth, left_right_offset)
(  311) 
(  312)       !send message to the right
(  313)       CALL clover_send_recv_message_right(chunks(chunk)%right_snd_buffer,                     &
(  314)                                           chunks(chunk)%right_rcv_buffer,                     &
(  315)                                           chunk,end_pack_index_left_right,                    &
(  316)                                           2, 1,                                               &
(  317)                                           request(message_count+1), request(message_count+2))
(  318)       message_count = message_count + 2
(  319)     ENDIF
(  320) 
(  321)     !make a call to wait / sync
(  322)     CALL MPI_WAITALL(message_count,request,status,err)
(  323) 
(  324)     !unpack in left direction
(  325)     IF(chunks(chunk)%chunk_neighbours(chunk_left).NE.external_face) THEN
(  326)       CALL clover_unpack_left(fields, chunk, depth,                      &
(  327)                               chunks(chunk)%left_rcv_buffer,             &
(  328)                               left_right_offset)                  
(  329)     ENDIF
(  330) 
(  331) 
(  332)     !unpack in right direction
(  333)     IF(chunks(chunk)%chunk_neighbours(chunk_right).NE.external_face) THEN
(  334)       CALL clover_unpack_right(fields, chunk, depth,                     &
(  335)                                chunks(chunk)%right_rcv_buffer,           &
(  336)                                left_right_offset)
(  337)     ENDIF
(  338) 
(  339)     message_count = 0
(  340)     request = 0






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 7

(  341) 
(  342)     IF(chunks(chunk)%chunk_neighbours(chunk_bottom).NE.external_face) THEN
(  343)       ! do bottom exchanges
(  344)       CALL clover_pack_bottom(chunk, fields, depth, bottom_top_offset)
(  345) 
(  346)       !send message downwards
(  347)       CALL clover_send_recv_message_bottom(chunks(chunk)%bottom_snd_buffer,                     &
(  348)                                            chunks(chunk)%bottom_rcv_buffer,                     &
(  349)                                            chunk,end_pack_index_bottom_top,                     &
(  350)                                            3, 4,                                                &
(  351)                                            request(message_count+1), request(message_count+2))
(  352)       message_count = message_count + 2
(  353)     ENDIF
(  354) 
(  355)     IF(chunks(chunk)%chunk_neighbours(chunk_top).NE.external_face) THEN
(  356)       ! do top exchanges
(  357)       CALL clover_pack_top(chunk, fields, depth, bottom_top_offset)
(  358) 
(  359)       !send message upwards
(  360)       CALL clover_send_recv_message_top(chunks(chunk)%top_snd_buffer,                           &
(  361)                                         chunks(chunk)%top_rcv_buffer,                           &
(  362)                                         chunk,end_pack_index_bottom_top,                        &
(  363)                                         4, 3,                                                   &
(  364)                                         request(message_count+1), request(message_count+2))
(  365)       message_count = message_count + 2
(  366)     ENDIF
(  367) 
(  368)     !need to make a call to wait / sync
(  369)     CALL MPI_WAITALL(message_count,request,status,err)
(  370) 
(  371)     !unpack in top direction
(  372)     IF( chunks(chunk)%chunk_neighbours(chunk_top).NE.external_face ) THEN
(  373)       CALL clover_unpack_top(fields, chunk, depth,                       &
(  374)                              chunks(chunk)%top_rcv_buffer,               &
(  375)                              bottom_top_offset)
(  376)     ENDIF
(  377) 
(  378)     !unpack in bottom direction
(  379)     IF(chunks(chunk)%chunk_neighbours(chunk_bottom).NE.external_face) THEN
(  380)       CALL clover_unpack_bottom(fields, chunk, depth,                   &
(  381)                                chunks(chunk)%bottom_rcv_buffer,         &
(  382)                                bottom_top_offset)
(  383)     ENDIF
(  384) 
(  385)     message_count = 0
(  386)     request = 0
(  387) 
(  388)     IF(chunks(chunk)%chunk_neighbours(chunk_back).NE.external_face) THEN
(  389)       ! do back exchanges
(  390)       CALL clover_pack_back(chunk, fields, depth, back_front_offset)
(  391) 
(  392)       !send message downwards
(  393)       CALL clover_send_recv_message_back(chunks(chunk)%back_snd_buffer,                        &
(  394)                                            chunks(chunk)%back_rcv_buffer,                      &
(  395)                                            chunk,end_pack_index_back_front,                    &
(  396)                                            5, 6,                                               &
(  397)                                            request(message_count+1), request(message_count+2))
(  398)       message_count = message_count + 2






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 8

(  399)     ENDIF
(  400) 
(  401)     IF(chunks(chunk)%chunk_neighbours(chunk_front).NE.external_face) THEN
(  402)       ! do top exchanges
(  403)       CALL clover_pack_front(chunk, fields, depth, back_front_offset)
(  404) 
(  405)       !send message upwards
(  406)       CALL clover_send_recv_message_front(chunks(chunk)%front_snd_buffer,                       &
(  407)                                         chunks(chunk)%front_rcv_buffer,                         &
(  408)                                         chunk,end_pack_index_back_front,                        &
(  409)                                         6, 5,                                                   &
(  410)                                         request(message_count+1), request(message_count+2))
(  411)       message_count = message_count + 2
(  412)     ENDIF
(  413) 
(  414)     !need to make a call to wait / sync
(  415)     CALL MPI_WAITALL(message_count,request,status,err)
(  416) 
(  417)     !unpack in front direction
(  418)     IF( chunks(chunk)%chunk_neighbours(chunk_front).NE.external_face ) THEN
(  419)       CALL clover_unpack_front(fields, chunk, depth,                       &
(  420)                              chunks(chunk)%front_rcv_buffer,               &
(  421)                              back_front_offset)
(  422)     ENDIF
(  423) 
(  424)     !unpack in back direction
(  425)     IF(chunks(chunk)%chunk_neighbours(chunk_back).NE.external_face) THEN
(  426)       CALL clover_unpack_back(fields, chunk, depth,                   &
(  427)                                chunks(chunk)%back_rcv_buffer,         &
(  428)                                back_front_offset)
(  429)     ENDIF
(  430) 
(  431) END SUBROUTINE clover_exchange
(  432) 
(  433) SUBROUTINE clover_pack_left(chunk, fields, depth, left_right_offset)
(  434) 
(  435)   USE pack_kernel_module
(  436) 
(  437)   IMPLICIT NONE
(  438) 
(  439)   INTEGER      :: fields(:),depth, chunk
(  440)   INTEGER      :: left_right_offset(:)
(  441) 
(  442)   IF(fields(FIELD_DENSITY0).EQ.1) THEN
(  443)     IF(use_fortran_kernels) THEN
(  444)       CALL clover_pack_message_left(chunks(chunk)%field%x_min,                    &
(  445)                                     chunks(chunk)%field%x_max,                    &
(  446)                                     chunks(chunk)%field%y_min,                    &
(  447)                                     chunks(chunk)%field%y_max,                    &
(  448)                                     chunks(chunk)%field%z_min,                    &
(  449)                                     chunks(chunk)%field%z_max,                    &
(  450)                                     chunks(chunk)%field%density0,                 &
(  451)                                     chunks(chunk)%left_snd_buffer,                &
(  452)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  453)                                     depth, CELL_DATA,                             &
(  454)                                     left_right_offset(FIELD_DENSITY0))
(  455)     ELSE
(  456)       CALL clover_pack_message_left_c(chunks(chunk)%field%x_min,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 9

(  457)                                       chunks(chunk)%field%x_max,                    &
(  458)                                       chunks(chunk)%field%y_min,                    &
(  459)                                       chunks(chunk)%field%y_max,                    &
(  460)                                       chunks(chunk)%field%density0,                 &
(  461)                                       chunks(chunk)%left_snd_buffer,                &
(  462)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  463)                                       depth, CELL_DATA,                             &
(  464)                                       left_right_offset(FIELD_DENSITY0))
(  465)     ENDIF
(  466)   ENDIF
(  467)   IF(fields(FIELD_DENSITY1).EQ.1) THEN
(  468)     IF(use_fortran_kernels) THEN
(  469)       CALL clover_pack_message_left(chunks(chunk)%field%x_min,                    &
(  470)                                     chunks(chunk)%field%x_max,                    &
(  471)                                     chunks(chunk)%field%y_min,                    &
(  472)                                     chunks(chunk)%field%y_max,                    &
(  473)                                     chunks(chunk)%field%z_min,                    &
(  474)                                     chunks(chunk)%field%z_max,                    &
(  475)                                     chunks(chunk)%field%density1,                 &
(  476)                                     chunks(chunk)%left_snd_buffer,                &
(  477)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  478)                                     depth, CELL_DATA,                             &
(  479)                                     left_right_offset(FIELD_DENSITY1))
(  480)     ELSE
(  481)       CALL clover_pack_message_left_c(chunks(chunk)%field%x_min,                    &
(  482)                                       chunks(chunk)%field%x_max,                    &
(  483)                                       chunks(chunk)%field%y_min,                    &
(  484)                                       chunks(chunk)%field%y_max,                    &
(  485)                                       chunks(chunk)%field%density1,                 &
(  486)                                       chunks(chunk)%left_snd_buffer,                &
(  487)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  488)                                       depth, CELL_DATA,                             &
(  489)                                       left_right_offset(FIELD_DENSITY1))
(  490)     ENDIF
(  491)   ENDIF
(  492)   IF(fields(FIELD_ENERGY0).EQ.1) THEN
(  493)     IF(use_fortran_kernels) THEN
(  494)       CALL clover_pack_message_left(chunks(chunk)%field%x_min,                    &
(  495)                                     chunks(chunk)%field%x_max,                    &
(  496)                                     chunks(chunk)%field%y_min,                    &
(  497)                                     chunks(chunk)%field%y_max,                    &
(  498)                                     chunks(chunk)%field%z_min,                    &
(  499)                                     chunks(chunk)%field%z_max,                    &
(  500)                                     chunks(chunk)%field%energy0,                  &
(  501)                                     chunks(chunk)%left_snd_buffer,                &
(  502)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  503)                                     depth, CELL_DATA,                             &
(  504)                                     left_right_offset(FIELD_ENERGY0))
(  505)     ELSE
(  506)       CALL clover_pack_message_left_c(chunks(chunk)%field%x_min,                    &
(  507)                                       chunks(chunk)%field%x_max,                    &
(  508)                                       chunks(chunk)%field%y_min,                    &
(  509)                                       chunks(chunk)%field%y_max,                    &
(  510)                                       chunks(chunk)%field%energy0,                  &
(  511)                                       chunks(chunk)%left_snd_buffer,                &
(  512)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  513)                                       depth, CELL_DATA,                             &
(  514)                                       left_right_offset(FIELD_ENERGY0))






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 10

(  515)     ENDIF
(  516)   ENDIF
(  517)   IF(fields(FIELD_ENERGY1).EQ.1) THEN
(  518)     IF(use_fortran_kernels) THEN
(  519)       CALL clover_pack_message_left(chunks(chunk)%field%x_min,                    &
(  520)                                     chunks(chunk)%field%x_max,                    &
(  521)                                     chunks(chunk)%field%y_min,                    &
(  522)                                     chunks(chunk)%field%y_max,                    &
(  523)                                     chunks(chunk)%field%z_min,                    &
(  524)                                     chunks(chunk)%field%z_max,                    &
(  525)                                     chunks(chunk)%field%energy1,                  &
(  526)                                     chunks(chunk)%left_snd_buffer,                &
(  527)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  528)                                     depth, CELL_DATA,                             &
(  529)                                     left_right_offset(FIELD_ENERGY1))
(  530)     ELSE
(  531)       CALL clover_pack_message_left_c(chunks(chunk)%field%x_min,                    &
(  532)                                       chunks(chunk)%field%x_max,                    &
(  533)                                       chunks(chunk)%field%y_min,                    &
(  534)                                       chunks(chunk)%field%y_max,                    &
(  535)                                       chunks(chunk)%field%energy1,                  &
(  536)                                       chunks(chunk)%left_snd_buffer,                &
(  537)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  538)                                       depth, CELL_DATA,                             &
(  539)                                       left_right_offset(FIELD_ENERGY1))
(  540)     ENDIF
(  541)   ENDIF
(  542)   IF(fields(FIELD_PRESSURE).EQ.1) THEN
(  543)     IF(use_fortran_kernels) THEN
(  544)       CALL clover_pack_message_left(chunks(chunk)%field%x_min,                    &
(  545)                                     chunks(chunk)%field%x_max,                    &
(  546)                                     chunks(chunk)%field%y_min,                    &
(  547)                                     chunks(chunk)%field%y_max,                    &
(  548)                                     chunks(chunk)%field%z_min,                    &
(  549)                                     chunks(chunk)%field%z_max,                    &
(  550)                                     chunks(chunk)%field%pressure,                 &
(  551)                                     chunks(chunk)%left_snd_buffer,                &
(  552)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  553)                                     depth, CELL_DATA,                             &
(  554)                                     left_right_offset(FIELD_PRESSURE))
(  555)     ELSE
(  556)       CALL clover_pack_message_left_c(chunks(chunk)%field%x_min,                    &
(  557)                                       chunks(chunk)%field%x_max,                    &
(  558)                                       chunks(chunk)%field%y_min,                    &
(  559)                                       chunks(chunk)%field%y_max,                    &
(  560)                                       chunks(chunk)%field%pressure,                 &
(  561)                                       chunks(chunk)%left_snd_buffer,                &
(  562)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  563)                                       depth, CELL_DATA,                             &
(  564)                                       left_right_offset(FIELD_PRESSURE))
(  565)     ENDIF
(  566)   ENDIF
(  567)   IF(fields(FIELD_VISCOSITY).EQ.1) THEN
(  568)     IF(use_fortran_kernels) THEN
(  569)       CALL clover_pack_message_left(chunks(chunk)%field%x_min,                    &
(  570)                                     chunks(chunk)%field%x_max,                    &
(  571)                                     chunks(chunk)%field%y_min,                    &
(  572)                                     chunks(chunk)%field%y_max,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 11

(  573)                                     chunks(chunk)%field%z_min,                    &
(  574)                                     chunks(chunk)%field%z_max,                    &
(  575)                                     chunks(chunk)%field%viscosity,                &
(  576)                                     chunks(chunk)%left_snd_buffer,                &
(  577)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  578)                                     depth, CELL_DATA,                             &
(  579)                                     left_right_offset(FIELD_VISCOSITY))
(  580)     ELSE
(  581)       CALL clover_pack_message_left_c(chunks(chunk)%field%x_min,                    &
(  582)                                       chunks(chunk)%field%x_max,                    &
(  583)                                       chunks(chunk)%field%y_min,                    &
(  584)                                       chunks(chunk)%field%y_max,                    &
(  585)                                       chunks(chunk)%field%viscosity,                &
(  586)                                       chunks(chunk)%left_snd_buffer,                &
(  587)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  588)                                       depth, CELL_DATA,                             &
(  589)                                     left_right_offset(FIELD_VISCOSITY))
(  590)     ENDIF
(  591)   ENDIF
(  592)   IF(fields(FIELD_SOUNDSPEED).EQ.1) THEN
(  593)     IF(use_fortran_kernels) THEN
(  594)       CALL clover_pack_message_left(chunks(chunk)%field%x_min,                    &
(  595)                                     chunks(chunk)%field%x_max,                    &
(  596)                                     chunks(chunk)%field%y_min,                    &
(  597)                                     chunks(chunk)%field%y_max,                    &
(  598)                                     chunks(chunk)%field%z_min,                    &
(  599)                                     chunks(chunk)%field%z_max,                    &
(  600)                                     chunks(chunk)%field%soundspeed,               &
(  601)                                     chunks(chunk)%left_snd_buffer,                &
(  602)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  603)                                     depth, CELL_DATA,                             &
(  604)                                     left_right_offset(FIELD_SOUNDSPEED))
(  605)     ELSE
(  606)       CALL clover_pack_message_left_c(chunks(chunk)%field%x_min,                    &
(  607)                                       chunks(chunk)%field%x_max,                    &
(  608)                                       chunks(chunk)%field%y_min,                    &
(  609)                                       chunks(chunk)%field%y_max,                    &
(  610)                                       chunks(chunk)%field%soundspeed,               &
(  611)                                       chunks(chunk)%left_snd_buffer,                &
(  612)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  613)                                       depth, CELL_DATA,                             &
(  614)                                       left_right_offset(FIELD_SOUNDSPEED))
(  615)     ENDIF
(  616)   ENDIF
(  617)   IF(fields(FIELD_XVEL0).EQ.1) THEN
(  618)     IF(use_fortran_kernels) THEN
(  619)       CALL clover_pack_message_left(chunks(chunk)%field%x_min,                    &
(  620)                                     chunks(chunk)%field%x_max,                    &
(  621)                                     chunks(chunk)%field%y_min,                    &
(  622)                                     chunks(chunk)%field%y_max,                    &
(  623)                                     chunks(chunk)%field%z_min,                    &
(  624)                                     chunks(chunk)%field%z_max,                    &
(  625)                                     chunks(chunk)%field%xvel0,                    &
(  626)                                     chunks(chunk)%left_snd_buffer,                &
(  627)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  628)                                     depth, VERTEX_DATA,                           &
(  629)                                     left_right_offset(FIELD_XVEL0))
(  630)     ELSE






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 12

(  631)       CALL clover_pack_message_left_c(chunks(chunk)%field%x_min,                    &
(  632)                                       chunks(chunk)%field%x_max,                    &
(  633)                                       chunks(chunk)%field%y_min,                    &
(  634)                                       chunks(chunk)%field%y_max,                    &
(  635)                                       chunks(chunk)%field%xvel0,                    &
(  636)                                       chunks(chunk)%left_snd_buffer,                &
(  637)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  638)                                       depth, VERTEX_DATA,                           &
(  639)                                       left_right_offset(FIELD_XVEL0))
(  640)     ENDIF
(  641)   ENDIF
(  642)   IF(fields(FIELD_XVEL1).EQ.1) THEN
(  643)     IF(use_fortran_kernels) THEN
(  644)       CALL clover_pack_message_left(chunks(chunk)%field%x_min,                    &
(  645)                                     chunks(chunk)%field%x_max,                    &
(  646)                                     chunks(chunk)%field%y_min,                    &
(  647)                                     chunks(chunk)%field%y_max,                    &
(  648)                                     chunks(chunk)%field%z_min,                    &
(  649)                                     chunks(chunk)%field%z_max,                    &
(  650)                                     chunks(chunk)%field%xvel1,                    &
(  651)                                     chunks(chunk)%left_snd_buffer,                &
(  652)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  653)                                     depth, VERTEX_DATA,                           &
(  654)                                     left_right_offset(FIELD_XVEL1))
(  655)     ELSE
(  656)       CALL clover_pack_message_left_c(chunks(chunk)%field%x_min,                    &
(  657)                                       chunks(chunk)%field%x_max,                    &
(  658)                                       chunks(chunk)%field%y_min,                    &
(  659)                                       chunks(chunk)%field%y_max,                    &
(  660)                                       chunks(chunk)%field%xvel1,                    &
(  661)                                       chunks(chunk)%left_snd_buffer,                &
(  662)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  663)                                       depth, VERTEX_DATA,                           &
(  664)                                       left_right_offset(FIELD_XVEL1))
(  665)     ENDIF
(  666)   ENDIF
(  667)   IF(fields(FIELD_YVEL0).EQ.1) THEN
(  668)     IF(use_fortran_kernels) THEN
(  669)       CALL clover_pack_message_left(chunks(chunk)%field%x_min,                    &
(  670)                                     chunks(chunk)%field%x_max,                    &
(  671)                                     chunks(chunk)%field%y_min,                    &
(  672)                                     chunks(chunk)%field%y_max,                    &
(  673)                                     chunks(chunk)%field%z_min,                    &
(  674)                                     chunks(chunk)%field%z_max,                    &
(  675)                                     chunks(chunk)%field%yvel0,                    &
(  676)                                     chunks(chunk)%left_snd_buffer,                &
(  677)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  678)                                     depth, VERTEX_DATA,                           &
(  679)                                     left_right_offset(FIELD_YVEL0))
(  680)     ELSE
(  681)       CALL clover_pack_message_left_c(chunks(chunk)%field%x_min,                    &
(  682)                                       chunks(chunk)%field%x_max,                    &
(  683)                                       chunks(chunk)%field%y_min,                    &
(  684)                                       chunks(chunk)%field%y_max,                    &
(  685)                                       chunks(chunk)%field%yvel0,                    &
(  686)                                       chunks(chunk)%left_snd_buffer,                &
(  687)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  688)                                       depth, VERTEX_DATA,                           &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 13

(  689)                                       left_right_offset(FIELD_YVEL0))
(  690)     ENDIF
(  691)   ENDIF
(  692)   IF(fields(FIELD_YVEL1).EQ.1) THEN
(  693)     IF(use_fortran_kernels) THEN
(  694)       CALL clover_pack_message_left(chunks(chunk)%field%x_min,                    &
(  695)                                     chunks(chunk)%field%x_max,                    &
(  696)                                     chunks(chunk)%field%y_min,                    &
(  697)                                     chunks(chunk)%field%y_max,                    &
(  698)                                     chunks(chunk)%field%z_min,                    &
(  699)                                     chunks(chunk)%field%z_max,                    &
(  700)                                     chunks(chunk)%field%yvel1,                    &
(  701)                                     chunks(chunk)%left_snd_buffer,                &
(  702)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  703)                                     depth, VERTEX_DATA,                           &
(  704)                                     left_right_offset(FIELD_YVEL1))
(  705)     ELSE
(  706)       CALL clover_pack_message_left_c(chunks(chunk)%field%x_min,                    &
(  707)                                       chunks(chunk)%field%x_max,                    &
(  708)                                       chunks(chunk)%field%y_min,                    &
(  709)                                       chunks(chunk)%field%y_max,                    &
(  710)                                       chunks(chunk)%field%yvel1,                    &
(  711)                                       chunks(chunk)%left_snd_buffer,                &
(  712)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  713)                                       depth, VERTEX_DATA,                           &
(  714)                                       left_right_offset(FIELD_YVEL1))
(  715)     ENDIF
(  716)   ENDIF
(  717)   IF(fields(FIELD_ZVEL0).EQ.1) THEN
(  718)     IF(use_fortran_kernels) THEN
(  719)       CALL clover_pack_message_left(chunks(chunk)%field%x_min,                    &
(  720)                                     chunks(chunk)%field%x_max,                    &
(  721)                                     chunks(chunk)%field%y_min,                    &
(  722)                                     chunks(chunk)%field%y_max,                    &
(  723)                                     chunks(chunk)%field%z_min,                    &
(  724)                                     chunks(chunk)%field%z_max,                    &
(  725)                                     chunks(chunk)%field%zvel0,                    &
(  726)                                     chunks(chunk)%left_snd_buffer,                &
(  727)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  728)                                     depth, VERTEX_DATA,                           &
(  729)                                     left_right_offset(FIELD_ZVEL0))
(  730)     ELSE
(  731)       CALL clover_pack_message_left_c(chunks(chunk)%field%x_min,                    &
(  732)                                       chunks(chunk)%field%x_max,                    &
(  733)                                       chunks(chunk)%field%y_min,                    &
(  734)                                       chunks(chunk)%field%y_max,                    &
(  735)                                       chunks(chunk)%field%zvel0,                    &
(  736)                                       chunks(chunk)%left_snd_buffer,                &
(  737)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  738)                                       depth, VERTEX_DATA,                           &
(  739)                                       left_right_offset(FIELD_ZVEL0))
(  740)     ENDIF
(  741)   ENDIF
(  742)   IF(fields(FIELD_ZVEL1).EQ.1) THEN
(  743)     IF(use_fortran_kernels) THEN
(  744)       CALL clover_pack_message_left(chunks(chunk)%field%x_min,                    &
(  745)                                     chunks(chunk)%field%x_max,                    &
(  746)                                     chunks(chunk)%field%y_min,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 14

(  747)                                     chunks(chunk)%field%y_max,                    &
(  748)                                     chunks(chunk)%field%z_min,                    &
(  749)                                     chunks(chunk)%field%z_max,                    &
(  750)                                     chunks(chunk)%field%zvel1,                    &
(  751)                                     chunks(chunk)%left_snd_buffer,                &
(  752)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  753)                                     depth, VERTEX_DATA,                           &
(  754)                                     left_right_offset(FIELD_ZVEL1))
(  755)     ELSE
(  756)       CALL clover_pack_message_left_c(chunks(chunk)%field%x_min,                    &
(  757)                                       chunks(chunk)%field%x_max,                    &
(  758)                                       chunks(chunk)%field%y_min,                    &
(  759)                                       chunks(chunk)%field%y_max,                    &
(  760)                                       chunks(chunk)%field%zvel1,                    &
(  761)                                       chunks(chunk)%left_snd_buffer,                &
(  762)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  763)                                       depth, VERTEX_DATA,                           &
(  764)                                       left_right_offset(FIELD_ZVEL1))
(  765)     ENDIF
(  766)   ENDIF
(  767)   IF(fields(FIELD_VOL_FLUX_X).EQ.1) THEN
(  768)     IF(use_fortran_kernels) THEN
(  769)       CALL clover_pack_message_left(chunks(chunk)%field%x_min,                    &
(  770)                                     chunks(chunk)%field%x_max,                    &
(  771)                                     chunks(chunk)%field%y_min,                    &
(  772)                                     chunks(chunk)%field%y_max,                    &
(  773)                                     chunks(chunk)%field%z_min,                    &
(  774)                                     chunks(chunk)%field%z_max,                    &
(  775)                                     chunks(chunk)%field%vol_flux_x,               &
(  776)                                     chunks(chunk)%left_snd_buffer,                &
(  777)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  778)                                     depth, X_FACE_DATA,                           &
(  779)                                     left_right_offset(FIELD_VOL_FLUX_X))
(  780)     ELSE
(  781)       CALL clover_pack_message_left_c(chunks(chunk)%field%x_min,                    &
(  782)                                       chunks(chunk)%field%x_max,                    &
(  783)                                       chunks(chunk)%field%y_min,                    &
(  784)                                       chunks(chunk)%field%y_max,                    &
(  785)                                       chunks(chunk)%field%vol_flux_x,               &
(  786)                                       chunks(chunk)%left_snd_buffer,                &
(  787)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  788)                                       depth, X_FACE_DATA,                           &
(  789)                                       left_right_offset(FIELD_VOL_FLUX_X))
(  790)     ENDIF
(  791)   ENDIF
(  792)   IF(fields(FIELD_VOL_FLUX_Y).EQ.1) THEN
(  793)     IF(use_fortran_kernels) THEN
(  794)       CALL clover_pack_message_left(chunks(chunk)%field%x_min,                    &
(  795)                                     chunks(chunk)%field%x_max,                    &
(  796)                                     chunks(chunk)%field%y_min,                    &
(  797)                                     chunks(chunk)%field%y_max,                    &
(  798)                                     chunks(chunk)%field%z_min,                    &
(  799)                                     chunks(chunk)%field%z_max,                    &
(  800)                                     chunks(chunk)%field%vol_flux_y,               &
(  801)                                     chunks(chunk)%left_snd_buffer,                &
(  802)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  803)                                     depth, Y_FACE_DATA,                           &
(  804)                                     left_right_offset(FIELD_VOL_FLUX_Y))






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 15

(  805)     ELSE
(  806)       CALL clover_pack_message_left_c(chunks(chunk)%field%x_min,                    &
(  807)                                       chunks(chunk)%field%x_max,                    &
(  808)                                       chunks(chunk)%field%y_min,                    &
(  809)                                       chunks(chunk)%field%y_max,                    &
(  810)                                       chunks(chunk)%field%vol_flux_y,               &
(  811)                                       chunks(chunk)%left_snd_buffer,                &
(  812)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  813)                                       depth, Y_FACE_DATA,                           &
(  814)                                       left_right_offset(FIELD_VOL_FLUX_Y))
(  815)     ENDIF
(  816)   ENDIF
(  817)   IF(fields(FIELD_VOL_FLUX_Z).EQ.1) THEN
(  818)     IF(use_fortran_kernels) THEN
(  819)       CALL clover_pack_message_left(chunks(chunk)%field%x_min,                    &
(  820)                                     chunks(chunk)%field%x_max,                    &
(  821)                                     chunks(chunk)%field%y_min,                    &
(  822)                                     chunks(chunk)%field%y_max,                    &
(  823)                                     chunks(chunk)%field%z_min,                    &
(  824)                                     chunks(chunk)%field%z_max,                    &
(  825)                                     chunks(chunk)%field%vol_flux_z,               &
(  826)                                     chunks(chunk)%left_snd_buffer,                &
(  827)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  828)                                     depth, Z_FACE_DATA,                           &
(  829)                                     left_right_offset(FIELD_VOL_FLUX_Z))
(  830)     ELSE
(  831)       CALL clover_pack_message_left_c(chunks(chunk)%field%x_min,                    &
(  832)                                       chunks(chunk)%field%x_max,                    &
(  833)                                       chunks(chunk)%field%y_min,                    &
(  834)                                       chunks(chunk)%field%y_max,                    &
(  835)                                       chunks(chunk)%field%vol_flux_z,               &
(  836)                                       chunks(chunk)%left_snd_buffer,                &
(  837)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  838)                                       depth, Z_FACE_DATA,                           &
(  839)                                       left_right_offset(FIELD_VOL_FLUX_Z))
(  840)     ENDIF
(  841)   ENDIF
(  842)   IF(fields(FIELD_MASS_FLUX_X).EQ.1) THEN
(  843)     IF(use_fortran_kernels) THEN
(  844)       CALL clover_pack_message_left(chunks(chunk)%field%x_min,                    &
(  845)                                     chunks(chunk)%field%x_max,                    &
(  846)                                     chunks(chunk)%field%y_min,                    &
(  847)                                     chunks(chunk)%field%y_max,                    &
(  848)                                     chunks(chunk)%field%z_min,                    &
(  849)                                     chunks(chunk)%field%z_max,                    &
(  850)                                     chunks(chunk)%field%mass_flux_x,              &
(  851)                                     chunks(chunk)%left_snd_buffer,                &
(  852)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  853)                                     depth, X_FACE_DATA,                           &
(  854)                                     left_right_offset(FIELD_MASS_FLUX_X))
(  855)     ELSE
(  856)       CALL clover_pack_message_left_c(chunks(chunk)%field%x_min,                    &
(  857)                                       chunks(chunk)%field%x_max,                    &
(  858)                                       chunks(chunk)%field%y_min,                    &
(  859)                                       chunks(chunk)%field%y_max,                    &
(  860)                                       chunks(chunk)%field%mass_flux_x,              &
(  861)                                       chunks(chunk)%left_snd_buffer,                &
(  862)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 16

(  863)                                       depth, X_FACE_DATA,                           &
(  864)                                       left_right_offset(FIELD_MASS_FLUX_X))
(  865)     ENDIF
(  866)   ENDIF
(  867)   IF(fields(FIELD_MASS_FLUX_Y).EQ.1) THEN
(  868)     IF(use_fortran_kernels) THEN
(  869)       CALL clover_pack_message_left(chunks(chunk)%field%x_min,                    &
(  870)                                     chunks(chunk)%field%x_max,                    &
(  871)                                     chunks(chunk)%field%y_min,                    &
(  872)                                     chunks(chunk)%field%y_max,                    &
(  873)                                     chunks(chunk)%field%z_min,                    &
(  874)                                     chunks(chunk)%field%z_max,                    &
(  875)                                     chunks(chunk)%field%mass_flux_y,              &
(  876)                                     chunks(chunk)%left_snd_buffer,                &
(  877)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  878)                                     depth, Y_FACE_DATA,                           &
(  879)                                     left_right_offset(FIELD_MASS_FLUX_Y))
(  880)     ELSE
(  881)       CALL clover_pack_message_left_c(chunks(chunk)%field%x_min,                    &
(  882)                                       chunks(chunk)%field%x_max,                    &
(  883)                                       chunks(chunk)%field%y_min,                    &
(  884)                                       chunks(chunk)%field%y_max,                    &
(  885)                                       chunks(chunk)%field%mass_flux_y,              &
(  886)                                       chunks(chunk)%left_snd_buffer,                &
(  887)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  888)                                       depth, Y_FACE_DATA,                           &
(  889)                                       left_right_offset(FIELD_MASS_FLUX_Y))
(  890)     ENDIF
(  891)   ENDIF
(  892)   IF(fields(FIELD_MASS_FLUX_Z).EQ.1) THEN
(  893)     IF(use_fortran_kernels) THEN
(  894)       CALL clover_pack_message_left(chunks(chunk)%field%x_min,                    &
(  895)                                     chunks(chunk)%field%x_max,                    &
(  896)                                     chunks(chunk)%field%y_min,                    &
(  897)                                     chunks(chunk)%field%y_max,                    &
(  898)                                     chunks(chunk)%field%z_min,                    &
(  899)                                     chunks(chunk)%field%z_max,                    &
(  900)                                     chunks(chunk)%field%mass_flux_z,              &
(  901)                                     chunks(chunk)%left_snd_buffer,                &
(  902)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  903)                                     depth, Z_FACE_DATA,                           &
(  904)                                     left_right_offset(FIELD_MASS_FLUX_Z))
(  905)     ELSE
(  906)       CALL clover_pack_message_left_c(chunks(chunk)%field%x_min,                    &
(  907)                                       chunks(chunk)%field%x_max,                    &
(  908)                                       chunks(chunk)%field%y_min,                    &
(  909)                                       chunks(chunk)%field%y_max,                    &
(  910)                                       chunks(chunk)%field%mass_flux_z,              &
(  911)                                       chunks(chunk)%left_snd_buffer,                &
(  912)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  913)                                       depth, Z_FACE_DATA,                           &
(  914)                                       left_right_offset(FIELD_MASS_FLUX_Z))
(  915)     ENDIF
(  916)   ENDIF
(  917) 
(  918) END SUBROUTINE clover_pack_left
(  919) 
(  920) SUBROUTINE clover_send_recv_message_left(left_snd_buffer, left_rcv_buffer,      &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 17

(  921)                                          chunk, total_size,                     &
(  922)                                          tag_send, tag_recv,                    &
(  923)                                          req_send, req_recv)
(  924) 
(  925)   REAL(KIND=8)    :: left_snd_buffer(:), left_rcv_buffer(:)
(  926)   INTEGER         :: left_task
(  927)   INTEGER         :: chunk
(  928)   INTEGER         :: total_size, tag_send, tag_recv, err
(  929)   INTEGER         :: req_send, req_recv
(  930) 
(  931)   left_task =chunks(chunk)%chunk_neighbours(chunk_left) - 1
(  932) 
(  933)   CALL MPI_ISEND(left_snd_buffer,total_size,MPI_DOUBLE_PRECISION,left_task,tag_send &
(  934)                 ,MPI_COMM_WORLD,req_send,err)
(  935) 
(  936)   CALL MPI_IRECV(left_rcv_buffer,total_size,MPI_DOUBLE_PRECISION,left_task,tag_recv &
(  937)                 ,MPI_COMM_WORLD,req_recv,err)
(  938) 
(  939) END SUBROUTINE clover_send_recv_message_left
(  940) 
(  941) SUBROUTINE clover_unpack_left(fields, chunk, depth,                         &
(  942)                               left_rcv_buffer,                              &
(  943)                               left_right_offset)
(  944) 
(  945)   USE pack_kernel_module
(  946) 
(  947)   IMPLICIT NONE
(  948) 
(  949)   INTEGER         :: fields(:), chunk, depth
(  950)   INTEGER         :: left_right_offset(:)
(  951)   REAL(KIND=8)    :: left_rcv_buffer(:)
(  952) 
(  953) 
(  954)   IF(fields(FIELD_DENSITY0).EQ.1) THEN
(  955)     IF(use_fortran_kernels) THEN
(  956)       CALL clover_unpack_message_left(chunks(chunk)%field%x_min,                    &
(  957)                                       chunks(chunk)%field%x_max,                    &
(  958)                                       chunks(chunk)%field%y_min,                    &
(  959)                                       chunks(chunk)%field%y_max,                    &
(  960)                                       chunks(chunk)%field%z_min,                    &
(  961)                                       chunks(chunk)%field%z_max,                    &
(  962)                                       chunks(chunk)%field%density0,                 &
(  963)                                       chunks(chunk)%left_rcv_buffer,                &
(  964)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  965)                                       depth, CELL_DATA,                             &
(  966)                                       left_right_offset(FIELD_DENSITY0))
(  967)     ELSE
(  968)       CALL clover_unpack_message_left_c(chunks(chunk)%field%x_min,                    &
(  969)                                         chunks(chunk)%field%x_max,                    &
(  970)                                         chunks(chunk)%field%y_min,                    &
(  971)                                         chunks(chunk)%field%y_max,                    &
(  972)                                         chunks(chunk)%field%density0,                 &
(  973)                                         chunks(chunk)%left_rcv_buffer,                &
(  974)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  975)                                         depth, CELL_DATA,                             &
(  976)                                         left_right_offset(FIELD_DENSITY0))
(  977)     ENDIF
(  978)   ENDIF






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 18

(  979)   IF(fields(FIELD_DENSITY1).EQ.1) THEN
(  980)     IF(use_fortran_kernels) THEN
(  981)       CALL clover_unpack_message_left(chunks(chunk)%field%x_min,                    &
(  982)                                       chunks(chunk)%field%x_max,                    &
(  983)                                       chunks(chunk)%field%y_min,                    &
(  984)                                       chunks(chunk)%field%y_max,                    &
(  985)                                       chunks(chunk)%field%z_min,                    &
(  986)                                       chunks(chunk)%field%z_max,                    &
(  987)                                       chunks(chunk)%field%density1,                 &
(  988)                                       chunks(chunk)%left_rcv_buffer,                &
(  989)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
(  990)                                       depth, CELL_DATA,                             &
(  991)                                       left_right_offset(FIELD_DENSITY1))
(  992)     ELSE
(  993)       CALL clover_unpack_message_left_c(chunks(chunk)%field%x_min,                    &
(  994)                                         chunks(chunk)%field%x_max,                    &
(  995)                                         chunks(chunk)%field%y_min,                    &
(  996)                                         chunks(chunk)%field%y_max,                    &
(  997)                                         chunks(chunk)%field%density1,                 &
(  998)                                         chunks(chunk)%left_rcv_buffer,                &
(  999)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1000)                                         depth, CELL_DATA,                             &
( 1001)                                         left_right_offset(FIELD_DENSITY1))
( 1002)     ENDIF
( 1003)   ENDIF
( 1004)   IF(fields(FIELD_ENERGY0).EQ.1) THEN
( 1005)     IF(use_fortran_kernels) THEN
( 1006)       CALL clover_unpack_message_left(chunks(chunk)%field%x_min,                    &
( 1007)                                       chunks(chunk)%field%x_max,                    &
( 1008)                                       chunks(chunk)%field%y_min,                    &
( 1009)                                       chunks(chunk)%field%y_max,                    &
( 1010)                                       chunks(chunk)%field%z_min,                    &
( 1011)                                       chunks(chunk)%field%z_max,                    &
( 1012)                                       chunks(chunk)%field%energy0,                  &
( 1013)                                       chunks(chunk)%left_rcv_buffer,                &
( 1014)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1015)                                       depth, CELL_DATA,                             &
( 1016)                                       left_right_offset(FIELD_ENERGY0))
( 1017)     ELSE
( 1018)       CALL clover_unpack_message_left_c(chunks(chunk)%field%x_min,                    &
( 1019)                                         chunks(chunk)%field%x_max,                    &
( 1020)                                         chunks(chunk)%field%y_min,                    &
( 1021)                                         chunks(chunk)%field%y_max,                    &
( 1022)                                         chunks(chunk)%field%energy0,                  &
( 1023)                                         chunks(chunk)%left_rcv_buffer,                &
( 1024)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1025)                                         depth, CELL_DATA,                             &
( 1026)                                         left_right_offset(FIELD_ENERGY0))
( 1027)     ENDIF
( 1028)   ENDIF
( 1029)   IF(fields(FIELD_ENERGY1).EQ.1) THEN
( 1030)     IF(use_fortran_kernels) THEN
( 1031)       CALL clover_unpack_message_left(chunks(chunk)%field%x_min,                    &
( 1032)                                       chunks(chunk)%field%x_max,                    &
( 1033)                                       chunks(chunk)%field%y_min,                    &
( 1034)                                       chunks(chunk)%field%y_max,                    &
( 1035)                                       chunks(chunk)%field%z_min,                    &
( 1036)                                       chunks(chunk)%field%z_max,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 19

( 1037)                                       chunks(chunk)%field%energy1,                  &
( 1038)                                       chunks(chunk)%left_rcv_buffer,                &
( 1039)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1040)                                       depth, CELL_DATA,                             &
( 1041)                                       left_right_offset(FIELD_ENERGY1))
( 1042)     ELSE
( 1043)       CALL clover_unpack_message_left_c(chunks(chunk)%field%x_min,                    &
( 1044)                                         chunks(chunk)%field%x_max,                    &
( 1045)                                         chunks(chunk)%field%y_min,                    &
( 1046)                                         chunks(chunk)%field%y_max,                    &
( 1047)                                         chunks(chunk)%field%energy1,                  &
( 1048)                                         chunks(chunk)%left_rcv_buffer,                &
( 1049)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1050)                                         depth, CELL_DATA,                             &
( 1051)                                         left_right_offset(FIELD_ENERGY1))
( 1052)     ENDIF
( 1053)   ENDIF
( 1054)   IF(fields(FIELD_PRESSURE).EQ.1) THEN
( 1055)     IF(use_fortran_kernels) THEN
( 1056)       CALL clover_unpack_message_left(chunks(chunk)%field%x_min,                    &
( 1057)                                       chunks(chunk)%field%x_max,                    &
( 1058)                                       chunks(chunk)%field%y_min,                    &
( 1059)                                       chunks(chunk)%field%y_max,                    &
( 1060)                                       chunks(chunk)%field%z_min,                    &
( 1061)                                       chunks(chunk)%field%z_max,                    &
( 1062)                                       chunks(chunk)%field%pressure,                 &
( 1063)                                       chunks(chunk)%left_rcv_buffer,                &
( 1064)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1065)                                       depth, CELL_DATA,                             &
( 1066)                                       left_right_offset(FIELD_PRESSURE))
( 1067)     ELSE
( 1068)       CALL clover_unpack_message_left_c(chunks(chunk)%field%x_min,                    &
( 1069)                                         chunks(chunk)%field%x_max,                    &
( 1070)                                         chunks(chunk)%field%y_min,                    &
( 1071)                                         chunks(chunk)%field%y_max,                    &
( 1072)                                         chunks(chunk)%field%pressure,                 &
( 1073)                                         chunks(chunk)%left_rcv_buffer,                &
( 1074)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1075)                                         depth, CELL_DATA,                             &
( 1076)                                         left_right_offset(FIELD_PRESSURE))
( 1077)     ENDIF
( 1078)   ENDIF
( 1079)   IF(fields(FIELD_VISCOSITY).EQ.1) THEN
( 1080)     IF(use_fortran_kernels) THEN
( 1081)       CALL clover_unpack_message_left(chunks(chunk)%field%x_min,                    &
( 1082)                                       chunks(chunk)%field%x_max,                    &
( 1083)                                       chunks(chunk)%field%y_min,                    &
( 1084)                                       chunks(chunk)%field%y_max,                    &
( 1085)                                       chunks(chunk)%field%z_min,                    &
( 1086)                                       chunks(chunk)%field%z_max,                    &
( 1087)                                       chunks(chunk)%field%viscosity,                &
( 1088)                                       chunks(chunk)%left_rcv_buffer,                &
( 1089)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1090)                                       depth, CELL_DATA,                             &
( 1091)                                       left_right_offset(FIELD_VISCOSITY))
( 1092)     ELSE
( 1093)       CALL clover_unpack_message_left_c(chunks(chunk)%field%x_min,                    &
( 1094)                                         chunks(chunk)%field%x_max,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 20

( 1095)                                         chunks(chunk)%field%y_min,                    &
( 1096)                                         chunks(chunk)%field%y_max,                    &
( 1097)                                         chunks(chunk)%field%viscosity,                &
( 1098)                                         chunks(chunk)%left_rcv_buffer,                &
( 1099)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1100)                                         depth, CELL_DATA,                             &
( 1101)                                         left_right_offset(FIELD_VISCOSITY))
( 1102)     ENDIF
( 1103)   ENDIF
( 1104)   IF(fields(FIELD_SOUNDSPEED).EQ.1) THEN
( 1105)     IF(use_fortran_kernels) THEN
( 1106)       CALL clover_unpack_message_left(chunks(chunk)%field%x_min,                    &
( 1107)                                       chunks(chunk)%field%x_max,                    &
( 1108)                                       chunks(chunk)%field%y_min,                    &
( 1109)                                       chunks(chunk)%field%y_max,                    &
( 1110)                                       chunks(chunk)%field%z_min,                    &
( 1111)                                       chunks(chunk)%field%z_max,                    &
( 1112)                                       chunks(chunk)%field%soundspeed,               &
( 1113)                                       chunks(chunk)%left_rcv_buffer,                &
( 1114)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1115)                                       depth, CELL_DATA,                             &
( 1116)                                       left_right_offset(FIELD_SOUNDSPEED))
( 1117)     ELSE
( 1118)       CALL clover_unpack_message_left_c(chunks(chunk)%field%x_min,                    &
( 1119)                                         chunks(chunk)%field%x_max,                    &
( 1120)                                         chunks(chunk)%field%y_min,                    &
( 1121)                                         chunks(chunk)%field%y_max,                    &
( 1122)                                         chunks(chunk)%field%soundspeed,               &
( 1123)                                         chunks(chunk)%left_rcv_buffer,                &
( 1124)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1125)                                         depth, CELL_DATA,                             &
( 1126)                                         left_right_offset(FIELD_SOUNDSPEED))
( 1127)     ENDIF
( 1128)   ENDIF
( 1129)   IF(fields(FIELD_XVEL0).EQ.1) THEN
( 1130)     IF(use_fortran_kernels) THEN
( 1131)       CALL clover_unpack_message_left(chunks(chunk)%field%x_min,                    &
( 1132)                                       chunks(chunk)%field%x_max,                    &
( 1133)                                       chunks(chunk)%field%y_min,                    &
( 1134)                                       chunks(chunk)%field%y_max,                    &
( 1135)                                       chunks(chunk)%field%z_min,                    &
( 1136)                                       chunks(chunk)%field%z_max,                    &
( 1137)                                       chunks(chunk)%field%xvel0,                    &
( 1138)                                       chunks(chunk)%left_rcv_buffer,                &
( 1139)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1140)                                       depth, VERTEX_DATA,                           &
( 1141)                                       left_right_offset(FIELD_XVEL0))
( 1142)     ELSE
( 1143)       CALL clover_unpack_message_left_c(chunks(chunk)%field%x_min,                    &
( 1144)                                         chunks(chunk)%field%x_max,                    &
( 1145)                                         chunks(chunk)%field%y_min,                    &
( 1146)                                         chunks(chunk)%field%y_max,                    &
( 1147)                                         chunks(chunk)%field%xvel0,                    &
( 1148)                                         chunks(chunk)%left_rcv_buffer,                &
( 1149)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1150)                                         depth, VERTEX_DATA,                           &
( 1151)                                         left_right_offset(FIELD_XVEL0))
( 1152)     ENDIF






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 21

( 1153)   ENDIF
( 1154)   IF(fields(FIELD_XVEL1).EQ.1) THEN
( 1155)     IF(use_fortran_kernels) THEN
( 1156)       CALL clover_unpack_message_left(chunks(chunk)%field%x_min,                    &
( 1157)                                       chunks(chunk)%field%x_max,                    &
( 1158)                                       chunks(chunk)%field%y_min,                    &
( 1159)                                       chunks(chunk)%field%y_max,                    &
( 1160)                                       chunks(chunk)%field%z_min,                    &
( 1161)                                       chunks(chunk)%field%z_max,                    &
( 1162)                                       chunks(chunk)%field%xvel1,                    &
( 1163)                                       chunks(chunk)%left_rcv_buffer,                &
( 1164)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1165)                                       depth, VERTEX_DATA,                           &
( 1166)                                       left_right_offset(FIELD_XVEL1))
( 1167)     ELSE
( 1168)       CALL clover_unpack_message_left_c(chunks(chunk)%field%x_min,                    &
( 1169)                                         chunks(chunk)%field%x_max,                    &
( 1170)                                         chunks(chunk)%field%y_min,                    &
( 1171)                                         chunks(chunk)%field%y_max,                    &
( 1172)                                         chunks(chunk)%field%xvel1,                    &
( 1173)                                         chunks(chunk)%left_rcv_buffer,                &
( 1174)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1175)                                         depth, VERTEX_DATA,                           &
( 1176)                                         left_right_offset(FIELD_XVEL1))
( 1177)     ENDIF
( 1178)   ENDIF
( 1179)   IF(fields(FIELD_YVEL0).EQ.1) THEN
( 1180)     IF(use_fortran_kernels) THEN
( 1181)       CALL clover_unpack_message_left(chunks(chunk)%field%x_min,                    &
( 1182)                                       chunks(chunk)%field%x_max,                    &
( 1183)                                       chunks(chunk)%field%y_min,                    &
( 1184)                                       chunks(chunk)%field%y_max,                    &
( 1185)                                       chunks(chunk)%field%z_min,                    &
( 1186)                                       chunks(chunk)%field%z_max,                    &
( 1187)                                       chunks(chunk)%field%yvel0,                    &
( 1188)                                       chunks(chunk)%left_rcv_buffer,                &
( 1189)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1190)                                       depth, VERTEX_DATA,                           &
( 1191)                                       left_right_offset(FIELD_YVEL0))
( 1192)     ELSE
( 1193)       CALL clover_unpack_message_left_c(chunks(chunk)%field%x_min,                    &
( 1194)                                         chunks(chunk)%field%x_max,                    &
( 1195)                                         chunks(chunk)%field%y_min,                    &
( 1196)                                         chunks(chunk)%field%y_max,                    &
( 1197)                                         chunks(chunk)%field%yvel0,                    &
( 1198)                                         chunks(chunk)%left_rcv_buffer,                &
( 1199)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1200)                                         depth, VERTEX_DATA,                           &
( 1201)                                         left_right_offset(FIELD_YVEL0))
( 1202)     ENDIF
( 1203)   ENDIF
( 1204)   IF(fields(FIELD_YVEL1).EQ.1) THEN
( 1205)     IF(use_fortran_kernels) THEN
( 1206)       CALL clover_unpack_message_left(chunks(chunk)%field%x_min,                    &
( 1207)                                       chunks(chunk)%field%x_max,                    &
( 1208)                                       chunks(chunk)%field%y_min,                    &
( 1209)                                       chunks(chunk)%field%y_max,                    &
( 1210)                                       chunks(chunk)%field%z_min,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 22

( 1211)                                       chunks(chunk)%field%z_max,                    &
( 1212)                                       chunks(chunk)%field%yvel1,                    &
( 1213)                                       chunks(chunk)%left_rcv_buffer,                &
( 1214)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1215)                                       depth, VERTEX_DATA,                           &
( 1216)                                       left_right_offset(FIELD_YVEL1))
( 1217)     ELSE
( 1218)       CALL clover_unpack_message_left_c(chunks(chunk)%field%x_min,                    &
( 1219)                                         chunks(chunk)%field%x_max,                    &
( 1220)                                         chunks(chunk)%field%y_min,                    &
( 1221)                                         chunks(chunk)%field%y_max,                    &
( 1222)                                         chunks(chunk)%field%yvel1,                    &
( 1223)                                         chunks(chunk)%left_rcv_buffer,                &
( 1224)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1225)                                         depth, VERTEX_DATA,                           &
( 1226)                                         left_right_offset(FIELD_YVEL1))
( 1227)     ENDIF
( 1228)   ENDIF
( 1229)   IF(fields(FIELD_ZVEL0).EQ.1) THEN
( 1230)     IF(use_fortran_kernels) THEN
( 1231)       CALL clover_unpack_message_left(chunks(chunk)%field%x_min,                    &
( 1232)                                       chunks(chunk)%field%x_max,                    &
( 1233)                                       chunks(chunk)%field%y_min,                    &
( 1234)                                       chunks(chunk)%field%y_max,                    &
( 1235)                                       chunks(chunk)%field%z_min,                    &
( 1236)                                       chunks(chunk)%field%z_max,                    &
( 1237)                                       chunks(chunk)%field%zvel0,                    &
( 1238)                                       chunks(chunk)%left_rcv_buffer,                &
( 1239)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1240)                                       depth, VERTEX_DATA,                           &
( 1241)                                       left_right_offset(FIELD_ZVEL0))
( 1242)     ELSE
( 1243)       CALL clover_unpack_message_left_c(chunks(chunk)%field%x_min,                    &
( 1244)                                         chunks(chunk)%field%x_max,                    &
( 1245)                                         chunks(chunk)%field%y_min,                    &
( 1246)                                         chunks(chunk)%field%y_max,                    &
( 1247)                                         chunks(chunk)%field%zvel0,                    &
( 1248)                                         chunks(chunk)%left_rcv_buffer,                &
( 1249)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1250)                                         depth, VERTEX_DATA,                           &
( 1251)                                         left_right_offset(FIELD_ZVEL0))
( 1252)     ENDIF
( 1253)   ENDIF
( 1254)   IF(fields(FIELD_ZVEL1).EQ.1) THEN
( 1255)     IF(use_fortran_kernels) THEN
( 1256)       CALL clover_unpack_message_left(chunks(chunk)%field%x_min,                    &
( 1257)                                       chunks(chunk)%field%x_max,                    &
( 1258)                                       chunks(chunk)%field%y_min,                    &
( 1259)                                       chunks(chunk)%field%y_max,                    &
( 1260)                                       chunks(chunk)%field%z_min,                    &
( 1261)                                       chunks(chunk)%field%z_max,                    &
( 1262)                                       chunks(chunk)%field%zvel1,                    &
( 1263)                                       chunks(chunk)%left_rcv_buffer,                &
( 1264)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1265)                                       depth, VERTEX_DATA,                           &
( 1266)                                       left_right_offset(FIELD_ZVEL1))
( 1267)     ELSE
( 1268)       CALL clover_unpack_message_left_c(chunks(chunk)%field%x_min,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 23

( 1269)                                         chunks(chunk)%field%x_max,                    &
( 1270)                                         chunks(chunk)%field%y_min,                    &
( 1271)                                         chunks(chunk)%field%y_max,                    &
( 1272)                                         chunks(chunk)%field%zvel1,                    &
( 1273)                                         chunks(chunk)%left_rcv_buffer,                &
( 1274)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1275)                                         depth, VERTEX_DATA,                           &
( 1276)                                         left_right_offset(FIELD_ZVEL1))
( 1277)     ENDIF
( 1278)   ENDIF
( 1279)   IF(fields(FIELD_VOL_FLUX_X).EQ.1) THEN
( 1280)     IF(use_fortran_kernels) THEN
( 1281)       CALL clover_unpack_message_left(chunks(chunk)%field%x_min,                    &
( 1282)                                       chunks(chunk)%field%x_max,                    &
( 1283)                                       chunks(chunk)%field%y_min,                    &
( 1284)                                       chunks(chunk)%field%y_max,                    &
( 1285)                                       chunks(chunk)%field%z_min,                    &
( 1286)                                       chunks(chunk)%field%z_max,                    &
( 1287)                                       chunks(chunk)%field%vol_flux_x,               &
( 1288)                                       chunks(chunk)%left_rcv_buffer,                &
( 1289)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1290)                                       depth, X_FACE_DATA,                           &
( 1291)                                       left_right_offset(FIELD_VOL_FLUX_X))
( 1292)     ELSE
( 1293)       CALL clover_unpack_message_left_c(chunks(chunk)%field%x_min,                    &
( 1294)                                         chunks(chunk)%field%x_max,                    &
( 1295)                                         chunks(chunk)%field%y_min,                    &
( 1296)                                         chunks(chunk)%field%y_max,                    &
( 1297)                                         chunks(chunk)%field%vol_flux_x,               &
( 1298)                                         chunks(chunk)%left_rcv_buffer,                &
( 1299)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1300)                                         depth, X_FACE_DATA,                           &
( 1301)                                         left_right_offset(FIELD_VOL_FLUX_X))
( 1302)     ENDIF
( 1303)   ENDIF
( 1304)   IF(fields(FIELD_VOL_FLUX_Y).EQ.1) THEN
( 1305)     IF(use_fortran_kernels) THEN
( 1306)       CALL clover_unpack_message_left(chunks(chunk)%field%x_min,                    &
( 1307)                                       chunks(chunk)%field%x_max,                    &
( 1308)                                       chunks(chunk)%field%y_min,                    &
( 1309)                                       chunks(chunk)%field%y_max,                    &
( 1310)                                       chunks(chunk)%field%z_min,                    &
( 1311)                                       chunks(chunk)%field%z_max,                    &
( 1312)                                       chunks(chunk)%field%vol_flux_y,               &
( 1313)                                       chunks(chunk)%left_rcv_buffer,                &
( 1314)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1315)                                       depth, Y_FACE_DATA,                           &
( 1316)                                       left_right_offset(FIELD_VOL_FLUX_Y))
( 1317)     ELSE
( 1318)       CALL clover_unpack_message_left_c(chunks(chunk)%field%x_min,                    &
( 1319)                                         chunks(chunk)%field%x_max,                    &
( 1320)                                         chunks(chunk)%field%y_min,                    &
( 1321)                                         chunks(chunk)%field%y_max,                    &
( 1322)                                         chunks(chunk)%field%vol_flux_y,               &
( 1323)                                         chunks(chunk)%left_rcv_buffer,                &
( 1324)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1325)                                         depth, Y_FACE_DATA,                           &
( 1326)                                         left_right_offset(FIELD_VOL_FLUX_Y))






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 24

( 1327)     ENDIF
( 1328)   ENDIF
( 1329)   IF(fields(FIELD_VOL_FLUX_Z).EQ.1) THEN
( 1330)     IF(use_fortran_kernels) THEN
( 1331)       CALL clover_unpack_message_left(chunks(chunk)%field%x_min,                    &
( 1332)                                       chunks(chunk)%field%x_max,                    &
( 1333)                                       chunks(chunk)%field%y_min,                    &
( 1334)                                       chunks(chunk)%field%y_max,                    &
( 1335)                                       chunks(chunk)%field%z_min,                    &
( 1336)                                       chunks(chunk)%field%z_max,                    &
( 1337)                                       chunks(chunk)%field%vol_flux_z,               &
( 1338)                                       chunks(chunk)%left_rcv_buffer,                &
( 1339)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1340)                                       depth, Z_FACE_DATA,                           &
( 1341)                                       left_right_offset(FIELD_VOL_FLUX_Z))
( 1342)     ELSE
( 1343)       CALL clover_unpack_message_left_c(chunks(chunk)%field%x_min,                    &
( 1344)                                         chunks(chunk)%field%x_max,                    &
( 1345)                                         chunks(chunk)%field%y_min,                    &
( 1346)                                         chunks(chunk)%field%y_max,                    &
( 1347)                                         chunks(chunk)%field%vol_flux_z,               &
( 1348)                                         chunks(chunk)%left_rcv_buffer,                &
( 1349)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1350)                                         depth, Z_FACE_DATA,                           &
( 1351)                                         left_right_offset(FIELD_VOL_FLUX_Z))
( 1352)     ENDIF
( 1353)   ENDIF
( 1354)   IF(fields(FIELD_MASS_FLUX_X).EQ.1) THEN
( 1355)     IF(use_fortran_kernels) THEN
( 1356)       CALL clover_unpack_message_left(chunks(chunk)%field%x_min,                    &
( 1357)                                       chunks(chunk)%field%x_max,                    &
( 1358)                                       chunks(chunk)%field%y_min,                    &
( 1359)                                       chunks(chunk)%field%y_max,                    &
( 1360)                                       chunks(chunk)%field%z_min,                    &
( 1361)                                       chunks(chunk)%field%z_max,                    &
( 1362)                                       chunks(chunk)%field%mass_flux_x,              &
( 1363)                                       chunks(chunk)%left_rcv_buffer,                &
( 1364)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1365)                                       depth, X_FACE_DATA,                           &
( 1366)                                       left_right_offset(FIELD_MASS_FLUX_X))
( 1367)     ELSE
( 1368)       CALL clover_unpack_message_left_c(chunks(chunk)%field%x_min,                    &
( 1369)                                         chunks(chunk)%field%x_max,                    &
( 1370)                                         chunks(chunk)%field%y_min,                    &
( 1371)                                         chunks(chunk)%field%y_max,                    &
( 1372)                                         chunks(chunk)%field%mass_flux_x,              &
( 1373)                                         chunks(chunk)%left_rcv_buffer,                &
( 1374)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1375)                                         depth, X_FACE_DATA,                           &
( 1376)                                         left_right_offset(FIELD_MASS_FLUX_X))
( 1377)     ENDIF
( 1378)   ENDIF
( 1379)   IF(fields(FIELD_MASS_FLUX_Y).EQ.1) THEN
( 1380)     IF(use_fortran_kernels) THEN
( 1381)       CALL clover_unpack_message_left(chunks(chunk)%field%x_min,                    &
( 1382)                                       chunks(chunk)%field%x_max,                    &
( 1383)                                       chunks(chunk)%field%y_min,                    &
( 1384)                                       chunks(chunk)%field%y_max,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 25

( 1385)                                       chunks(chunk)%field%z_min,                    &
( 1386)                                       chunks(chunk)%field%z_max,                    &
( 1387)                                       chunks(chunk)%field%mass_flux_y,              &
( 1388)                                       chunks(chunk)%left_rcv_buffer,                &
( 1389)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1390)                                       depth, Y_FACE_DATA,                           &
( 1391)                                       left_right_offset(FIELD_MASS_FLUX_Y))
( 1392)     ELSE
( 1393)       CALL clover_unpack_message_left_c(chunks(chunk)%field%x_min,                    &
( 1394)                                         chunks(chunk)%field%x_max,                    &
( 1395)                                         chunks(chunk)%field%y_min,                    &
( 1396)                                         chunks(chunk)%field%y_max,                    &
( 1397)                                         chunks(chunk)%field%mass_flux_y,              &
( 1398)                                         chunks(chunk)%left_rcv_buffer,                &
( 1399)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1400)                                         depth, Y_FACE_DATA,                           &
( 1401)                                         left_right_offset(FIELD_MASS_FLUX_Y))
( 1402)     ENDIF
( 1403)   ENDIF
( 1404)   IF(fields(FIELD_MASS_FLUX_Z).EQ.1) THEN
( 1405)     IF(use_fortran_kernels) THEN
( 1406)       CALL clover_unpack_message_left(chunks(chunk)%field%x_min,                    &
( 1407)                                       chunks(chunk)%field%x_max,                    &
( 1408)                                       chunks(chunk)%field%y_min,                    &
( 1409)                                       chunks(chunk)%field%y_max,                    &
( 1410)                                       chunks(chunk)%field%z_min,                    &
( 1411)                                       chunks(chunk)%field%z_max,                    &
( 1412)                                       chunks(chunk)%field%mass_flux_z,              &
( 1413)                                       chunks(chunk)%left_rcv_buffer,                &
( 1414)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1415)                                       depth, Z_FACE_DATA,                           &
( 1416)                                       left_right_offset(FIELD_MASS_FLUX_Z))
( 1417)     ELSE
( 1418)       CALL clover_unpack_message_left_c(chunks(chunk)%field%x_min,                    &
( 1419)                                         chunks(chunk)%field%x_max,                    &
( 1420)                                         chunks(chunk)%field%y_min,                    &
( 1421)                                         chunks(chunk)%field%y_max,                    &
( 1422)                                         chunks(chunk)%field%mass_flux_z,              &
( 1423)                                         chunks(chunk)%left_rcv_buffer,                &
( 1424)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1425)                                         depth, Z_FACE_DATA,                           &
( 1426)                                         left_right_offset(FIELD_MASS_FLUX_Z))
( 1427)     ENDIF
( 1428)   ENDIF
( 1429) 
( 1430) END SUBROUTINE clover_unpack_left
( 1431) 
( 1432) SUBROUTINE clover_pack_right(chunk, fields, depth, left_right_offset)
( 1433) 
( 1434)   USE pack_kernel_module
( 1435) 
( 1436)   IMPLICIT NONE
( 1437) 
( 1438)   INTEGER        :: chunk, fields(:), depth, tot_packr, left_right_offset(:)
( 1439) 
( 1440)   IF(fields(FIELD_DENSITY0).EQ.1) THEN
( 1441)     IF(use_fortran_kernels) THEN
( 1442)       CALL clover_pack_message_right(chunks(chunk)%field%x_min,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 26

( 1443)                                      chunks(chunk)%field%x_max,                    &
( 1444)                                      chunks(chunk)%field%y_min,                    &
( 1445)                                      chunks(chunk)%field%y_max,                    &
( 1446)                                      chunks(chunk)%field%z_min,                    &
( 1447)                                      chunks(chunk)%field%z_max,                    &
( 1448)                                      chunks(chunk)%field%density0,                 &
( 1449)                                      chunks(chunk)%right_snd_buffer,               &
( 1450)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 1451)                                      depth, CELL_DATA,                             &
( 1452)                                      left_right_offset(FIELD_DENSITY0))
( 1453)     ELSE
( 1454)       CALL clover_pack_message_right_c(chunks(chunk)%field%x_min,                    &
( 1455)                                        chunks(chunk)%field%x_max,                    &
( 1456)                                        chunks(chunk)%field%y_min,                    &
( 1457)                                        chunks(chunk)%field%y_max,                    &
( 1458)                                        chunks(chunk)%field%density0,                 &
( 1459)                                        chunks(chunk)%right_snd_buffer,               &
( 1460)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1461)                                        depth, CELL_DATA,                             &
( 1462)                                        left_right_offset(FIELD_DENSITY0))
( 1463)     ENDIF
( 1464)   ENDIF
( 1465)   IF(fields(FIELD_DENSITY1).EQ.1) THEN
( 1466)     IF(use_fortran_kernels) THEN
( 1467)       CALL clover_pack_message_right(chunks(chunk)%field%x_min,                    &
( 1468)                                      chunks(chunk)%field%x_max,                    &
( 1469)                                      chunks(chunk)%field%y_min,                    &
( 1470)                                      chunks(chunk)%field%y_max,                    &
( 1471)                                      chunks(chunk)%field%z_min,                    &
( 1472)                                      chunks(chunk)%field%z_max,                    &
( 1473)                                      chunks(chunk)%field%density1,                 &
( 1474)                                      chunks(chunk)%right_snd_buffer,               &
( 1475)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 1476)                                      depth, CELL_DATA,                             &
( 1477)                                      left_right_offset(FIELD_DENSITY1))
( 1478)     ELSE
( 1479)       CALL clover_pack_message_right_c(chunks(chunk)%field%x_min,                    &
( 1480)                                        chunks(chunk)%field%x_max,                    &
( 1481)                                        chunks(chunk)%field%y_min,                    &
( 1482)                                        chunks(chunk)%field%y_max,                    &
( 1483)                                        chunks(chunk)%field%density1,                 &
( 1484)                                        chunks(chunk)%right_snd_buffer,               &
( 1485)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1486)                                        depth, CELL_DATA,                             &
( 1487)                                        left_right_offset(FIELD_DENSITY1))
( 1488)     ENDIF
( 1489)   ENDIF
( 1490)   IF(fields(FIELD_ENERGY0).EQ.1) THEN
( 1491)     IF(use_fortran_kernels) THEN
( 1492)       CALL clover_pack_message_right(chunks(chunk)%field%x_min,                    &
( 1493)                                      chunks(chunk)%field%x_max,                    &
( 1494)                                      chunks(chunk)%field%y_min,                    &
( 1495)                                      chunks(chunk)%field%y_max,                    &
( 1496)                                      chunks(chunk)%field%z_min,                    &
( 1497)                                      chunks(chunk)%field%z_max,                    &
( 1498)                                      chunks(chunk)%field%energy0,                  &
( 1499)                                      chunks(chunk)%right_snd_buffer,               &
( 1500)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 27

( 1501)                                      depth, CELL_DATA,                             &
( 1502)                                      left_right_offset(FIELD_ENERGY0))
( 1503)     ELSE
( 1504)       CALL clover_pack_message_right_c(chunks(chunk)%field%x_min,                    &
( 1505)                                        chunks(chunk)%field%x_max,                    &
( 1506)                                        chunks(chunk)%field%y_min,                    &
( 1507)                                        chunks(chunk)%field%y_max,                    &
( 1508)                                        chunks(chunk)%field%energy0,                  &
( 1509)                                        chunks(chunk)%right_snd_buffer,               &
( 1510)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1511)                                        depth, CELL_DATA,                             &
( 1512)                                        left_right_offset(FIELD_ENERGY0))
( 1513)     ENDIF
( 1514)   ENDIF
( 1515)   IF(fields(FIELD_ENERGY1).EQ.1) THEN
( 1516)     IF(use_fortran_kernels) THEN
( 1517)       CALL clover_pack_message_right(chunks(chunk)%field%x_min,                    &
( 1518)                                      chunks(chunk)%field%x_max,                    &
( 1519)                                      chunks(chunk)%field%y_min,                    &
( 1520)                                      chunks(chunk)%field%y_max,                    &
( 1521)                                      chunks(chunk)%field%z_min,                    &
( 1522)                                      chunks(chunk)%field%z_max,                    &
( 1523)                                      chunks(chunk)%field%energy1,                  &
( 1524)                                      chunks(chunk)%right_snd_buffer,               &
( 1525)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 1526)                                      depth, CELL_DATA,                             &
( 1527)                                      left_right_offset(FIELD_ENERGY1))
( 1528)     ELSE
( 1529)       CALL clover_pack_message_right_c(chunks(chunk)%field%x_min,                    &
( 1530)                                        chunks(chunk)%field%x_max,                    &
( 1531)                                        chunks(chunk)%field%y_min,                    &
( 1532)                                        chunks(chunk)%field%y_max,                    &
( 1533)                                        chunks(chunk)%field%energy1,                  &
( 1534)                                        chunks(chunk)%right_snd_buffer,               &
( 1535)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1536)                                        depth, CELL_DATA,                             &
( 1537)                                        left_right_offset(FIELD_ENERGY1))
( 1538)     ENDIF
( 1539)   ENDIF
( 1540)   IF(fields(FIELD_PRESSURE).EQ.1) THEN
( 1541)     IF(use_fortran_kernels) THEN
( 1542)       CALL clover_pack_message_right(chunks(chunk)%field%x_min,                    &
( 1543)                                      chunks(chunk)%field%x_max,                    &
( 1544)                                      chunks(chunk)%field%y_min,                    &
( 1545)                                      chunks(chunk)%field%y_max,                    &
( 1546)                                      chunks(chunk)%field%z_min,                    &
( 1547)                                      chunks(chunk)%field%z_max,                    &
( 1548)                                      chunks(chunk)%field%pressure,                 &
( 1549)                                      chunks(chunk)%right_snd_buffer,               &
( 1550)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 1551)                                      depth, CELL_DATA,                             &
( 1552)                                      left_right_offset(FIELD_PRESSURE))
( 1553)     ELSE
( 1554)       CALL clover_pack_message_right_c(chunks(chunk)%field%x_min,                    &
( 1555)                                        chunks(chunk)%field%x_max,                    &
( 1556)                                        chunks(chunk)%field%y_min,                    &
( 1557)                                        chunks(chunk)%field%y_max,                    &
( 1558)                                        chunks(chunk)%field%pressure,                 &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 28

( 1559)                                        chunks(chunk)%right_snd_buffer,               &
( 1560)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1561)                                        depth, CELL_DATA,                             &
( 1562)                                        left_right_offset(FIELD_PRESSURE))
( 1563)     ENDIF
( 1564)   ENDIF
( 1565)   IF(fields(FIELD_VISCOSITY).EQ.1) THEN
( 1566)     IF(use_fortran_kernels) THEN
( 1567)       CALL clover_pack_message_right(chunks(chunk)%field%x_min,                    &
( 1568)                                      chunks(chunk)%field%x_max,                    &
( 1569)                                      chunks(chunk)%field%y_min,                    &
( 1570)                                      chunks(chunk)%field%y_max,                    &
( 1571)                                      chunks(chunk)%field%z_min,                    &
( 1572)                                      chunks(chunk)%field%z_max,                    &
( 1573)                                      chunks(chunk)%field%viscosity,                &
( 1574)                                      chunks(chunk)%right_snd_buffer,               &
( 1575)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 1576)                                      depth, CELL_DATA,                             &
( 1577)                                      left_right_offset(FIELD_VISCOSITY))
( 1578)     ELSE
( 1579)       CALL clover_pack_message_right_c(chunks(chunk)%field%x_min,                    &
( 1580)                                        chunks(chunk)%field%x_max,                    &
( 1581)                                        chunks(chunk)%field%y_min,                    &
( 1582)                                        chunks(chunk)%field%y_max,                    &
( 1583)                                        chunks(chunk)%field%viscosity,                &
( 1584)                                        chunks(chunk)%right_snd_buffer,               &
( 1585)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1586)                                        depth, CELL_DATA,                             &
( 1587)                                        left_right_offset(FIELD_VISCOSITY))
( 1588)     ENDIF
( 1589)   ENDIF
( 1590)   IF(fields(FIELD_SOUNDSPEED).EQ.1) THEN
( 1591)     IF(use_fortran_kernels) THEN
( 1592)       CALL clover_pack_message_right(chunks(chunk)%field%x_min,                    &
( 1593)                                      chunks(chunk)%field%x_max,                    &
( 1594)                                      chunks(chunk)%field%y_min,                    &
( 1595)                                      chunks(chunk)%field%y_max,                    &
( 1596)                                      chunks(chunk)%field%z_min,                    &
( 1597)                                      chunks(chunk)%field%z_max,                    &
( 1598)                                      chunks(chunk)%field%soundspeed,               &
( 1599)                                      chunks(chunk)%right_snd_buffer,               &
( 1600)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 1601)                                      depth, CELL_DATA,                             &
( 1602)                                      left_right_offset(FIELD_SOUNDSPEED))
( 1603)     ELSE
( 1604)       CALL clover_pack_message_right_c(chunks(chunk)%field%x_min,                    &
( 1605)                                        chunks(chunk)%field%x_max,                    &
( 1606)                                        chunks(chunk)%field%y_min,                    &
( 1607)                                        chunks(chunk)%field%y_max,                    &
( 1608)                                        chunks(chunk)%field%soundspeed,               &
( 1609)                                        chunks(chunk)%right_snd_buffer,               &
( 1610)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1611)                                        depth, CELL_DATA,                             &
( 1612)                                        left_right_offset(FIELD_SOUNDSPEED))
( 1613)     ENDIF
( 1614)   ENDIF
( 1615)   IF(fields(FIELD_XVEL0).EQ.1) THEN
( 1616)     IF(use_fortran_kernels) THEN






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 29

( 1617)       CALL clover_pack_message_right(chunks(chunk)%field%x_min,                    &
( 1618)                                      chunks(chunk)%field%x_max,                    &
( 1619)                                      chunks(chunk)%field%y_min,                    &
( 1620)                                      chunks(chunk)%field%y_max,                    &
( 1621)                                      chunks(chunk)%field%z_min,                    &
( 1622)                                      chunks(chunk)%field%z_max,                    &
( 1623)                                      chunks(chunk)%field%xvel0,                    &
( 1624)                                      chunks(chunk)%right_snd_buffer,               &
( 1625)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 1626)                                      depth, VERTEX_DATA,                           &
( 1627)                                      left_right_offset(FIELD_XVEL0))
( 1628)     ELSE
( 1629)       CALL clover_pack_message_right_c(chunks(chunk)%field%x_min,                    &
( 1630)                                        chunks(chunk)%field%x_max,                    &
( 1631)                                        chunks(chunk)%field%y_min,                    &
( 1632)                                        chunks(chunk)%field%y_max,                    &
( 1633)                                        chunks(chunk)%field%xvel0,                    &
( 1634)                                        chunks(chunk)%right_snd_buffer,               &
( 1635)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1636)                                        depth, VERTEX_DATA,                           &
( 1637)                                        left_right_offset(FIELD_XVEL0))
( 1638)     ENDIF
( 1639)   ENDIF
( 1640)   IF(fields(FIELD_XVEL1).EQ.1) THEN
( 1641)     IF(use_fortran_kernels) THEN
( 1642)       CALL clover_pack_message_right(chunks(chunk)%field%x_min,                    &
( 1643)                                      chunks(chunk)%field%x_max,                    &
( 1644)                                      chunks(chunk)%field%y_min,                    &
( 1645)                                      chunks(chunk)%field%y_max,                    &
( 1646)                                      chunks(chunk)%field%z_min,                    &
( 1647)                                      chunks(chunk)%field%z_max,                    &
( 1648)                                      chunks(chunk)%field%xvel1,                    &
( 1649)                                      chunks(chunk)%right_snd_buffer,               &
( 1650)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 1651)                                      depth, VERTEX_DATA,                           &
( 1652)                                      left_right_offset(FIELD_XVEL1))
( 1653)     ELSE
( 1654)       CALL clover_pack_message_right_c(chunks(chunk)%field%x_min,                    &
( 1655)                                        chunks(chunk)%field%x_max,                    &
( 1656)                                        chunks(chunk)%field%y_min,                    &
( 1657)                                        chunks(chunk)%field%y_max,                    &
( 1658)                                        chunks(chunk)%field%xvel1,                    &
( 1659)                                        chunks(chunk)%right_snd_buffer,               &
( 1660)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1661)                                        depth, VERTEX_DATA,                           &
( 1662)                                        left_right_offset(FIELD_XVEL1))
( 1663)     ENDIF
( 1664)   ENDIF
( 1665)   IF(fields(FIELD_YVEL0).EQ.1) THEN
( 1666)     IF(use_fortran_kernels) THEN
( 1667)       CALL clover_pack_message_right(chunks(chunk)%field%x_min,                    &
( 1668)                                      chunks(chunk)%field%x_max,                    &
( 1669)                                      chunks(chunk)%field%y_min,                    &
( 1670)                                      chunks(chunk)%field%y_max,                    &
( 1671)                                      chunks(chunk)%field%z_min,                    &
( 1672)                                      chunks(chunk)%field%z_max,                    &
( 1673)                                      chunks(chunk)%field%yvel0,                    &
( 1674)                                      chunks(chunk)%right_snd_buffer,               &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 30

( 1675)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 1676)                                      depth, VERTEX_DATA,                           &
( 1677)                                      left_right_offset(FIELD_YVEL0))
( 1678)     ELSE
( 1679)       CALL clover_pack_message_right_c(chunks(chunk)%field%x_min,                    &
( 1680)                                        chunks(chunk)%field%x_max,                    &
( 1681)                                        chunks(chunk)%field%y_min,                    &
( 1682)                                        chunks(chunk)%field%y_max,                    &
( 1683)                                        chunks(chunk)%field%yvel0,                    &
( 1684)                                        chunks(chunk)%right_snd_buffer,               &
( 1685)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1686)                                        depth, VERTEX_DATA,                           &
( 1687)                                        left_right_offset(FIELD_YVEL0))
( 1688)     ENDIF
( 1689)   ENDIF
( 1690)   IF(fields(FIELD_YVEL1).EQ.1) THEN
( 1691)     IF(use_fortran_kernels) THEN
( 1692)       CALL clover_pack_message_right(chunks(chunk)%field%x_min,                    &
( 1693)                                      chunks(chunk)%field%x_max,                    &
( 1694)                                      chunks(chunk)%field%y_min,                    &
( 1695)                                      chunks(chunk)%field%y_max,                    &
( 1696)                                      chunks(chunk)%field%z_min,                    &
( 1697)                                      chunks(chunk)%field%z_max,                    &
( 1698)                                      chunks(chunk)%field%yvel1,                    &
( 1699)                                      chunks(chunk)%right_snd_buffer,               &
( 1700)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 1701)                                      depth, VERTEX_DATA,                           &
( 1702)                                      left_right_offset(FIELD_YVEL1))
( 1703)     ELSE
( 1704)       CALL clover_pack_message_right_c(chunks(chunk)%field%x_min,                    &
( 1705)                                        chunks(chunk)%field%x_max,                    &
( 1706)                                        chunks(chunk)%field%y_min,                    &
( 1707)                                        chunks(chunk)%field%y_max,                    &
( 1708)                                        chunks(chunk)%field%yvel1,                    &
( 1709)                                        chunks(chunk)%right_snd_buffer,               &
( 1710)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1711)                                        depth, VERTEX_DATA,                           &
( 1712)                                        left_right_offset(FIELD_YVEL1))
( 1713)     ENDIF
( 1714)   ENDIF
( 1715)   IF(fields(FIELD_ZVEL0).EQ.1) THEN
( 1716)     IF(use_fortran_kernels) THEN
( 1717)       CALL clover_pack_message_right(chunks(chunk)%field%x_min,                    &
( 1718)                                      chunks(chunk)%field%x_max,                    &
( 1719)                                      chunks(chunk)%field%y_min,                    &
( 1720)                                      chunks(chunk)%field%y_max,                    &
( 1721)                                      chunks(chunk)%field%z_min,                    &
( 1722)                                      chunks(chunk)%field%z_max,                    &
( 1723)                                      chunks(chunk)%field%zvel0,                    &
( 1724)                                      chunks(chunk)%right_snd_buffer,               &
( 1725)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 1726)                                      depth, VERTEX_DATA,                           &
( 1727)                                      left_right_offset(FIELD_ZVEL0))
( 1728)     ELSE
( 1729)       CALL clover_pack_message_right_c(chunks(chunk)%field%x_min,                    &
( 1730)                                        chunks(chunk)%field%x_max,                    &
( 1731)                                        chunks(chunk)%field%y_min,                    &
( 1732)                                        chunks(chunk)%field%y_max,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 31

( 1733)                                        chunks(chunk)%field%zvel0,                    &
( 1734)                                        chunks(chunk)%right_snd_buffer,               &
( 1735)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1736)                                        depth, VERTEX_DATA,                           &
( 1737)                                        left_right_offset(FIELD_ZVEL0))
( 1738)     ENDIF
( 1739)   ENDIF
( 1740)   IF(fields(FIELD_ZVEL1).EQ.1) THEN
( 1741)     IF(use_fortran_kernels) THEN
( 1742)       CALL clover_pack_message_right(chunks(chunk)%field%x_min,                    &
( 1743)                                      chunks(chunk)%field%x_max,                    &
( 1744)                                      chunks(chunk)%field%y_min,                    &
( 1745)                                      chunks(chunk)%field%y_max,                    &
( 1746)                                      chunks(chunk)%field%z_min,                    &
( 1747)                                      chunks(chunk)%field%z_max,                    &
( 1748)                                      chunks(chunk)%field%zvel1,                    &
( 1749)                                      chunks(chunk)%right_snd_buffer,               &
( 1750)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 1751)                                      depth, VERTEX_DATA,                           &
( 1752)                                      left_right_offset(FIELD_ZVEL1))
( 1753)     ELSE
( 1754)       CALL clover_pack_message_right_c(chunks(chunk)%field%x_min,                    &
( 1755)                                        chunks(chunk)%field%x_max,                    &
( 1756)                                        chunks(chunk)%field%y_min,                    &
( 1757)                                        chunks(chunk)%field%y_max,                    &
( 1758)                                        chunks(chunk)%field%zvel1,                    &
( 1759)                                        chunks(chunk)%right_snd_buffer,               &
( 1760)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1761)                                        depth, VERTEX_DATA,                           &
( 1762)                                        left_right_offset(FIELD_ZVEL1))
( 1763)     ENDIF
( 1764)   ENDIF
( 1765)   IF(fields(FIELD_VOL_FLUX_X).EQ.1) THEN
( 1766)     IF(use_fortran_kernels) THEN
( 1767)       CALL clover_pack_message_right(chunks(chunk)%field%x_min,                    &
( 1768)                                      chunks(chunk)%field%x_max,                    &
( 1769)                                      chunks(chunk)%field%y_min,                    &
( 1770)                                      chunks(chunk)%field%y_max,                    &
( 1771)                                      chunks(chunk)%field%z_min,                    &
( 1772)                                      chunks(chunk)%field%z_max,                    &
( 1773)                                      chunks(chunk)%field%vol_flux_x,               &
( 1774)                                      chunks(chunk)%right_snd_buffer,               &
( 1775)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 1776)                                      depth, X_FACE_DATA,                           &
( 1777)                                      left_right_offset(FIELD_VOL_FLUX_X))
( 1778)     ELSE
( 1779)       CALL clover_pack_message_right_c(chunks(chunk)%field%x_min,                    &
( 1780)                                        chunks(chunk)%field%x_max,                    &
( 1781)                                        chunks(chunk)%field%y_min,                    &
( 1782)                                        chunks(chunk)%field%y_max,                    &
( 1783)                                        chunks(chunk)%field%vol_flux_x,               &
( 1784)                                        chunks(chunk)%right_snd_buffer,               &
( 1785)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1786)                                        depth, X_FACE_DATA,                           &
( 1787)                                        left_right_offset(FIELD_VOL_FLUX_X))
( 1788)     ENDIF
( 1789)   ENDIF
( 1790)   IF(fields(FIELD_VOL_FLUX_Y).EQ.1) THEN






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 32

( 1791)     IF(use_fortran_kernels) THEN
( 1792)       CALL clover_pack_message_right(chunks(chunk)%field%x_min,                    &
( 1793)                                      chunks(chunk)%field%x_max,                    &
( 1794)                                      chunks(chunk)%field%y_min,                    &
( 1795)                                      chunks(chunk)%field%y_max,                    &
( 1796)                                      chunks(chunk)%field%z_min,                    &
( 1797)                                      chunks(chunk)%field%z_max,                    &
( 1798)                                      chunks(chunk)%field%vol_flux_y,               &
( 1799)                                      chunks(chunk)%right_snd_buffer,               &
( 1800)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 1801)                                      depth, Y_FACE_DATA,                           &
( 1802)                                      left_right_offset(FIELD_VOL_FLUX_Y))
( 1803)     ELSE
( 1804)       CALL clover_pack_message_right_c(chunks(chunk)%field%x_min,                    &
( 1805)                                        chunks(chunk)%field%x_max,                    &
( 1806)                                        chunks(chunk)%field%y_min,                    &
( 1807)                                        chunks(chunk)%field%y_max,                    &
( 1808)                                        chunks(chunk)%field%vol_flux_y,               &
( 1809)                                        chunks(chunk)%right_snd_buffer,               &
( 1810)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1811)                                        depth, Y_FACE_DATA,                           &
( 1812)                                        left_right_offset(FIELD_VOL_FLUX_Y))
( 1813)     ENDIF
( 1814)   ENDIF
( 1815)   IF(fields(FIELD_VOL_FLUX_Z).EQ.1) THEN
( 1816)     IF(use_fortran_kernels) THEN
( 1817)       CALL clover_pack_message_right(chunks(chunk)%field%x_min,                    &
( 1818)                                      chunks(chunk)%field%x_max,                    &
( 1819)                                      chunks(chunk)%field%y_min,                    &
( 1820)                                      chunks(chunk)%field%y_max,                    &
( 1821)                                      chunks(chunk)%field%z_min,                    &
( 1822)                                      chunks(chunk)%field%z_max,                    &
( 1823)                                      chunks(chunk)%field%vol_flux_z,               &
( 1824)                                      chunks(chunk)%right_snd_buffer,               &
( 1825)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 1826)                                      depth, Z_FACE_DATA,                           &
( 1827)                                      left_right_offset(FIELD_VOL_FLUX_Z))
( 1828)     ELSE
( 1829)       CALL clover_pack_message_right_c(chunks(chunk)%field%x_min,                    &
( 1830)                                        chunks(chunk)%field%x_max,                    &
( 1831)                                        chunks(chunk)%field%y_min,                    &
( 1832)                                        chunks(chunk)%field%y_max,                    &
( 1833)                                        chunks(chunk)%field%vol_flux_z,               &
( 1834)                                        chunks(chunk)%right_snd_buffer,               &
( 1835)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1836)                                        depth, Z_FACE_DATA,                           &
( 1837)                                        left_right_offset(FIELD_VOL_FLUX_Z))
( 1838)     ENDIF
( 1839)   ENDIF
( 1840)   IF(fields(FIELD_MASS_FLUX_X).EQ.1) THEN
( 1841)     IF(use_fortran_kernels) THEN
( 1842)       CALL clover_pack_message_right(chunks(chunk)%field%x_min,                    &
( 1843)                                      chunks(chunk)%field%x_max,                    &
( 1844)                                      chunks(chunk)%field%y_min,                    &
( 1845)                                      chunks(chunk)%field%y_max,                    &
( 1846)                                      chunks(chunk)%field%z_min,                    &
( 1847)                                      chunks(chunk)%field%z_max,                    &
( 1848)                                      chunks(chunk)%field%mass_flux_x,              &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 33

( 1849)                                      chunks(chunk)%right_snd_buffer,               &
( 1850)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 1851)                                      depth, X_FACE_DATA,                           &
( 1852)                                      left_right_offset(FIELD_MASS_FLUX_X))
( 1853)     ELSE
( 1854)       CALL clover_pack_message_right_c(chunks(chunk)%field%x_min,                    &
( 1855)                                        chunks(chunk)%field%x_max,                    &
( 1856)                                        chunks(chunk)%field%y_min,                    &
( 1857)                                        chunks(chunk)%field%y_max,                    &
( 1858)                                        chunks(chunk)%field%mass_flux_x,              &
( 1859)                                        chunks(chunk)%right_snd_buffer,               &
( 1860)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1861)                                        depth, X_FACE_DATA,                           &
( 1862)                                        left_right_offset(FIELD_MASS_FLUX_X))
( 1863)     ENDIF
( 1864)   ENDIF
( 1865)   IF(fields(FIELD_MASS_FLUX_Y).EQ.1) THEN
( 1866)     IF(use_fortran_kernels) THEN
( 1867)       CALL clover_pack_message_right(chunks(chunk)%field%x_min,                    &
( 1868)                                      chunks(chunk)%field%x_max,                    &
( 1869)                                      chunks(chunk)%field%y_min,                    &
( 1870)                                      chunks(chunk)%field%y_max,                    &
( 1871)                                      chunks(chunk)%field%z_min,                    &
( 1872)                                      chunks(chunk)%field%z_max,                    &
( 1873)                                      chunks(chunk)%field%mass_flux_y,              &
( 1874)                                      chunks(chunk)%right_snd_buffer,               &
( 1875)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 1876)                                      depth, Y_FACE_DATA,                           &
( 1877)                                      left_right_offset(FIELD_MASS_FLUX_Y))
( 1878)     ELSE
( 1879)       CALL clover_pack_message_right_c(chunks(chunk)%field%x_min,                    &
( 1880)                                        chunks(chunk)%field%x_max,                    &
( 1881)                                        chunks(chunk)%field%y_min,                    &
( 1882)                                        chunks(chunk)%field%y_max,                    &
( 1883)                                        chunks(chunk)%field%mass_flux_y,              &
( 1884)                                        chunks(chunk)%right_snd_buffer,               &
( 1885)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1886)                                        depth, Y_FACE_DATA,                           &
( 1887)                                        left_right_offset(FIELD_MASS_FLUX_Y))
( 1888)     ENDIF
( 1889)   ENDIF
( 1890)   IF(fields(FIELD_MASS_FLUX_Z).EQ.1) THEN
( 1891)     IF(use_fortran_kernels) THEN
( 1892)       CALL clover_pack_message_right(chunks(chunk)%field%x_min,                    &
( 1893)                                      chunks(chunk)%field%x_max,                    &
( 1894)                                      chunks(chunk)%field%y_min,                    &
( 1895)                                      chunks(chunk)%field%y_max,                    &
( 1896)                                      chunks(chunk)%field%z_min,                    &
( 1897)                                      chunks(chunk)%field%z_max,                    &
( 1898)                                      chunks(chunk)%field%mass_flux_z,              &
( 1899)                                      chunks(chunk)%right_snd_buffer,               &
( 1900)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 1901)                                      depth, Z_FACE_DATA,                           &
( 1902)                                      left_right_offset(FIELD_MASS_FLUX_Z))
( 1903)     ELSE
( 1904)       CALL clover_pack_message_right_c(chunks(chunk)%field%x_min,                    &
( 1905)                                        chunks(chunk)%field%x_max,                    &
( 1906)                                        chunks(chunk)%field%y_min,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 34

( 1907)                                        chunks(chunk)%field%y_max,                    &
( 1908)                                        chunks(chunk)%field%mass_flux_z,              &
( 1909)                                        chunks(chunk)%right_snd_buffer,               &
( 1910)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1911)                                        depth, Z_FACE_DATA,                           &
( 1912)                                        left_right_offset(FIELD_MASS_FLUX_Z))
( 1913)     ENDIF
( 1914)   ENDIF
( 1915) 
( 1916) END SUBROUTINE clover_pack_right
( 1917) 
( 1918) SUBROUTINE clover_send_recv_message_right(right_snd_buffer, right_rcv_buffer,   &
( 1919)                                           chunk, total_size,                    &
( 1920)                                           tag_send, tag_recv,                   &
( 1921)                                           req_send, req_recv)
( 1922) 
( 1923)   IMPLICIT NONE
( 1924) 
( 1925)   REAL(KIND=8) :: right_snd_buffer(:), right_rcv_buffer(:)
( 1926)   INTEGER      :: right_task
( 1927)   INTEGER      :: chunk
( 1928)   INTEGER      :: total_size, tag_send, tag_recv, err
( 1929)   INTEGER      :: req_send, req_recv
( 1930) 
( 1931)   right_task=chunks(chunk)%chunk_neighbours(chunk_right) - 1
( 1932) 
( 1933)   CALL MPI_ISEND(right_snd_buffer,total_size,MPI_DOUBLE_PRECISION,right_task,tag_send, &
( 1934)                  MPI_COMM_WORLD,req_send,err)
( 1935) 
( 1936)   CALL MPI_IRECV(right_rcv_buffer,total_size,MPI_DOUBLE_PRECISION,right_task,tag_recv, &
( 1937)                  MPI_COMM_WORLD,req_recv,err)
( 1938) 
( 1939) END SUBROUTINE clover_send_recv_message_right
( 1940) 
( 1941) SUBROUTINE clover_unpack_right(fields, chunk, depth,                          &
( 1942)                                right_rcv_buffer,                              &
( 1943)                                left_right_offset)
( 1944) 
( 1945)   USE pack_kernel_module
( 1946) 
( 1947)   IMPLICIT NONE
( 1948) 
( 1949)   INTEGER         :: fields(:), chunk, total_in_right_buff, depth, left_right_offset(:)
( 1950)   REAL(KIND=8)    :: right_rcv_buffer(:)
( 1951) 
( 1952)   IF(fields(FIELD_DENSITY0).EQ.1) THEN
( 1953)     IF(use_fortran_kernels) THEN
( 1954)       CALL clover_unpack_message_right(chunks(chunk)%field%x_min,                    &
( 1955)                                        chunks(chunk)%field%x_max,                    &
( 1956)                                        chunks(chunk)%field%y_min,                    &
( 1957)                                        chunks(chunk)%field%y_max,                    &
( 1958)                                        chunks(chunk)%field%z_min,                    &
( 1959)                                        chunks(chunk)%field%z_max,                    &
( 1960)                                        chunks(chunk)%field%density0,                 &
( 1961)                                        chunks(chunk)%right_rcv_buffer,               &
( 1962)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 1963)                                        depth, CELL_DATA,                             &
( 1964)                                        left_right_offset(FIELD_DENSITY0))






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 35

( 1965)     ELSE
( 1966)       CALL clover_unpack_message_right_c(chunks(chunk)%field%x_min,                    &
( 1967)                                          chunks(chunk)%field%x_max,                    &
( 1968)                                          chunks(chunk)%field%y_min,                    &
( 1969)                                          chunks(chunk)%field%y_max,                    &
( 1970)                                          chunks(chunk)%field%density0,                 &
( 1971)                                          chunks(chunk)%right_rcv_buffer,               &
( 1972)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1973)                                          depth, CELL_DATA,                             &
( 1974)                                          left_right_offset(FIELD_DENSITY0))
( 1975)     ENDIF
( 1976)   ENDIF
( 1977)   IF(fields(FIELD_DENSITY1).EQ.1) THEN
( 1978)     IF(use_fortran_kernels) THEN
( 1979)       CALL clover_unpack_message_right(chunks(chunk)%field%x_min,                    &
( 1980)                                        chunks(chunk)%field%x_max,                    &
( 1981)                                        chunks(chunk)%field%y_min,                    &
( 1982)                                        chunks(chunk)%field%y_max,                    &
( 1983)                                        chunks(chunk)%field%z_min,                    &
( 1984)                                        chunks(chunk)%field%z_max,                    &
( 1985)                                        chunks(chunk)%field%density1,                 &
( 1986)                                        chunks(chunk)%right_rcv_buffer,               &
( 1987)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 1988)                                        depth, CELL_DATA,                             &
( 1989)                                        left_right_offset(FIELD_DENSITY1))
( 1990)     ELSE
( 1991)       CALL clover_unpack_message_right_c(chunks(chunk)%field%x_min,                    &
( 1992)                                          chunks(chunk)%field%x_max,                    &
( 1993)                                          chunks(chunk)%field%y_min,                    &
( 1994)                                          chunks(chunk)%field%y_max,                    &
( 1995)                                          chunks(chunk)%field%density1,                 &
( 1996)                                          chunks(chunk)%right_rcv_buffer,               &
( 1997)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 1998)                                          depth, CELL_DATA,                             &
( 1999)                                          left_right_offset(FIELD_DENSITY1))
( 2000)     ENDIF
( 2001)   ENDIF
( 2002)   IF(fields(FIELD_ENERGY0).EQ.1) THEN
( 2003)     IF(use_fortran_kernels) THEN
( 2004)       CALL clover_unpack_message_right(chunks(chunk)%field%x_min,                    &
( 2005)                                        chunks(chunk)%field%x_max,                    &
( 2006)                                        chunks(chunk)%field%y_min,                    &
( 2007)                                        chunks(chunk)%field%y_max,                    &
( 2008)                                        chunks(chunk)%field%z_min,                    &
( 2009)                                        chunks(chunk)%field%z_max,                    &
( 2010)                                        chunks(chunk)%field%energy0,                  &
( 2011)                                        chunks(chunk)%right_rcv_buffer,               &
( 2012)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2013)                                        depth, CELL_DATA,                             &
( 2014)                                        left_right_offset(FIELD_ENERGY0))
( 2015)     ELSE
( 2016)       CALL clover_unpack_message_right_c(chunks(chunk)%field%x_min,                    &
( 2017)                                          chunks(chunk)%field%x_max,                    &
( 2018)                                          chunks(chunk)%field%y_min,                    &
( 2019)                                          chunks(chunk)%field%y_max,                    &
( 2020)                                          chunks(chunk)%field%energy0,                  &
( 2021)                                          chunks(chunk)%right_rcv_buffer,               &
( 2022)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 36

( 2023)                                          depth, CELL_DATA,                             &
( 2024)                                          left_right_offset(FIELD_ENERGY0))
( 2025)     ENDIF
( 2026)   ENDIF
( 2027)   IF(fields(FIELD_ENERGY1).EQ.1) THEN
( 2028)     IF(use_fortran_kernels) THEN
( 2029)       CALL clover_unpack_message_right(chunks(chunk)%field%x_min,                    &
( 2030)                                        chunks(chunk)%field%x_max,                    &
( 2031)                                        chunks(chunk)%field%y_min,                    &
( 2032)                                        chunks(chunk)%field%y_max,                    &
( 2033)                                        chunks(chunk)%field%z_min,                    &
( 2034)                                        chunks(chunk)%field%z_max,                    &
( 2035)                                        chunks(chunk)%field%energy1,                  &
( 2036)                                        chunks(chunk)%right_rcv_buffer,               &
( 2037)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2038)                                        depth, CELL_DATA,                             &
( 2039)                                        left_right_offset(FIELD_ENERGY1))
( 2040)     ELSE
( 2041)       CALL clover_unpack_message_right_c(chunks(chunk)%field%x_min,                    &
( 2042)                                          chunks(chunk)%field%x_max,                    &
( 2043)                                          chunks(chunk)%field%y_min,                    &
( 2044)                                          chunks(chunk)%field%y_max,                    &
( 2045)                                          chunks(chunk)%field%energy1,                  &
( 2046)                                          chunks(chunk)%right_rcv_buffer,               &
( 2047)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2048)                                          depth, CELL_DATA,                             &
( 2049)                                          left_right_offset(FIELD_ENERGY1))
( 2050)     ENDIF
( 2051)   ENDIF
( 2052)   IF(fields(FIELD_PRESSURE).EQ.1) THEN
( 2053)     IF(use_fortran_kernels) THEN
( 2054)       CALL clover_unpack_message_right(chunks(chunk)%field%x_min,                    &
( 2055)                                        chunks(chunk)%field%x_max,                    &
( 2056)                                        chunks(chunk)%field%y_min,                    &
( 2057)                                        chunks(chunk)%field%y_max,                    &
( 2058)                                        chunks(chunk)%field%z_min,                    &
( 2059)                                        chunks(chunk)%field%z_max,                    &
( 2060)                                        chunks(chunk)%field%pressure,                 &
( 2061)                                        chunks(chunk)%right_rcv_buffer,               &
( 2062)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2063)                                        depth, CELL_DATA,                             &
( 2064)                                        left_right_offset(FIELD_PRESSURE))
( 2065)     ELSE
( 2066)       CALL clover_unpack_message_right_c(chunks(chunk)%field%x_min,                    &
( 2067)                                          chunks(chunk)%field%x_max,                    &
( 2068)                                          chunks(chunk)%field%y_min,                    &
( 2069)                                          chunks(chunk)%field%y_max,                    &
( 2070)                                          chunks(chunk)%field%pressure,                 &
( 2071)                                          chunks(chunk)%right_rcv_buffer,               &
( 2072)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2073)                                          depth, CELL_DATA,                             &
( 2074)                                          left_right_offset(FIELD_PRESSURE))
( 2075)     ENDIF
( 2076)   ENDIF
( 2077)   IF(fields(FIELD_VISCOSITY).EQ.1) THEN
( 2078)     IF(use_fortran_kernels) THEN
( 2079)       CALL clover_unpack_message_right(chunks(chunk)%field%x_min,                    &
( 2080)                                        chunks(chunk)%field%x_max,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 37

( 2081)                                        chunks(chunk)%field%y_min,                    &
( 2082)                                        chunks(chunk)%field%y_max,                    &
( 2083)                                        chunks(chunk)%field%z_min,                    &
( 2084)                                        chunks(chunk)%field%z_max,                    &
( 2085)                                        chunks(chunk)%field%viscosity,                &
( 2086)                                        chunks(chunk)%right_rcv_buffer,               &
( 2087)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2088)                                        depth, CELL_DATA,                             &
( 2089)                                        left_right_offset(FIELD_VISCOSITY))
( 2090)     ELSE
( 2091)       CALL clover_unpack_message_right_c(chunks(chunk)%field%x_min,                    &
( 2092)                                          chunks(chunk)%field%x_max,                    &
( 2093)                                          chunks(chunk)%field%y_min,                    &
( 2094)                                          chunks(chunk)%field%y_max,                    &
( 2095)                                          chunks(chunk)%field%viscosity,                &
( 2096)                                          chunks(chunk)%right_rcv_buffer,               &
( 2097)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2098)                                          depth, CELL_DATA,                             &
( 2099)                                          left_right_offset(FIELD_VISCOSITY))
( 2100)     ENDIF
( 2101)   ENDIF
( 2102)   IF(fields(FIELD_SOUNDSPEED).EQ.1) THEN
( 2103)     IF(use_fortran_kernels) THEN
( 2104)       CALL clover_unpack_message_right(chunks(chunk)%field%x_min,                    &
( 2105)                                        chunks(chunk)%field%x_max,                    &
( 2106)                                        chunks(chunk)%field%y_min,                    &
( 2107)                                        chunks(chunk)%field%y_max,                    &
( 2108)                                        chunks(chunk)%field%z_min,                    &
( 2109)                                        chunks(chunk)%field%z_max,                    &
( 2110)                                        chunks(chunk)%field%soundspeed,               &
( 2111)                                        chunks(chunk)%right_rcv_buffer,               &
( 2112)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2113)                                        depth, CELL_DATA,                             &
( 2114)                                        left_right_offset(FIELD_SOUNDSPEED))
( 2115)     ELSE
( 2116)       CALL clover_unpack_message_right_c(chunks(chunk)%field%x_min,                    &
( 2117)                                          chunks(chunk)%field%x_max,                    &
( 2118)                                          chunks(chunk)%field%y_min,                    &
( 2119)                                          chunks(chunk)%field%y_max,                    &
( 2120)                                          chunks(chunk)%field%soundspeed,               &
( 2121)                                          chunks(chunk)%right_rcv_buffer,               &
( 2122)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2123)                                          depth, CELL_DATA,                             &
( 2124)                                          left_right_offset(FIELD_SOUNDSPEED))
( 2125)     ENDIF
( 2126)   ENDIF
( 2127)   IF(fields(FIELD_XVEL0).EQ.1) THEN
( 2128)     IF(use_fortran_kernels) THEN
( 2129)       CALL clover_unpack_message_right(chunks(chunk)%field%x_min,                    &
( 2130)                                        chunks(chunk)%field%x_max,                    &
( 2131)                                        chunks(chunk)%field%y_min,                    &
( 2132)                                        chunks(chunk)%field%y_max,                    &
( 2133)                                        chunks(chunk)%field%z_min,                    &
( 2134)                                        chunks(chunk)%field%z_max,                    &
( 2135)                                        chunks(chunk)%field%xvel0,                    &
( 2136)                                        chunks(chunk)%right_rcv_buffer,               &
( 2137)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2138)                                        depth, VERTEX_DATA,                           &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 38

( 2139)                                        left_right_offset(FIELD_XVEL0))
( 2140)     ELSE
( 2141)       CALL clover_unpack_message_right_c(chunks(chunk)%field%x_min,                    &
( 2142)                                          chunks(chunk)%field%x_max,                    &
( 2143)                                          chunks(chunk)%field%y_min,                    &
( 2144)                                          chunks(chunk)%field%y_max,                    &
( 2145)                                          chunks(chunk)%field%xvel0,                    &
( 2146)                                          chunks(chunk)%right_rcv_buffer,               &
( 2147)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2148)                                          depth, VERTEX_DATA,                           &
( 2149)                                          left_right_offset(FIELD_XVEL0))
( 2150)     ENDIF
( 2151)   ENDIF
( 2152)   IF(fields(FIELD_XVEL1).EQ.1) THEN
( 2153)     IF(use_fortran_kernels) THEN
( 2154)       CALL clover_unpack_message_right(chunks(chunk)%field%x_min,                    &
( 2155)                                        chunks(chunk)%field%x_max,                    &
( 2156)                                        chunks(chunk)%field%y_min,                    &
( 2157)                                        chunks(chunk)%field%y_max,                    &
( 2158)                                        chunks(chunk)%field%z_min,                    &
( 2159)                                        chunks(chunk)%field%z_max,                    &
( 2160)                                        chunks(chunk)%field%xvel1,                    &
( 2161)                                        chunks(chunk)%right_rcv_buffer,               &
( 2162)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2163)                                        depth, VERTEX_DATA,                           &
( 2164)                                        left_right_offset(FIELD_XVEL1))
( 2165)     ELSE
( 2166)       CALL clover_unpack_message_right_c(chunks(chunk)%field%x_min,                    &
( 2167)                                          chunks(chunk)%field%x_max,                    &
( 2168)                                          chunks(chunk)%field%y_min,                    &
( 2169)                                          chunks(chunk)%field%y_max,                    &
( 2170)                                          chunks(chunk)%field%xvel1,                    &
( 2171)                                          chunks(chunk)%right_rcv_buffer,               &
( 2172)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2173)                                          depth, VERTEX_DATA,                           &
( 2174)                                          left_right_offset(FIELD_XVEL1))
( 2175)     ENDIF
( 2176)   ENDIF
( 2177)   IF(fields(FIELD_YVEL0).EQ.1) THEN
( 2178)     IF(use_fortran_kernels) THEN
( 2179)       CALL clover_unpack_message_right(chunks(chunk)%field%x_min,                    &
( 2180)                                        chunks(chunk)%field%x_max,                    &
( 2181)                                        chunks(chunk)%field%y_min,                    &
( 2182)                                        chunks(chunk)%field%y_max,                    &
( 2183)                                        chunks(chunk)%field%z_min,                    &
( 2184)                                        chunks(chunk)%field%z_max,                    &
( 2185)                                        chunks(chunk)%field%yvel0,                    &
( 2186)                                        chunks(chunk)%right_rcv_buffer,               &
( 2187)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2188)                                        depth, VERTEX_DATA,                           &
( 2189)                                        left_right_offset(FIELD_YVEL0))
( 2190)     ELSE
( 2191)       CALL clover_unpack_message_right_c(chunks(chunk)%field%x_min,                    &
( 2192)                                          chunks(chunk)%field%x_max,                    &
( 2193)                                          chunks(chunk)%field%y_min,                    &
( 2194)                                          chunks(chunk)%field%y_max,                    &
( 2195)                                          chunks(chunk)%field%yvel0,                    &
( 2196)                                          chunks(chunk)%right_rcv_buffer,               &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 39

( 2197)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2198)                                          depth, VERTEX_DATA,                           &
( 2199)                                          left_right_offset(FIELD_YVEL0))
( 2200)     ENDIF
( 2201)   ENDIF
( 2202)   IF(fields(FIELD_YVEL1).EQ.1) THEN
( 2203)     IF(use_fortran_kernels) THEN
( 2204)       CALL clover_unpack_message_right(chunks(chunk)%field%x_min,                    &
( 2205)                                        chunks(chunk)%field%x_max,                    &
( 2206)                                        chunks(chunk)%field%y_min,                    &
( 2207)                                        chunks(chunk)%field%y_max,                    &
( 2208)                                        chunks(chunk)%field%z_min,                    &
( 2209)                                        chunks(chunk)%field%z_max,                    &
( 2210)                                        chunks(chunk)%field%yvel1,                    &
( 2211)                                        chunks(chunk)%right_rcv_buffer,               &
( 2212)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2213)                                        depth, VERTEX_DATA,                           &
( 2214)                                        left_right_offset(FIELD_YVEL1))
( 2215)     ELSE
( 2216)       CALL clover_unpack_message_right_c(chunks(chunk)%field%x_min,                    &
( 2217)                                          chunks(chunk)%field%x_max,                    &
( 2218)                                          chunks(chunk)%field%y_min,                    &
( 2219)                                          chunks(chunk)%field%y_max,                    &
( 2220)                                          chunks(chunk)%field%yvel1,                    &
( 2221)                                          chunks(chunk)%right_rcv_buffer,               &
( 2222)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2223)                                          depth, VERTEX_DATA,                           &
( 2224)                                          left_right_offset(FIELD_YVEL1))
( 2225)     ENDIF
( 2226)   ENDIF
( 2227)   IF(fields(FIELD_ZVEL0).EQ.1) THEN
( 2228)     IF(use_fortran_kernels) THEN
( 2229)       CALL clover_unpack_message_right(chunks(chunk)%field%x_min,                    &
( 2230)                                        chunks(chunk)%field%x_max,                    &
( 2231)                                        chunks(chunk)%field%y_min,                    &
( 2232)                                        chunks(chunk)%field%y_max,                    &
( 2233)                                        chunks(chunk)%field%z_min,                    &
( 2234)                                        chunks(chunk)%field%z_max,                    &
( 2235)                                        chunks(chunk)%field%zvel0,                    &
( 2236)                                        chunks(chunk)%right_rcv_buffer,               &
( 2237)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2238)                                        depth, VERTEX_DATA,                           &
( 2239)                                        left_right_offset(FIELD_ZVEL0))
( 2240)     ELSE
( 2241)       CALL clover_unpack_message_right_c(chunks(chunk)%field%x_min,                    &
( 2242)                                          chunks(chunk)%field%x_max,                    &
( 2243)                                          chunks(chunk)%field%y_min,                    &
( 2244)                                          chunks(chunk)%field%y_max,                    &
( 2245)                                          chunks(chunk)%field%zvel0,                    &
( 2246)                                          chunks(chunk)%right_rcv_buffer,               &
( 2247)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2248)                                          depth, VERTEX_DATA,                           &
( 2249)                                          left_right_offset(FIELD_ZVEL0))
( 2250)     ENDIF
( 2251)   ENDIF
( 2252)   IF(fields(FIELD_ZVEL1).EQ.1) THEN
( 2253)     IF(use_fortran_kernels) THEN
( 2254)       CALL clover_unpack_message_right(chunks(chunk)%field%x_min,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 40

( 2255)                                        chunks(chunk)%field%x_max,                    &
( 2256)                                        chunks(chunk)%field%y_min,                    &
( 2257)                                        chunks(chunk)%field%y_max,                    &
( 2258)                                        chunks(chunk)%field%z_min,                    &
( 2259)                                        chunks(chunk)%field%z_max,                    &
( 2260)                                        chunks(chunk)%field%zvel1,                    &
( 2261)                                        chunks(chunk)%right_rcv_buffer,               &
( 2262)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2263)                                        depth, VERTEX_DATA,                           &
( 2264)                                        left_right_offset(FIELD_ZVEL1))
( 2265)     ELSE
( 2266)       CALL clover_unpack_message_right_c(chunks(chunk)%field%x_min,                    &
( 2267)                                          chunks(chunk)%field%x_max,                    &
( 2268)                                          chunks(chunk)%field%y_min,                    &
( 2269)                                          chunks(chunk)%field%y_max,                    &
( 2270)                                          chunks(chunk)%field%zvel1,                    &
( 2271)                                          chunks(chunk)%right_rcv_buffer,               &
( 2272)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2273)                                          depth, VERTEX_DATA,                           &
( 2274)                                          left_right_offset(FIELD_ZVEL1))
( 2275)     ENDIF
( 2276)   ENDIF
( 2277)   IF(fields(FIELD_VOL_FLUX_X).EQ.1) THEN
( 2278)     IF(use_fortran_kernels) THEN
( 2279)       CALL clover_unpack_message_right(chunks(chunk)%field%x_min,                    &
( 2280)                                        chunks(chunk)%field%x_max,                    &
( 2281)                                        chunks(chunk)%field%y_min,                    &
( 2282)                                        chunks(chunk)%field%y_max,                    &
( 2283)                                        chunks(chunk)%field%z_min,                    &
( 2284)                                        chunks(chunk)%field%z_max,                    &
( 2285)                                        chunks(chunk)%field%vol_flux_x,               &
( 2286)                                        chunks(chunk)%right_rcv_buffer,               &
( 2287)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2288)                                        depth, X_FACE_DATA,                           &
( 2289)                                        left_right_offset(FIELD_VOL_FLUX_X))
( 2290)     ELSE
( 2291)       CALL clover_unpack_message_right_c(chunks(chunk)%field%x_min,                    &
( 2292)                                          chunks(chunk)%field%x_max,                    &
( 2293)                                          chunks(chunk)%field%y_min,                    &
( 2294)                                          chunks(chunk)%field%y_max,                    &
( 2295)                                          chunks(chunk)%field%vol_flux_x,               &
( 2296)                                          chunks(chunk)%right_rcv_buffer,               &
( 2297)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2298)                                          depth, X_FACE_DATA,                           &
( 2299)                                          left_right_offset(FIELD_VOL_FLUX_X))
( 2300)     ENDIF
( 2301)   ENDIF
( 2302)   IF(fields(FIELD_VOL_FLUX_Y).EQ.1) THEN
( 2303)     IF(use_fortran_kernels) THEN
( 2304)       CALL clover_unpack_message_right(chunks(chunk)%field%x_min,                    &
( 2305)                                        chunks(chunk)%field%x_max,                    &
( 2306)                                        chunks(chunk)%field%y_min,                    &
( 2307)                                        chunks(chunk)%field%y_max,                    &
( 2308)                                        chunks(chunk)%field%z_min,                    &
( 2309)                                        chunks(chunk)%field%z_max,                    &
( 2310)                                        chunks(chunk)%field%vol_flux_y,               &
( 2311)                                        chunks(chunk)%right_rcv_buffer,               &
( 2312)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 41

( 2313)                                        depth, Y_FACE_DATA,                           &
( 2314)                                        left_right_offset(FIELD_VOL_FLUX_Y))
( 2315)     ELSE
( 2316)       CALL clover_unpack_message_right_c(chunks(chunk)%field%x_min,                    &
( 2317)                                          chunks(chunk)%field%x_max,                    &
( 2318)                                          chunks(chunk)%field%y_min,                    &
( 2319)                                          chunks(chunk)%field%y_max,                    &
( 2320)                                          chunks(chunk)%field%vol_flux_y,               &
( 2321)                                          chunks(chunk)%right_rcv_buffer,               &
( 2322)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2323)                                          depth, Y_FACE_DATA,                           &
( 2324)                                          left_right_offset(FIELD_VOL_FLUX_Y))
( 2325)     ENDIF
( 2326)   ENDIF
( 2327)   IF(fields(FIELD_VOL_FLUX_Z).EQ.1) THEN
( 2328)     IF(use_fortran_kernels) THEN
( 2329)       CALL clover_unpack_message_right(chunks(chunk)%field%x_min,                    &
( 2330)                                        chunks(chunk)%field%x_max,                    &
( 2331)                                        chunks(chunk)%field%y_min,                    &
( 2332)                                        chunks(chunk)%field%y_max,                    &
( 2333)                                        chunks(chunk)%field%z_min,                    &
( 2334)                                        chunks(chunk)%field%z_max,                    &
( 2335)                                        chunks(chunk)%field%vol_flux_z,               &
( 2336)                                        chunks(chunk)%right_rcv_buffer,               &
( 2337)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2338)                                        depth, Z_FACE_DATA,                           &
( 2339)                                        left_right_offset(FIELD_VOL_FLUX_Z))
( 2340)     ELSE
( 2341)       CALL clover_unpack_message_right_c(chunks(chunk)%field%x_min,                    &
( 2342)                                          chunks(chunk)%field%x_max,                    &
( 2343)                                          chunks(chunk)%field%y_min,                    &
( 2344)                                          chunks(chunk)%field%y_max,                    &
( 2345)                                          chunks(chunk)%field%vol_flux_z,               &
( 2346)                                          chunks(chunk)%right_rcv_buffer,               &
( 2347)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2348)                                          depth, Z_FACE_DATA,                           &
( 2349)                                          left_right_offset(FIELD_VOL_FLUX_Z))
( 2350)     ENDIF
( 2351)   ENDIF
( 2352)   IF(fields(FIELD_MASS_FLUX_X).EQ.1) THEN
( 2353)     IF(use_fortran_kernels) THEN
( 2354)       CALL clover_unpack_message_right(chunks(chunk)%field%x_min,                    &
( 2355)                                        chunks(chunk)%field%x_max,                    &
( 2356)                                        chunks(chunk)%field%y_min,                    &
( 2357)                                        chunks(chunk)%field%y_max,                    &
( 2358)                                        chunks(chunk)%field%z_min,                    &
( 2359)                                        chunks(chunk)%field%z_max,                    &
( 2360)                                        chunks(chunk)%field%mass_flux_x,              &
( 2361)                                        chunks(chunk)%right_rcv_buffer,               &
( 2362)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2363)                                        depth, X_FACE_DATA,                           &
( 2364)                                        left_right_offset(FIELD_MASS_FLUX_X))
( 2365)     ELSE
( 2366)       CALL clover_unpack_message_right_c(chunks(chunk)%field%x_min,                    &
( 2367)                                          chunks(chunk)%field%x_max,                    &
( 2368)                                          chunks(chunk)%field%y_min,                    &
( 2369)                                          chunks(chunk)%field%y_max,                    &
( 2370)                                          chunks(chunk)%field%mass_flux_x,              &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 42

( 2371)                                          chunks(chunk)%right_rcv_buffer,               &
( 2372)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2373)                                          depth, X_FACE_DATA,                           &
( 2374)                                          left_right_offset(FIELD_MASS_FLUX_X))
( 2375)     ENDIF
( 2376)   ENDIF
( 2377)   IF(fields(FIELD_MASS_FLUX_Y).EQ.1) THEN
( 2378)     IF(use_fortran_kernels) THEN
( 2379)       CALL clover_unpack_message_right(chunks(chunk)%field%x_min,                    &
( 2380)                                        chunks(chunk)%field%x_max,                    &
( 2381)                                        chunks(chunk)%field%y_min,                    &
( 2382)                                        chunks(chunk)%field%y_max,                    &
( 2383)                                        chunks(chunk)%field%z_min,                    &
( 2384)                                        chunks(chunk)%field%z_max,                    &
( 2385)                                        chunks(chunk)%field%mass_flux_y,              &
( 2386)                                        chunks(chunk)%right_rcv_buffer,               &
( 2387)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2388)                                        depth, Y_FACE_DATA,                           &
( 2389)                                        left_right_offset(FIELD_MASS_FLUX_Y))
( 2390)     ELSE
( 2391)       CALL clover_unpack_message_right_c(chunks(chunk)%field%x_min,                    &
( 2392)                                          chunks(chunk)%field%x_max,                    &
( 2393)                                          chunks(chunk)%field%y_min,                    &
( 2394)                                          chunks(chunk)%field%y_max,                    &
( 2395)                                          chunks(chunk)%field%mass_flux_y,              &
( 2396)                                          chunks(chunk)%right_rcv_buffer,               &
( 2397)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2398)                                          depth, Y_FACE_DATA,                           &
( 2399)                                          left_right_offset(FIELD_MASS_FLUX_Y))
( 2400)     ENDIF
( 2401)   ENDIF
( 2402)   IF(fields(FIELD_MASS_FLUX_Z).EQ.1) THEN
( 2403)     IF(use_fortran_kernels) THEN
( 2404)       CALL clover_unpack_message_right(chunks(chunk)%field%x_min,                    &
( 2405)                                        chunks(chunk)%field%x_max,                    &
( 2406)                                        chunks(chunk)%field%y_min,                    &
( 2407)                                        chunks(chunk)%field%y_max,                    &
( 2408)                                        chunks(chunk)%field%z_min,                    &
( 2409)                                        chunks(chunk)%field%z_max,                    &
( 2410)                                        chunks(chunk)%field%mass_flux_z,              &
( 2411)                                        chunks(chunk)%right_rcv_buffer,               &
( 2412)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2413)                                        depth, Z_FACE_DATA,                           &
( 2414)                                        left_right_offset(FIELD_MASS_FLUX_Z))
( 2415)     ELSE
( 2416)       CALL clover_unpack_message_right_c(chunks(chunk)%field%x_min,                    &
( 2417)                                          chunks(chunk)%field%x_max,                    &
( 2418)                                          chunks(chunk)%field%y_min,                    &
( 2419)                                          chunks(chunk)%field%y_max,                    &
( 2420)                                          chunks(chunk)%field%mass_flux_z,              &
( 2421)                                          chunks(chunk)%right_rcv_buffer,               &
( 2422)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2423)                                          depth, Z_FACE_DATA,                           &
( 2424)                                          left_right_offset(FIELD_MASS_FLUX_Z))
( 2425)     ENDIF
( 2426)   ENDIF
( 2427) END SUBROUTINE clover_unpack_right
( 2428) 






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 43

( 2429) SUBROUTINE clover_pack_top(chunk, fields, depth, bottom_top_offset)
( 2430) 
( 2431)   USE pack_kernel_module
( 2432) 
( 2433)   IMPLICIT NONE
( 2434) 
( 2435)   INTEGER        :: chunk, fields(:), depth, bottom_top_offset(:)
( 2436) 
( 2437)   IF(fields(FIELD_DENSITY0).EQ.1) THEN
( 2438)     IF(use_fortran_kernels) THEN
( 2439)       CALL clover_pack_message_top(chunks(chunk)%field%x_min,                    &
( 2440)                                    chunks(chunk)%field%x_max,                    &
( 2441)                                    chunks(chunk)%field%y_min,                    &
( 2442)                                    chunks(chunk)%field%y_max,                    &
( 2443)                                    chunks(chunk)%field%z_min,                    &
( 2444)                                    chunks(chunk)%field%z_max,                    &
( 2445)                                    chunks(chunk)%field%density0,                 &
( 2446)                                    chunks(chunk)%top_snd_buffer,                 &
( 2447)                                    CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2448)                                    depth, CELL_DATA,                             &
( 2449)                                    bottom_top_offset(FIELD_DENSITY0))
( 2450)     ELSE
( 2451)       CALL clover_pack_message_top_c(chunks(chunk)%field%x_min,                    &
( 2452)                                      chunks(chunk)%field%x_max,                    &
( 2453)                                      chunks(chunk)%field%y_min,                    &
( 2454)                                      chunks(chunk)%field%y_max,                    &
( 2455)                                      chunks(chunk)%field%density0,                 &
( 2456)                                      chunks(chunk)%top_snd_buffer,                 &
( 2457)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2458)                                      depth, CELL_DATA,                             &
( 2459)                                      bottom_top_offset(FIELD_DENSITY0))
( 2460)     ENDIF
( 2461)   ENDIF
( 2462)   IF(fields(FIELD_DENSITY1).EQ.1) THEN
( 2463)     IF(use_fortran_kernels) THEN
( 2464)       CALL clover_pack_message_top(chunks(chunk)%field%x_min,                    &
( 2465)                                    chunks(chunk)%field%x_max,                    &
( 2466)                                    chunks(chunk)%field%y_min,                    &
( 2467)                                    chunks(chunk)%field%y_max,                    &
( 2468)                                    chunks(chunk)%field%z_min,                    &
( 2469)                                    chunks(chunk)%field%z_max,                    &
( 2470)                                    chunks(chunk)%field%density1,                 &
( 2471)                                    chunks(chunk)%top_snd_buffer,                 &
( 2472)                                    CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2473)                                    depth, CELL_DATA,                             &
( 2474)                                    bottom_top_offset(FIELD_DENSITY1))
( 2475)     ELSE
( 2476)       CALL clover_pack_message_top_c(chunks(chunk)%field%x_min,                    &
( 2477)                                      chunks(chunk)%field%x_max,                    &
( 2478)                                      chunks(chunk)%field%y_min,                    &
( 2479)                                      chunks(chunk)%field%y_max,                    &
( 2480)                                      chunks(chunk)%field%density1,                 &
( 2481)                                      chunks(chunk)%top_snd_buffer,                 &
( 2482)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2483)                                      depth, CELL_DATA,                             &
( 2484)                                      bottom_top_offset(FIELD_DENSITY1))
( 2485)     ENDIF
( 2486)   ENDIF






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 44

( 2487)   IF(fields(FIELD_ENERGY0).EQ.1) THEN
( 2488)     IF(use_fortran_kernels) THEN
( 2489)       CALL clover_pack_message_top(chunks(chunk)%field%x_min,                    &
( 2490)                                    chunks(chunk)%field%x_max,                    &
( 2491)                                    chunks(chunk)%field%y_min,                    &
( 2492)                                    chunks(chunk)%field%y_max,                    &
( 2493)                                    chunks(chunk)%field%z_min,                    &
( 2494)                                    chunks(chunk)%field%z_max,                    &
( 2495)                                    chunks(chunk)%field%energy0,                  &
( 2496)                                    chunks(chunk)%top_snd_buffer,                 &
( 2497)                                    CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2498)                                    depth, CELL_DATA,                             &
( 2499)                                    bottom_top_offset(FIELD_ENERGY0))
( 2500)     ELSE
( 2501)       CALL clover_pack_message_top_c(chunks(chunk)%field%x_min,                    &
( 2502)                                      chunks(chunk)%field%x_max,                    &
( 2503)                                      chunks(chunk)%field%y_min,                    &
( 2504)                                      chunks(chunk)%field%y_max,                    &
( 2505)                                      chunks(chunk)%field%energy0,                  &
( 2506)                                      chunks(chunk)%top_snd_buffer,                 &
( 2507)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2508)                                      depth, CELL_DATA,                             &
( 2509)                                      bottom_top_offset(FIELD_ENERGY0))
( 2510)     ENDIF
( 2511)   ENDIF
( 2512)   IF(fields(FIELD_ENERGY1).EQ.1) THEN
( 2513)     IF(use_fortran_kernels) THEN
( 2514)       CALL clover_pack_message_top(chunks(chunk)%field%x_min,                    &
( 2515)                                    chunks(chunk)%field%x_max,                    &
( 2516)                                    chunks(chunk)%field%y_min,                    &
( 2517)                                    chunks(chunk)%field%y_max,                    &
( 2518)                                    chunks(chunk)%field%z_min,                    &
( 2519)                                    chunks(chunk)%field%z_max,                    &
( 2520)                                    chunks(chunk)%field%energy1,                  &
( 2521)                                    chunks(chunk)%top_snd_buffer,                 &
( 2522)                                    CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2523)                                    depth, CELL_DATA,                             &
( 2524)                                    bottom_top_offset(FIELD_ENERGY1))
( 2525)     ELSE
( 2526)       CALL clover_pack_message_top_c(chunks(chunk)%field%x_min,                    &
( 2527)                                      chunks(chunk)%field%x_max,                    &
( 2528)                                      chunks(chunk)%field%y_min,                    &
( 2529)                                      chunks(chunk)%field%y_max,                    &
( 2530)                                      chunks(chunk)%field%energy1,                  &
( 2531)                                      chunks(chunk)%top_snd_buffer,                 &
( 2532)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2533)                                      depth, CELL_DATA,                             &
( 2534)                                      bottom_top_offset(FIELD_ENERGY1))
( 2535)     ENDIF
( 2536)   ENDIF
( 2537)   IF(fields(FIELD_PRESSURE).EQ.1) THEN
( 2538)     IF(use_fortran_kernels) THEN
( 2539)       CALL clover_pack_message_top(chunks(chunk)%field%x_min,                    &
( 2540)                                    chunks(chunk)%field%x_max,                    &
( 2541)                                    chunks(chunk)%field%y_min,                    &
( 2542)                                    chunks(chunk)%field%y_max,                    &
( 2543)                                    chunks(chunk)%field%z_min,                    &
( 2544)                                    chunks(chunk)%field%z_max,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 45

( 2545)                                    chunks(chunk)%field%pressure,                 &
( 2546)                                    chunks(chunk)%top_snd_buffer,                 &
( 2547)                                    CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2548)                                    depth, CELL_DATA,                             &
( 2549)                                    bottom_top_offset(FIELD_PRESSURE))
( 2550)     ELSE
( 2551)       CALL clover_pack_message_top_c(chunks(chunk)%field%x_min,                    &
( 2552)                                      chunks(chunk)%field%x_max,                    &
( 2553)                                      chunks(chunk)%field%y_min,                    &
( 2554)                                      chunks(chunk)%field%y_max,                    &
( 2555)                                      chunks(chunk)%field%pressure,                 &
( 2556)                                      chunks(chunk)%top_snd_buffer,                 &
( 2557)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2558)                                      depth, CELL_DATA,                             &
( 2559)                                      bottom_top_offset(FIELD_PRESSURE))
( 2560)     ENDIF
( 2561)   ENDIF
( 2562)   IF(fields(FIELD_VISCOSITY).EQ.1) THEN
( 2563)     IF(use_fortran_kernels) THEN
( 2564)       CALL clover_pack_message_top(chunks(chunk)%field%x_min,                    &
( 2565)                                    chunks(chunk)%field%x_max,                    &
( 2566)                                    chunks(chunk)%field%y_min,                    &
( 2567)                                    chunks(chunk)%field%y_max,                    &
( 2568)                                    chunks(chunk)%field%z_min,                    &
( 2569)                                    chunks(chunk)%field%z_max,                    &
( 2570)                                    chunks(chunk)%field%viscosity,                &
( 2571)                                    chunks(chunk)%top_snd_buffer,                 &
( 2572)                                    CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2573)                                    depth, CELL_DATA,                             &
( 2574)                                    bottom_top_offset(FIELD_VISCOSITY))
( 2575)     ELSE
( 2576)       CALL clover_pack_message_top_c(chunks(chunk)%field%x_min,                    &
( 2577)                                      chunks(chunk)%field%x_max,                    &
( 2578)                                      chunks(chunk)%field%y_min,                    &
( 2579)                                      chunks(chunk)%field%y_max,                    &
( 2580)                                      chunks(chunk)%field%viscosity,                &
( 2581)                                      chunks(chunk)%top_snd_buffer,                 &
( 2582)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2583)                                      depth, CELL_DATA,                             &
( 2584)                                      bottom_top_offset(FIELD_VISCOSITY))
( 2585)     ENDIF
( 2586)   ENDIF
( 2587)   IF(fields(FIELD_SOUNDSPEED).EQ.1) THEN
( 2588)     IF(use_fortran_kernels) THEN
( 2589)       CALL clover_pack_message_top(chunks(chunk)%field%x_min,                    &
( 2590)                                    chunks(chunk)%field%x_max,                    &
( 2591)                                    chunks(chunk)%field%y_min,                    &
( 2592)                                    chunks(chunk)%field%y_max,                    &
( 2593)                                    chunks(chunk)%field%z_min,                    &
( 2594)                                    chunks(chunk)%field%z_max,                    &
( 2595)                                    chunks(chunk)%field%soundspeed,               &
( 2596)                                    chunks(chunk)%top_snd_buffer,                 &
( 2597)                                    CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2598)                                    depth, CELL_DATA,                             &
( 2599)                                    bottom_top_offset(FIELD_SOUNDSPEED))
( 2600)     ELSE
( 2601)       CALL clover_pack_message_top_c(chunks(chunk)%field%x_min,                    &
( 2602)                                      chunks(chunk)%field%x_max,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 46

( 2603)                                      chunks(chunk)%field%y_min,                    &
( 2604)                                      chunks(chunk)%field%y_max,                    &
( 2605)                                      chunks(chunk)%field%soundspeed,               &
( 2606)                                      chunks(chunk)%top_snd_buffer,                 &
( 2607)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2608)                                      depth, CELL_DATA,                             &
( 2609)                                      bottom_top_offset(FIELD_SOUNDSPEED))
( 2610)     ENDIF
( 2611)   ENDIF
( 2612)   IF(fields(FIELD_XVEL0).EQ.1) THEN
( 2613)     IF(use_fortran_kernels) THEN
( 2614)       CALL clover_pack_message_top(chunks(chunk)%field%x_min,                    &
( 2615)                                    chunks(chunk)%field%x_max,                    &
( 2616)                                    chunks(chunk)%field%y_min,                    &
( 2617)                                    chunks(chunk)%field%y_max,                    &
( 2618)                                    chunks(chunk)%field%z_min,                    &
( 2619)                                    chunks(chunk)%field%z_max,                    &
( 2620)                                    chunks(chunk)%field%xvel0,                    &
( 2621)                                    chunks(chunk)%top_snd_buffer,                 &
( 2622)                                    CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2623)                                    depth, VERTEX_DATA,                           &
( 2624)                                    bottom_top_offset(FIELD_XVEL0))
( 2625)     ELSE
( 2626)       CALL clover_pack_message_top_c(chunks(chunk)%field%x_min,                    &
( 2627)                                      chunks(chunk)%field%x_max,                    &
( 2628)                                      chunks(chunk)%field%y_min,                    &
( 2629)                                      chunks(chunk)%field%y_max,                    &
( 2630)                                      chunks(chunk)%field%xvel0,                    &
( 2631)                                      chunks(chunk)%top_snd_buffer,                 &
( 2632)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2633)                                      depth, VERTEX_DATA,                           &
( 2634)                                      bottom_top_offset(FIELD_XVEL0))
( 2635)     ENDIF
( 2636)   ENDIF
( 2637)   IF(fields(FIELD_XVEL1).EQ.1) THEN
( 2638)     IF(use_fortran_kernels) THEN
( 2639)       CALL clover_pack_message_top(chunks(chunk)%field%x_min,                    &
( 2640)                                    chunks(chunk)%field%x_max,                    &
( 2641)                                    chunks(chunk)%field%y_min,                    &
( 2642)                                    chunks(chunk)%field%y_max,                    &
( 2643)                                    chunks(chunk)%field%z_min,                    &
( 2644)                                    chunks(chunk)%field%z_max,                    &
( 2645)                                    chunks(chunk)%field%xvel1,                    &
( 2646)                                    chunks(chunk)%top_snd_buffer,                 &
( 2647)                                    CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2648)                                    depth, VERTEX_DATA,                           &
( 2649)                                    bottom_top_offset(FIELD_XVEL1))
( 2650)     ELSE
( 2651)       CALL clover_pack_message_top_c(chunks(chunk)%field%x_min,                    &
( 2652)                                      chunks(chunk)%field%x_max,                    &
( 2653)                                      chunks(chunk)%field%y_min,                    &
( 2654)                                      chunks(chunk)%field%y_max,                    &
( 2655)                                      chunks(chunk)%field%xvel1,                    &
( 2656)                                      chunks(chunk)%top_snd_buffer,                 &
( 2657)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2658)                                      depth, VERTEX_DATA,                           &
( 2659)                                      bottom_top_offset(FIELD_XVEL1))
( 2660)     ENDIF






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 47

( 2661)   ENDIF
( 2662)   IF(fields(FIELD_YVEL0).EQ.1) THEN
( 2663)     IF(use_fortran_kernels) THEN
( 2664)       CALL clover_pack_message_top(chunks(chunk)%field%x_min,                    &
( 2665)                                    chunks(chunk)%field%x_max,                    &
( 2666)                                    chunks(chunk)%field%y_min,                    &
( 2667)                                    chunks(chunk)%field%y_max,                    &
( 2668)                                    chunks(chunk)%field%z_min,                    &
( 2669)                                    chunks(chunk)%field%z_max,                    &
( 2670)                                    chunks(chunk)%field%yvel0,                    &
( 2671)                                    chunks(chunk)%top_snd_buffer,                 &
( 2672)                                    CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2673)                                    depth, VERTEX_DATA,                           &
( 2674)                                    bottom_top_offset(FIELD_YVEL0))
( 2675)     ELSE
( 2676)       CALL clover_pack_message_top_c(chunks(chunk)%field%x_min,                    &
( 2677)                                      chunks(chunk)%field%x_max,                    &
( 2678)                                      chunks(chunk)%field%y_min,                    &
( 2679)                                      chunks(chunk)%field%y_max,                    &
( 2680)                                      chunks(chunk)%field%yvel0,                    &
( 2681)                                      chunks(chunk)%top_snd_buffer,                 &
( 2682)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2683)                                      depth, VERTEX_DATA,                           &
( 2684)                                      bottom_top_offset(FIELD_YVEL0))
( 2685)     ENDIF
( 2686)   ENDIF
( 2687)   IF(fields(FIELD_YVEL1).EQ.1) THEN
( 2688)     IF(use_fortran_kernels) THEN
( 2689)       CALL clover_pack_message_top(chunks(chunk)%field%x_min,                    &
( 2690)                                    chunks(chunk)%field%x_max,                    &
( 2691)                                    chunks(chunk)%field%y_min,                    &
( 2692)                                    chunks(chunk)%field%y_max,                    &
( 2693)                                    chunks(chunk)%field%z_min,                    &
( 2694)                                    chunks(chunk)%field%z_max,                    &
( 2695)                                    chunks(chunk)%field%yvel1,                    &
( 2696)                                    chunks(chunk)%top_snd_buffer,                 &
( 2697)                                    CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2698)                                    depth, VERTEX_DATA,                           &
( 2699)                                    bottom_top_offset(FIELD_YVEL1))
( 2700)     ELSE
( 2701)       CALL clover_pack_message_top_c(chunks(chunk)%field%x_min,                    &
( 2702)                                      chunks(chunk)%field%x_max,                    &
( 2703)                                      chunks(chunk)%field%y_min,                    &
( 2704)                                      chunks(chunk)%field%y_max,                    &
( 2705)                                      chunks(chunk)%field%yvel1,                    &
( 2706)                                      chunks(chunk)%top_snd_buffer,                 &
( 2707)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2708)                                      depth, VERTEX_DATA,                           &
( 2709)                                      bottom_top_offset(FIELD_YVEL1))
( 2710)     ENDIF
( 2711)   ENDIF
( 2712)   IF(fields(FIELD_ZVEL0).EQ.1) THEN
( 2713)     IF(use_fortran_kernels) THEN
( 2714)       CALL clover_pack_message_top(chunks(chunk)%field%x_min,                    &
( 2715)                                    chunks(chunk)%field%x_max,                    &
( 2716)                                    chunks(chunk)%field%y_min,                    &
( 2717)                                    chunks(chunk)%field%y_max,                    &
( 2718)                                    chunks(chunk)%field%z_min,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 48

( 2719)                                    chunks(chunk)%field%z_max,                    &
( 2720)                                    chunks(chunk)%field%zvel0,                    &
( 2721)                                    chunks(chunk)%top_snd_buffer,                 &
( 2722)                                    CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2723)                                    depth, VERTEX_DATA,                           &
( 2724)                                    bottom_top_offset(FIELD_ZVEL0))
( 2725)     ELSE
( 2726)       CALL clover_pack_message_top_c(chunks(chunk)%field%x_min,                    &
( 2727)                                      chunks(chunk)%field%x_max,                    &
( 2728)                                      chunks(chunk)%field%y_min,                    &
( 2729)                                      chunks(chunk)%field%y_max,                    &
( 2730)                                      chunks(chunk)%field%zvel0,                    &
( 2731)                                      chunks(chunk)%top_snd_buffer,                 &
( 2732)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2733)                                      depth, VERTEX_DATA,                           &
( 2734)                                      bottom_top_offset(FIELD_ZVEL0))
( 2735)     ENDIF
( 2736)   ENDIF
( 2737)   IF(fields(FIELD_ZVEL1).EQ.1) THEN
( 2738)     IF(use_fortran_kernels) THEN
( 2739)       CALL clover_pack_message_top(chunks(chunk)%field%x_min,                    &
( 2740)                                    chunks(chunk)%field%x_max,                    &
( 2741)                                    chunks(chunk)%field%y_min,                    &
( 2742)                                    chunks(chunk)%field%y_max,                    &
( 2743)                                    chunks(chunk)%field%z_min,                    &
( 2744)                                    chunks(chunk)%field%z_max,                    &
( 2745)                                    chunks(chunk)%field%zvel1,                    &
( 2746)                                    chunks(chunk)%top_snd_buffer,                 &
( 2747)                                    CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2748)                                    depth, VERTEX_DATA,                           &
( 2749)                                    bottom_top_offset(FIELD_ZVEL1))
( 2750)     ELSE
( 2751)       CALL clover_pack_message_top_c(chunks(chunk)%field%x_min,                    &
( 2752)                                      chunks(chunk)%field%x_max,                    &
( 2753)                                      chunks(chunk)%field%y_min,                    &
( 2754)                                      chunks(chunk)%field%y_max,                    &
( 2755)                                      chunks(chunk)%field%zvel1,                    &
( 2756)                                      chunks(chunk)%top_snd_buffer,                 &
( 2757)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2758)                                      depth, VERTEX_DATA,                           &
( 2759)                                      bottom_top_offset(FIELD_ZVEL1))
( 2760)     ENDIF
( 2761)   ENDIF
( 2762)   IF(fields(FIELD_VOL_FLUX_X).EQ.1) THEN
( 2763)     IF(use_fortran_kernels) THEN
( 2764)       CALL clover_pack_message_top(chunks(chunk)%field%x_min,                    &
( 2765)                                    chunks(chunk)%field%x_max,                    &
( 2766)                                    chunks(chunk)%field%y_min,                    &
( 2767)                                    chunks(chunk)%field%y_max,                    &
( 2768)                                    chunks(chunk)%field%z_min,                    &
( 2769)                                    chunks(chunk)%field%z_max,                    &
( 2770)                                    chunks(chunk)%field%vol_flux_x,               &
( 2771)                                    chunks(chunk)%top_snd_buffer,                 &
( 2772)                                    CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2773)                                    depth, X_FACE_DATA,                           &
( 2774)                                    bottom_top_offset(FIELD_VOL_FLUX_X))
( 2775)     ELSE
( 2776)       CALL clover_pack_message_top_c(chunks(chunk)%field%x_min,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 49

( 2777)                                      chunks(chunk)%field%x_max,                    &
( 2778)                                      chunks(chunk)%field%y_min,                    &
( 2779)                                      chunks(chunk)%field%y_max,                    &
( 2780)                                      chunks(chunk)%field%vol_flux_x,               &
( 2781)                                      chunks(chunk)%top_snd_buffer,                 &
( 2782)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2783)                                      depth, X_FACE_DATA,                           &
( 2784)                                      bottom_top_offset(FIELD_VOL_FLUX_X))
( 2785)     ENDIF
( 2786)   ENDIF
( 2787)   IF(fields(FIELD_VOL_FLUX_Y).EQ.1) THEN
( 2788)     IF(use_fortran_kernels) THEN
( 2789)       CALL clover_pack_message_top(chunks(chunk)%field%x_min,                    &
( 2790)                                    chunks(chunk)%field%x_max,                    &
( 2791)                                    chunks(chunk)%field%y_min,                    &
( 2792)                                    chunks(chunk)%field%y_max,                    &
( 2793)                                    chunks(chunk)%field%z_min,                    &
( 2794)                                    chunks(chunk)%field%z_max,                    &
( 2795)                                    chunks(chunk)%field%vol_flux_y,               &
( 2796)                                    chunks(chunk)%top_snd_buffer,                 &
( 2797)                                    CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2798)                                    depth, Y_FACE_DATA,                           &
( 2799)                                    bottom_top_offset(FIELD_VOL_FLUX_Y))
( 2800)     ELSE
( 2801)       CALL clover_pack_message_top_c(chunks(chunk)%field%x_min,                    &
( 2802)                                      chunks(chunk)%field%x_max,                    &
( 2803)                                      chunks(chunk)%field%y_min,                    &
( 2804)                                      chunks(chunk)%field%y_max,                    &
( 2805)                                      chunks(chunk)%field%vol_flux_y,               &
( 2806)                                      chunks(chunk)%top_snd_buffer,                 &
( 2807)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2808)                                      depth, Y_FACE_DATA,                           &
( 2809)                                      bottom_top_offset(FIELD_VOL_FLUX_Y))
( 2810)     ENDIF
( 2811)   ENDIF
( 2812)   IF(fields(FIELD_VOL_FLUX_Z).EQ.1) THEN
( 2813)     IF(use_fortran_kernels) THEN
( 2814)       CALL clover_pack_message_top(chunks(chunk)%field%x_min,                    &
( 2815)                                    chunks(chunk)%field%x_max,                    &
( 2816)                                    chunks(chunk)%field%y_min,                    &
( 2817)                                    chunks(chunk)%field%y_max,                    &
( 2818)                                    chunks(chunk)%field%z_min,                    &
( 2819)                                    chunks(chunk)%field%z_max,                    &
( 2820)                                    chunks(chunk)%field%vol_flux_z,               &
( 2821)                                    chunks(chunk)%top_snd_buffer,                 &
( 2822)                                    CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2823)                                    depth, Z_FACE_DATA,                           &
( 2824)                                    bottom_top_offset(FIELD_VOL_FLUX_Z))
( 2825)     ELSE
( 2826)       CALL clover_pack_message_top_c(chunks(chunk)%field%x_min,                    &
( 2827)                                      chunks(chunk)%field%x_max,                    &
( 2828)                                      chunks(chunk)%field%y_min,                    &
( 2829)                                      chunks(chunk)%field%y_max,                    &
( 2830)                                      chunks(chunk)%field%vol_flux_z,               &
( 2831)                                      chunks(chunk)%top_snd_buffer,                 &
( 2832)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2833)                                      depth, Z_FACE_DATA,                           &
( 2834)                                      bottom_top_offset(FIELD_VOL_FLUX_Z))






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 50

( 2835)     ENDIF
( 2836)   ENDIF
( 2837)   IF(fields(FIELD_MASS_FLUX_X).EQ.1) THEN
( 2838)     IF(use_fortran_kernels) THEN
( 2839)       CALL clover_pack_message_top(chunks(chunk)%field%x_min,                    &
( 2840)                                    chunks(chunk)%field%x_max,                    &
( 2841)                                    chunks(chunk)%field%y_min,                    &
( 2842)                                    chunks(chunk)%field%y_max,                    &
( 2843)                                    chunks(chunk)%field%z_min,                    &
( 2844)                                    chunks(chunk)%field%z_max,                    &
( 2845)                                    chunks(chunk)%field%mass_flux_x,              &
( 2846)                                    chunks(chunk)%top_snd_buffer,                 &
( 2847)                                    CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2848)                                    depth, X_FACE_DATA,                           &
( 2849)                                    bottom_top_offset(FIELD_MASS_FLUX_X))
( 2850)     ELSE
( 2851)       CALL clover_pack_message_top_c(chunks(chunk)%field%x_min,                    &
( 2852)                                      chunks(chunk)%field%x_max,                    &
( 2853)                                      chunks(chunk)%field%y_min,                    &
( 2854)                                      chunks(chunk)%field%y_max,                    &
( 2855)                                      chunks(chunk)%field%mass_flux_x,              &
( 2856)                                      chunks(chunk)%top_snd_buffer,                 &
( 2857)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2858)                                      depth, X_FACE_DATA,                           &
( 2859)                                      bottom_top_offset(FIELD_MASS_FLUX_X))
( 2860)     ENDIF
( 2861)   ENDIF
( 2862)   IF(fields(FIELD_MASS_FLUX_Y).EQ.1) THEN
( 2863)     IF(use_fortran_kernels) THEN
( 2864)       CALL clover_pack_message_top(chunks(chunk)%field%x_min,                    &
( 2865)                                    chunks(chunk)%field%x_max,                    &
( 2866)                                    chunks(chunk)%field%y_min,                    &
( 2867)                                    chunks(chunk)%field%y_max,                    &
( 2868)                                    chunks(chunk)%field%z_min,                    &
( 2869)                                    chunks(chunk)%field%z_max,                    &
( 2870)                                    chunks(chunk)%field%mass_flux_y,              &
( 2871)                                    chunks(chunk)%top_snd_buffer,                 &
( 2872)                                    CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2873)                                    depth, Y_FACE_DATA,                           &
( 2874)                                    bottom_top_offset(FIELD_MASS_FLUX_Y))
( 2875)     ELSE
( 2876)       CALL clover_pack_message_top_c(chunks(chunk)%field%x_min,                    &
( 2877)                                      chunks(chunk)%field%x_max,                    &
( 2878)                                      chunks(chunk)%field%y_min,                    &
( 2879)                                      chunks(chunk)%field%y_max,                    &
( 2880)                                      chunks(chunk)%field%mass_flux_y,              &
( 2881)                                      chunks(chunk)%top_snd_buffer,                 &
( 2882)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2883)                                      depth, Y_FACE_DATA,                           &
( 2884)                                      bottom_top_offset(FIELD_MASS_FLUX_Y))
( 2885)     ENDIF
( 2886)   ENDIF
( 2887)   IF(fields(FIELD_MASS_FLUX_Z).EQ.1) THEN
( 2888)     IF(use_fortran_kernels) THEN
( 2889)       CALL clover_pack_message_top(chunks(chunk)%field%x_min,                    &
( 2890)                                    chunks(chunk)%field%x_max,                    &
( 2891)                                    chunks(chunk)%field%y_min,                    &
( 2892)                                    chunks(chunk)%field%y_max,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 51

( 2893)                                    chunks(chunk)%field%z_min,                    &
( 2894)                                    chunks(chunk)%field%z_max,                    &
( 2895)                                    chunks(chunk)%field%mass_flux_z,              &
( 2896)                                    chunks(chunk)%top_snd_buffer,                 &
( 2897)                                    CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2898)                                    depth, Z_FACE_DATA,                           &
( 2899)                                    bottom_top_offset(FIELD_MASS_FLUX_Z))
( 2900)     ELSE
( 2901)       CALL clover_pack_message_top_c(chunks(chunk)%field%x_min,                    &
( 2902)                                      chunks(chunk)%field%x_max,                    &
( 2903)                                      chunks(chunk)%field%y_min,                    &
( 2904)                                      chunks(chunk)%field%y_max,                    &
( 2905)                                      chunks(chunk)%field%mass_flux_z,              &
( 2906)                                      chunks(chunk)%top_snd_buffer,                 &
( 2907)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2908)                                      depth, Z_FACE_DATA,                           &
( 2909)                                      bottom_top_offset(FIELD_MASS_FLUX_Z))
( 2910)     ENDIF
( 2911)   ENDIF
( 2912) END SUBROUTINE clover_pack_top
( 2913) 
( 2914) SUBROUTINE clover_send_recv_message_top(top_snd_buffer, top_rcv_buffer,     &
( 2915)                                         chunk, total_size,                  &
( 2916)                                         tag_send, tag_recv,                 &
( 2917)                                         req_send, req_recv)
( 2918) 
( 2919)     IMPLICIT NONE
( 2920) 
( 2921)     REAL(KIND=8) :: top_snd_buffer(:), top_rcv_buffer(:)
( 2922)     INTEGER      :: top_task
( 2923)     INTEGER      :: chunk
( 2924)     INTEGER      :: total_size, tag_send, tag_recv, err
( 2925)     INTEGER      :: req_send, req_recv
( 2926) 
( 2927)     top_task=chunks(chunk)%chunk_neighbours(chunk_top) - 1
( 2928) 
( 2929)     CALL MPI_ISEND(top_snd_buffer,total_size,MPI_DOUBLE_PRECISION,top_task,tag_send, &
( 2930)                    MPI_COMM_WORLD,req_send,err)
( 2931) 
( 2932)     CALL MPI_IRECV(top_rcv_buffer,total_size,MPI_DOUBLE_PRECISION,top_task,tag_recv, &
( 2933)                    MPI_COMM_WORLD,req_recv,err)
( 2934) 
( 2935) END SUBROUTINE clover_send_recv_message_top
( 2936) 
( 2937) SUBROUTINE clover_unpack_top(fields, chunk, depth,                        &
( 2938)                              top_rcv_buffer,                              &
( 2939)                              bottom_top_offset)
( 2940) 
( 2941)   USE pack_kernel_module
( 2942) 
( 2943)   IMPLICIT NONE
( 2944) 
( 2945)   INTEGER         :: fields(:), chunk, total_in_top_buff, depth, bottom_top_offset(:)
( 2946)   REAL(KIND=8)    :: top_rcv_buffer(:)
( 2947) 
( 2948) 
( 2949)   IF(fields(FIELD_DENSITY0).EQ.1) THEN
( 2950)     IF(use_fortran_kernels) THEN






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 52

( 2951)       CALL clover_unpack_message_top(chunks(chunk)%field%x_min,                    &
( 2952)                                      chunks(chunk)%field%x_max,                    &
( 2953)                                      chunks(chunk)%field%y_min,                    &
( 2954)                                      chunks(chunk)%field%y_max,                    &
( 2955)                                      chunks(chunk)%field%z_min,                    &
( 2956)                                      chunks(chunk)%field%z_max,                    &
( 2957)                                      chunks(chunk)%field%density0,                 &
( 2958)                                      chunks(chunk)%top_rcv_buffer,                 &
( 2959)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2960)                                      depth, CELL_DATA,                             &
( 2961)                                      bottom_top_offset(FIELD_DENSITY0))
( 2962)     ELSE
( 2963)       CALL clover_unpack_message_top_c(chunks(chunk)%field%x_min,                    &
( 2964)                                        chunks(chunk)%field%x_max,                    &
( 2965)                                        chunks(chunk)%field%y_min,                    &
( 2966)                                        chunks(chunk)%field%y_max,                    &
( 2967)                                        chunks(chunk)%field%density0,                 &
( 2968)                                        chunks(chunk)%top_rcv_buffer,                 &
( 2969)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2970)                                        depth, CELL_DATA,                             &
( 2971)                                        bottom_top_offset(FIELD_DENSITY0))
( 2972)     ENDIF
( 2973)   ENDIF
( 2974)   IF(fields(FIELD_DENSITY1).EQ.1) THEN
( 2975)     IF(use_fortran_kernels) THEN
( 2976)       CALL clover_unpack_message_top(chunks(chunk)%field%x_min,                    &
( 2977)                                      chunks(chunk)%field%x_max,                    &
( 2978)                                      chunks(chunk)%field%y_min,                    &
( 2979)                                      chunks(chunk)%field%y_max,                    &
( 2980)                                      chunks(chunk)%field%z_min,                    &
( 2981)                                      chunks(chunk)%field%z_max,                    &
( 2982)                                      chunks(chunk)%field%density1,                 &
( 2983)                                      chunks(chunk)%top_rcv_buffer,                 &
( 2984)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 2985)                                      depth, CELL_DATA,                             &
( 2986)                                      bottom_top_offset(FIELD_DENSITY1))
( 2987)     ELSE
( 2988)       CALL clover_unpack_message_top_c(chunks(chunk)%field%x_min,                    &
( 2989)                                        chunks(chunk)%field%x_max,                    &
( 2990)                                        chunks(chunk)%field%y_min,                    &
( 2991)                                        chunks(chunk)%field%y_max,                    &
( 2992)                                        chunks(chunk)%field%density1,                 &
( 2993)                                        chunks(chunk)%top_rcv_buffer,                 &
( 2994)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 2995)                                        depth, CELL_DATA,                             &
( 2996)                                        bottom_top_offset(FIELD_DENSITY1))
( 2997)     ENDIF
( 2998)   ENDIF
( 2999)   IF(fields(FIELD_ENERGY0).EQ.1) THEN
( 3000)     IF(use_fortran_kernels) THEN
( 3001)       CALL clover_unpack_message_top(chunks(chunk)%field%x_min,                    &
( 3002)                                      chunks(chunk)%field%x_max,                    &
( 3003)                                      chunks(chunk)%field%y_min,                    &
( 3004)                                      chunks(chunk)%field%y_max,                    &
( 3005)                                      chunks(chunk)%field%z_min,                    &
( 3006)                                      chunks(chunk)%field%z_max,                    &
( 3007)                                      chunks(chunk)%field%energy0,                  &
( 3008)                                      chunks(chunk)%top_rcv_buffer,                 &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 53

( 3009)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3010)                                      depth, CELL_DATA,                             &
( 3011)                                      bottom_top_offset(FIELD_ENERGY0))
( 3012)     ELSE
( 3013)       CALL clover_unpack_message_top_c(chunks(chunk)%field%x_min,                    &
( 3014)                                        chunks(chunk)%field%x_max,                    &
( 3015)                                        chunks(chunk)%field%y_min,                    &
( 3016)                                        chunks(chunk)%field%y_max,                    &
( 3017)                                        chunks(chunk)%field%energy0,                  &
( 3018)                                        chunks(chunk)%top_rcv_buffer,                 &
( 3019)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3020)                                        depth, CELL_DATA,                             &
( 3021)                                        bottom_top_offset(FIELD_ENERGY0))
( 3022)     ENDIF
( 3023)   ENDIF
( 3024)   IF(fields(FIELD_ENERGY1).EQ.1) THEN
( 3025)     IF(use_fortran_kernels) THEN
( 3026)       CALL clover_unpack_message_top(chunks(chunk)%field%x_min,                    &
( 3027)                                      chunks(chunk)%field%x_max,                    &
( 3028)                                      chunks(chunk)%field%y_min,                    &
( 3029)                                      chunks(chunk)%field%y_max,                    &
( 3030)                                      chunks(chunk)%field%z_min,                    &
( 3031)                                      chunks(chunk)%field%z_max,                    &
( 3032)                                      chunks(chunk)%field%energy1,                  &
( 3033)                                      chunks(chunk)%top_rcv_buffer,                 &
( 3034)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3035)                                      depth, CELL_DATA,                             &
( 3036)                                      bottom_top_offset(FIELD_ENERGY1))
( 3037)     ELSE
( 3038)       CALL clover_unpack_message_top_c(chunks(chunk)%field%x_min,                    &
( 3039)                                        chunks(chunk)%field%x_max,                    &
( 3040)                                        chunks(chunk)%field%y_min,                    &
( 3041)                                        chunks(chunk)%field%y_max,                    &
( 3042)                                        chunks(chunk)%field%energy1,                  &
( 3043)                                        chunks(chunk)%top_rcv_buffer,                 &
( 3044)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3045)                                        depth, CELL_DATA,                             &
( 3046)                                        bottom_top_offset(FIELD_ENERGY1))
( 3047)     ENDIF
( 3048)   ENDIF
( 3049)   IF(fields(FIELD_PRESSURE).EQ.1) THEN
( 3050)     IF(use_fortran_kernels) THEN
( 3051)       CALL clover_unpack_message_top(chunks(chunk)%field%x_min,                    &
( 3052)                                      chunks(chunk)%field%x_max,                    &
( 3053)                                      chunks(chunk)%field%y_min,                    &
( 3054)                                      chunks(chunk)%field%y_max,                    &
( 3055)                                      chunks(chunk)%field%z_min,                    &
( 3056)                                      chunks(chunk)%field%z_max,                    &
( 3057)                                      chunks(chunk)%field%pressure,                 &
( 3058)                                      chunks(chunk)%top_rcv_buffer,                 &
( 3059)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3060)                                      depth, CELL_DATA,                             &
( 3061)                                      bottom_top_offset(FIELD_PRESSURE))
( 3062)     ELSE
( 3063)       CALL clover_unpack_message_top_c(chunks(chunk)%field%x_min,                    &
( 3064)                                        chunks(chunk)%field%x_max,                    &
( 3065)                                        chunks(chunk)%field%y_min,                    &
( 3066)                                        chunks(chunk)%field%y_max,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 54

( 3067)                                        chunks(chunk)%field%pressure,                 &
( 3068)                                        chunks(chunk)%top_rcv_buffer,                 &
( 3069)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3070)                                        depth, CELL_DATA,                             &
( 3071)                                        bottom_top_offset(FIELD_PRESSURE))
( 3072)     ENDIF
( 3073)   ENDIF
( 3074)   IF(fields(FIELD_VISCOSITY).EQ.1) THEN
( 3075)     IF(use_fortran_kernels) THEN
( 3076)       CALL clover_unpack_message_top(chunks(chunk)%field%x_min,                    &
( 3077)                                      chunks(chunk)%field%x_max,                    &
( 3078)                                      chunks(chunk)%field%y_min,                    &
( 3079)                                      chunks(chunk)%field%y_max,                    &
( 3080)                                      chunks(chunk)%field%z_min,                    &
( 3081)                                      chunks(chunk)%field%z_max,                    &
( 3082)                                      chunks(chunk)%field%viscosity,                &
( 3083)                                      chunks(chunk)%top_rcv_buffer,                 &
( 3084)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3085)                                      depth, CELL_DATA,                             &
( 3086)                                      bottom_top_offset(FIELD_VISCOSITY))
( 3087)     ELSE
( 3088)       CALL clover_unpack_message_top_c(chunks(chunk)%field%x_min,                    &
( 3089)                                        chunks(chunk)%field%x_max,                    &
( 3090)                                        chunks(chunk)%field%y_min,                    &
( 3091)                                        chunks(chunk)%field%y_max,                    &
( 3092)                                        chunks(chunk)%field%viscosity,                &
( 3093)                                        chunks(chunk)%top_rcv_buffer,                 &
( 3094)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3095)                                        depth, CELL_DATA,                             &
( 3096)                                        bottom_top_offset(FIELD_VISCOSITY))
( 3097)     ENDIF
( 3098)   ENDIF
( 3099)   IF(fields(FIELD_SOUNDSPEED).EQ.1) THEN
( 3100)     IF(use_fortran_kernels) THEN
( 3101)       CALL clover_unpack_message_top(chunks(chunk)%field%x_min,                    &
( 3102)                                      chunks(chunk)%field%x_max,                    &
( 3103)                                      chunks(chunk)%field%y_min,                    &
( 3104)                                      chunks(chunk)%field%y_max,                    &
( 3105)                                      chunks(chunk)%field%z_min,                    &
( 3106)                                      chunks(chunk)%field%z_max,                    &
( 3107)                                      chunks(chunk)%field%soundspeed,               &
( 3108)                                      chunks(chunk)%top_rcv_buffer,                 &
( 3109)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3110)                                      depth, CELL_DATA,                             &
( 3111)                                      bottom_top_offset(FIELD_SOUNDSPEED))
( 3112)     ELSE
( 3113)       CALL clover_unpack_message_top_c(chunks(chunk)%field%x_min,                    &
( 3114)                                        chunks(chunk)%field%x_max,                    &
( 3115)                                        chunks(chunk)%field%y_min,                    &
( 3116)                                        chunks(chunk)%field%y_max,                    &
( 3117)                                        chunks(chunk)%field%soundspeed,               &
( 3118)                                        chunks(chunk)%top_rcv_buffer,                 &
( 3119)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3120)                                        depth, CELL_DATA,                             &
( 3121)                                        bottom_top_offset(FIELD_SOUNDSPEED))
( 3122)     ENDIF
( 3123)   ENDIF
( 3124)   IF(fields(FIELD_XVEL0).EQ.1) THEN






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 55

( 3125)     IF(use_fortran_kernels) THEN
( 3126)       CALL clover_unpack_message_top(chunks(chunk)%field%x_min,                    &
( 3127)                                      chunks(chunk)%field%x_max,                    &
( 3128)                                      chunks(chunk)%field%y_min,                    &
( 3129)                                      chunks(chunk)%field%y_max,                    &
( 3130)                                      chunks(chunk)%field%z_min,                    &
( 3131)                                      chunks(chunk)%field%z_max,                    &
( 3132)                                      chunks(chunk)%field%xvel0,                    &
( 3133)                                      chunks(chunk)%top_rcv_buffer,                 &
( 3134)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3135)                                      depth, VERTEX_DATA,                           &
( 3136)                                      bottom_top_offset(FIELD_XVEL0))
( 3137)     ELSE
( 3138)       CALL clover_unpack_message_top_c(chunks(chunk)%field%x_min,                    &
( 3139)                                        chunks(chunk)%field%x_max,                    &
( 3140)                                        chunks(chunk)%field%y_min,                    &
( 3141)                                        chunks(chunk)%field%y_max,                    &
( 3142)                                        chunks(chunk)%field%xvel0,                    &
( 3143)                                        chunks(chunk)%top_rcv_buffer,                 &
( 3144)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3145)                                        depth, VERTEX_DATA,                           &
( 3146)                                        bottom_top_offset(FIELD_XVEL0))
( 3147)     ENDIF
( 3148)   ENDIF
( 3149)   IF(fields(FIELD_XVEL1).EQ.1) THEN
( 3150)     IF(use_fortran_kernels) THEN
( 3151)       CALL clover_unpack_message_top(chunks(chunk)%field%x_min,                    &
( 3152)                                      chunks(chunk)%field%x_max,                    &
( 3153)                                      chunks(chunk)%field%y_min,                    &
( 3154)                                      chunks(chunk)%field%y_max,                    &
( 3155)                                      chunks(chunk)%field%z_min,                    &
( 3156)                                      chunks(chunk)%field%z_max,                    &
( 3157)                                      chunks(chunk)%field%xvel1,                    &
( 3158)                                      chunks(chunk)%top_rcv_buffer,                 &
( 3159)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3160)                                      depth, VERTEX_DATA,                           &
( 3161)                                      bottom_top_offset(FIELD_XVEL1))
( 3162)     ELSE
( 3163)       CALL clover_unpack_message_top_c(chunks(chunk)%field%x_min,                    &
( 3164)                                        chunks(chunk)%field%x_max,                    &
( 3165)                                        chunks(chunk)%field%y_min,                    &
( 3166)                                        chunks(chunk)%field%y_max,                    &
( 3167)                                        chunks(chunk)%field%xvel1,                    &
( 3168)                                        chunks(chunk)%top_rcv_buffer,                 &
( 3169)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3170)                                        depth, VERTEX_DATA,                           &
( 3171)                                        bottom_top_offset(FIELD_XVEL1))
( 3172)     ENDIF
( 3173)   ENDIF
( 3174)   IF(fields(FIELD_YVEL0).EQ.1) THEN
( 3175)     IF(use_fortran_kernels) THEN
( 3176)       CALL clover_unpack_message_top(chunks(chunk)%field%x_min,                    &
( 3177)                                      chunks(chunk)%field%x_max,                    &
( 3178)                                      chunks(chunk)%field%y_min,                    &
( 3179)                                      chunks(chunk)%field%y_max,                    &
( 3180)                                      chunks(chunk)%field%z_min,                    &
( 3181)                                      chunks(chunk)%field%z_max,                    &
( 3182)                                      chunks(chunk)%field%yvel0,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 56

( 3183)                                      chunks(chunk)%top_rcv_buffer,                 &
( 3184)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3185)                                      depth, VERTEX_DATA,                           &
( 3186)                                      bottom_top_offset(FIELD_YVEL0))
( 3187)     ELSE
( 3188)       CALL clover_unpack_message_top_c(chunks(chunk)%field%x_min,                    &
( 3189)                                        chunks(chunk)%field%x_max,                    &
( 3190)                                        chunks(chunk)%field%y_min,                    &
( 3191)                                        chunks(chunk)%field%y_max,                    &
( 3192)                                        chunks(chunk)%field%yvel0,                    &
( 3193)                                        chunks(chunk)%top_rcv_buffer,                 &
( 3194)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3195)                                        depth, VERTEX_DATA,                           &
( 3196)                                        bottom_top_offset(FIELD_YVEL0))
( 3197)     ENDIF
( 3198)   ENDIF
( 3199)   IF(fields(FIELD_YVEL1).EQ.1) THEN
( 3200)     IF(use_fortran_kernels) THEN
( 3201)       CALL clover_unpack_message_top(chunks(chunk)%field%x_min,                    &
( 3202)                                      chunks(chunk)%field%x_max,                    &
( 3203)                                      chunks(chunk)%field%y_min,                    &
( 3204)                                      chunks(chunk)%field%y_max,                    &
( 3205)                                      chunks(chunk)%field%z_min,                    &
( 3206)                                      chunks(chunk)%field%z_max,                    &
( 3207)                                      chunks(chunk)%field%yvel1,                    &
( 3208)                                      chunks(chunk)%top_rcv_buffer,                 &
( 3209)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3210)                                      depth, VERTEX_DATA,                           &
( 3211)                                      bottom_top_offset(FIELD_YVEL1))
( 3212)     ELSE
( 3213)       CALL clover_unpack_message_top_c(chunks(chunk)%field%x_min,                    &
( 3214)                                        chunks(chunk)%field%x_max,                    &
( 3215)                                        chunks(chunk)%field%y_min,                    &
( 3216)                                        chunks(chunk)%field%y_max,                    &
( 3217)                                        chunks(chunk)%field%yvel1,                    &
( 3218)                                        chunks(chunk)%top_rcv_buffer,                 &
( 3219)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3220)                                        depth, VERTEX_DATA,                           &
( 3221)                                        bottom_top_offset(FIELD_YVEL1))
( 3222)     ENDIF
( 3223)   ENDIF
( 3224)   IF(fields(FIELD_ZVEL0).EQ.1) THEN
( 3225)     IF(use_fortran_kernels) THEN
( 3226)       CALL clover_unpack_message_top(chunks(chunk)%field%x_min,                    &
( 3227)                                      chunks(chunk)%field%x_max,                    &
( 3228)                                      chunks(chunk)%field%y_min,                    &
( 3229)                                      chunks(chunk)%field%y_max,                    &
( 3230)                                      chunks(chunk)%field%z_min,                    &
( 3231)                                      chunks(chunk)%field%z_max,                    &
( 3232)                                      chunks(chunk)%field%zvel0,                    &
( 3233)                                      chunks(chunk)%top_rcv_buffer,                 &
( 3234)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3235)                                      depth, VERTEX_DATA,                           &
( 3236)                                      bottom_top_offset(FIELD_ZVEL0))
( 3237)     ELSE
( 3238)       CALL clover_unpack_message_top_c(chunks(chunk)%field%x_min,                    &
( 3239)                                        chunks(chunk)%field%x_max,                    &
( 3240)                                        chunks(chunk)%field%y_min,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 57

( 3241)                                        chunks(chunk)%field%y_max,                    &
( 3242)                                        chunks(chunk)%field%zvel0,                    &
( 3243)                                        chunks(chunk)%top_rcv_buffer,                 &
( 3244)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3245)                                        depth, VERTEX_DATA,                           &
( 3246)                                        bottom_top_offset(FIELD_ZVEL0))
( 3247)     ENDIF
( 3248)   ENDIF
( 3249)   IF(fields(FIELD_ZVEL1).EQ.1) THEN
( 3250)     IF(use_fortran_kernels) THEN
( 3251)       CALL clover_unpack_message_top(chunks(chunk)%field%x_min,                    &
( 3252)                                      chunks(chunk)%field%x_max,                    &
( 3253)                                      chunks(chunk)%field%y_min,                    &
( 3254)                                      chunks(chunk)%field%y_max,                    &
( 3255)                                      chunks(chunk)%field%z_min,                    &
( 3256)                                      chunks(chunk)%field%z_max,                    &
( 3257)                                      chunks(chunk)%field%zvel1,                    &
( 3258)                                      chunks(chunk)%top_rcv_buffer,                 &
( 3259)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3260)                                      depth, VERTEX_DATA,                           &
( 3261)                                      bottom_top_offset(FIELD_ZVEL1))
( 3262)     ELSE
( 3263)       CALL clover_unpack_message_top_c(chunks(chunk)%field%x_min,                    &
( 3264)                                        chunks(chunk)%field%x_max,                    &
( 3265)                                        chunks(chunk)%field%y_min,                    &
( 3266)                                        chunks(chunk)%field%y_max,                    &
( 3267)                                        chunks(chunk)%field%zvel1,                    &
( 3268)                                        chunks(chunk)%top_rcv_buffer,                 &
( 3269)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3270)                                        depth, VERTEX_DATA,                           &
( 3271)                                        bottom_top_offset(FIELD_ZVEL1))
( 3272)     ENDIF
( 3273)   ENDIF
( 3274)   IF(fields(FIELD_VOL_FLUX_X).EQ.1) THEN
( 3275)     IF(use_fortran_kernels) THEN
( 3276)       CALL clover_unpack_message_top(chunks(chunk)%field%x_min,                    &
( 3277)                                      chunks(chunk)%field%x_max,                    &
( 3278)                                      chunks(chunk)%field%y_min,                    &
( 3279)                                      chunks(chunk)%field%y_max,                    &
( 3280)                                      chunks(chunk)%field%z_min,                    &
( 3281)                                      chunks(chunk)%field%z_max,                    &
( 3282)                                      chunks(chunk)%field%vol_flux_x,               &
( 3283)                                      chunks(chunk)%top_rcv_buffer,                 &
( 3284)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3285)                                      depth, X_FACE_DATA,                           &
( 3286)                                      bottom_top_offset(FIELD_VOL_FLUX_X))
( 3287)     ELSE
( 3288)       CALL clover_unpack_message_top_c(chunks(chunk)%field%x_min,                    &
( 3289)                                        chunks(chunk)%field%x_max,                    &
( 3290)                                        chunks(chunk)%field%y_min,                    &
( 3291)                                        chunks(chunk)%field%y_max,                    &
( 3292)                                        chunks(chunk)%field%vol_flux_x,               &
( 3293)                                        chunks(chunk)%top_rcv_buffer,                 &
( 3294)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3295)                                        depth, X_FACE_DATA,                           &
( 3296)                                        bottom_top_offset(FIELD_VOL_FLUX_X))
( 3297)     ENDIF
( 3298)   ENDIF






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 58

( 3299)   IF(fields(FIELD_VOL_FLUX_Y).EQ.1) THEN
( 3300)     IF(use_fortran_kernels) THEN
( 3301)       CALL clover_unpack_message_top(chunks(chunk)%field%x_min,                    &
( 3302)                                      chunks(chunk)%field%x_max,                    &
( 3303)                                      chunks(chunk)%field%y_min,                    &
( 3304)                                      chunks(chunk)%field%y_max,                    &
( 3305)                                      chunks(chunk)%field%z_min,                    &
( 3306)                                      chunks(chunk)%field%z_max,                    &
( 3307)                                      chunks(chunk)%field%vol_flux_y,               &
( 3308)                                      chunks(chunk)%top_rcv_buffer,                 &
( 3309)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3310)                                      depth, Y_FACE_DATA,                           &
( 3311)                                      bottom_top_offset(FIELD_VOL_FLUX_Y))
( 3312)     ELSE
( 3313)       CALL clover_unpack_message_top_c(chunks(chunk)%field%x_min,                    &
( 3314)                                        chunks(chunk)%field%x_max,                    &
( 3315)                                        chunks(chunk)%field%y_min,                    &
( 3316)                                        chunks(chunk)%field%y_max,                    &
( 3317)                                        chunks(chunk)%field%vol_flux_y,               &
( 3318)                                        chunks(chunk)%top_rcv_buffer,                 &
( 3319)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3320)                                        depth, Y_FACE_DATA,                           &
( 3321)                                        bottom_top_offset(FIELD_VOL_FLUX_Y))
( 3322)     ENDIF
( 3323)   ENDIF
( 3324)   IF(fields(FIELD_VOL_FLUX_Z).EQ.1) THEN
( 3325)     IF(use_fortran_kernels) THEN
( 3326)       CALL clover_unpack_message_top(chunks(chunk)%field%x_min,                    &
( 3327)                                      chunks(chunk)%field%x_max,                    &
( 3328)                                      chunks(chunk)%field%y_min,                    &
( 3329)                                      chunks(chunk)%field%y_max,                    &
( 3330)                                      chunks(chunk)%field%z_min,                    &
( 3331)                                      chunks(chunk)%field%z_max,                    &
( 3332)                                      chunks(chunk)%field%vol_flux_z,               &
( 3333)                                      chunks(chunk)%top_rcv_buffer,                 &
( 3334)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3335)                                      depth, Z_FACE_DATA,                           &
( 3336)                                      bottom_top_offset(FIELD_VOL_FLUX_Z))
( 3337)     ELSE
( 3338)       CALL clover_unpack_message_top_c(chunks(chunk)%field%x_min,                    &
( 3339)                                        chunks(chunk)%field%x_max,                    &
( 3340)                                        chunks(chunk)%field%y_min,                    &
( 3341)                                        chunks(chunk)%field%y_max,                    &
( 3342)                                        chunks(chunk)%field%vol_flux_z,               &
( 3343)                                        chunks(chunk)%top_rcv_buffer,                 &
( 3344)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3345)                                        depth, Z_FACE_DATA,                           &
( 3346)                                        bottom_top_offset(FIELD_VOL_FLUX_Z))
( 3347)     ENDIF
( 3348)   ENDIF
( 3349)   IF(fields(FIELD_MASS_FLUX_X).EQ.1) THEN
( 3350)     IF(use_fortran_kernels) THEN
( 3351)       CALL clover_unpack_message_top(chunks(chunk)%field%x_min,                    &
( 3352)                                      chunks(chunk)%field%x_max,                    &
( 3353)                                      chunks(chunk)%field%y_min,                    &
( 3354)                                      chunks(chunk)%field%y_max,                    &
( 3355)                                      chunks(chunk)%field%z_min,                    &
( 3356)                                      chunks(chunk)%field%z_max,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 59

( 3357)                                      chunks(chunk)%field%mass_flux_x,              &
( 3358)                                      chunks(chunk)%top_rcv_buffer,                 &
( 3359)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3360)                                      depth, X_FACE_DATA,                           &
( 3361)                                      bottom_top_offset(FIELD_MASS_FLUX_X))
( 3362)     ELSE
( 3363)       CALL clover_unpack_message_top_c(chunks(chunk)%field%x_min,                    &
( 3364)                                        chunks(chunk)%field%x_max,                    &
( 3365)                                        chunks(chunk)%field%y_min,                    &
( 3366)                                        chunks(chunk)%field%y_max,                    &
( 3367)                                        chunks(chunk)%field%mass_flux_x,              &
( 3368)                                        chunks(chunk)%top_rcv_buffer,                 &
( 3369)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3370)                                        depth, X_FACE_DATA,                           &
( 3371)                                        bottom_top_offset(FIELD_MASS_FLUX_X))
( 3372)     ENDIF
( 3373)   ENDIF
( 3374)   IF(fields(FIELD_MASS_FLUX_Y).EQ.1) THEN
( 3375)     IF(use_fortran_kernels) THEN
( 3376)       CALL clover_unpack_message_top(chunks(chunk)%field%x_min,                    &
( 3377)                                      chunks(chunk)%field%x_max,                    &
( 3378)                                      chunks(chunk)%field%y_min,                    &
( 3379)                                      chunks(chunk)%field%y_max,                    &
( 3380)                                      chunks(chunk)%field%z_min,                    &
( 3381)                                      chunks(chunk)%field%z_max,                    &
( 3382)                                      chunks(chunk)%field%mass_flux_y,              &
( 3383)                                      chunks(chunk)%top_rcv_buffer,                 &
( 3384)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3385)                                      depth, Y_FACE_DATA,                           &
( 3386)                                      bottom_top_offset(FIELD_MASS_FLUX_Y))
( 3387)     ELSE
( 3388)       CALL clover_unpack_message_top_c(chunks(chunk)%field%x_min,                    &
( 3389)                                        chunks(chunk)%field%x_max,                    &
( 3390)                                        chunks(chunk)%field%y_min,                    &
( 3391)                                        chunks(chunk)%field%y_max,                    &
( 3392)                                        chunks(chunk)%field%mass_flux_y,              &
( 3393)                                        chunks(chunk)%top_rcv_buffer,                 &
( 3394)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3395)                                        depth, Y_FACE_DATA,                           &
( 3396)                                        bottom_top_offset(FIELD_MASS_FLUX_Y))
( 3397)     ENDIF
( 3398)   ENDIF
( 3399)   IF(fields(FIELD_MASS_FLUX_Z).EQ.1) THEN
( 3400)     IF(use_fortran_kernels) THEN
( 3401)       CALL clover_unpack_message_top(chunks(chunk)%field%x_min,                    &
( 3402)                                      chunks(chunk)%field%x_max,                    &
( 3403)                                      chunks(chunk)%field%y_min,                    &
( 3404)                                      chunks(chunk)%field%y_max,                    &
( 3405)                                      chunks(chunk)%field%z_min,                    &
( 3406)                                      chunks(chunk)%field%z_max,                    &
( 3407)                                      chunks(chunk)%field%mass_flux_z,              &
( 3408)                                      chunks(chunk)%top_rcv_buffer,                 &
( 3409)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3410)                                      depth, Z_FACE_DATA,                           &
( 3411)                                      bottom_top_offset(FIELD_MASS_FLUX_Z))
( 3412)     ELSE
( 3413)       CALL clover_unpack_message_top_c(chunks(chunk)%field%x_min,                    &
( 3414)                                        chunks(chunk)%field%x_max,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 60

( 3415)                                        chunks(chunk)%field%y_min,                    &
( 3416)                                        chunks(chunk)%field%y_max,                    &
( 3417)                                        chunks(chunk)%field%mass_flux_z,              &
( 3418)                                        chunks(chunk)%top_rcv_buffer,                 &
( 3419)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3420)                                        depth, Z_FACE_DATA,                           &
( 3421)                                        bottom_top_offset(FIELD_MASS_FLUX_Z))
( 3422)     ENDIF
( 3423)   ENDIF
( 3424) END SUBROUTINE clover_unpack_top
( 3425) 
( 3426) SUBROUTINE clover_pack_bottom(chunk, fields, depth, bottom_top_offset)
( 3427) 
( 3428)   USE pack_kernel_module
( 3429) 
( 3430)   IMPLICIT NONE
( 3431) 
( 3432)   INTEGER        :: chunk, fields(:), depth, tot_packb, bottom_top_offset(:)
( 3433) 
( 3434)   IF(fields(FIELD_DENSITY0).EQ.1) THEN
( 3435)     IF(use_fortran_kernels) THEN
( 3436)       CALL clover_pack_message_bottom(chunks(chunk)%field%x_min,                    &
( 3437)                                       chunks(chunk)%field%x_max,                    &
( 3438)                                       chunks(chunk)%field%y_min,                    &
( 3439)                                       chunks(chunk)%field%y_max,                    &
( 3440)                                       chunks(chunk)%field%z_min,                    &
( 3441)                                       chunks(chunk)%field%z_max,                    &
( 3442)                                       chunks(chunk)%field%density0,                 &
( 3443)                                       chunks(chunk)%bottom_snd_buffer,              &
( 3444)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3445)                                       depth, CELL_DATA,                             &
( 3446)                                       bottom_top_offset(FIELD_DENSITY0))
( 3447)     ELSE
( 3448)       CALL clover_pack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 3449)                                         chunks(chunk)%field%x_max,                    &
( 3450)                                         chunks(chunk)%field%y_min,                    &
( 3451)                                         chunks(chunk)%field%y_max,                    &
( 3452)                                         chunks(chunk)%field%density0,                 &
( 3453)                                         chunks(chunk)%bottom_snd_buffer,              &
( 3454)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3455)                                         depth, CELL_DATA,                             &
( 3456)                                         bottom_top_offset(FIELD_DENSITY0))
( 3457)     ENDIF
( 3458)   ENDIF
( 3459)   IF(fields(FIELD_DENSITY1).EQ.1) THEN
( 3460)     IF(use_fortran_kernels) THEN
( 3461)       CALL clover_pack_message_bottom(chunks(chunk)%field%x_min,                    &
( 3462)                                       chunks(chunk)%field%x_max,                    &
( 3463)                                       chunks(chunk)%field%y_min,                    &
( 3464)                                       chunks(chunk)%field%y_max,                    &
( 3465)                                       chunks(chunk)%field%z_min,                    &
( 3466)                                       chunks(chunk)%field%z_max,                    &
( 3467)                                       chunks(chunk)%field%density1,                 &
( 3468)                                       chunks(chunk)%bottom_snd_buffer,              &
( 3469)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3470)                                       depth, CELL_DATA,                             &
( 3471)                                       bottom_top_offset(FIELD_DENSITY1))
( 3472)     ELSE






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 61

( 3473)       CALL clover_pack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 3474)                                         chunks(chunk)%field%x_max,                    &
( 3475)                                         chunks(chunk)%field%y_min,                    &
( 3476)                                         chunks(chunk)%field%y_max,                    &
( 3477)                                         chunks(chunk)%field%density1,                 &
( 3478)                                         chunks(chunk)%bottom_snd_buffer,              &
( 3479)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3480)                                         depth, CELL_DATA,                             &
( 3481)                                         bottom_top_offset(FIELD_DENSITY1))
( 3482)     ENDIF
( 3483)   ENDIF
( 3484)   IF(fields(FIELD_ENERGY0).EQ.1) THEN
( 3485)     IF(use_fortran_kernels) THEN
( 3486)       CALL clover_pack_message_bottom(chunks(chunk)%field%x_min,                    &
( 3487)                                       chunks(chunk)%field%x_max,                    &
( 3488)                                       chunks(chunk)%field%y_min,                    &
( 3489)                                       chunks(chunk)%field%y_max,                    &
( 3490)                                       chunks(chunk)%field%z_min,                    &
( 3491)                                       chunks(chunk)%field%z_max,                    &
( 3492)                                       chunks(chunk)%field%energy0,                  &
( 3493)                                       chunks(chunk)%bottom_snd_buffer,              &
( 3494)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3495)                                       depth, CELL_DATA,                             &
( 3496)                                       bottom_top_offset(FIELD_ENERGY0))
( 3497)     ELSE
( 3498)       CALL clover_pack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 3499)                                         chunks(chunk)%field%x_max,                    &
( 3500)                                         chunks(chunk)%field%y_min,                    &
( 3501)                                         chunks(chunk)%field%y_max,                    &
( 3502)                                         chunks(chunk)%field%energy0,                  &
( 3503)                                         chunks(chunk)%bottom_snd_buffer,              &
( 3504)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3505)                                         depth, CELL_DATA,                             &
( 3506)                                         bottom_top_offset(FIELD_ENERGY0))
( 3507)     ENDIF
( 3508)   ENDIF
( 3509)   IF(fields(FIELD_ENERGY1).EQ.1) THEN
( 3510)     IF(use_fortran_kernels) THEN
( 3511)       CALL clover_pack_message_bottom(chunks(chunk)%field%x_min,                    &
( 3512)                                       chunks(chunk)%field%x_max,                    &
( 3513)                                       chunks(chunk)%field%y_min,                    &
( 3514)                                       chunks(chunk)%field%y_max,                    &
( 3515)                                       chunks(chunk)%field%z_min,                    &
( 3516)                                       chunks(chunk)%field%z_max,                    &
( 3517)                                       chunks(chunk)%field%energy1,                  &
( 3518)                                       chunks(chunk)%bottom_snd_buffer,              &
( 3519)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3520)                                       depth, CELL_DATA,                             &
( 3521)                                       bottom_top_offset(FIELD_ENERGY1))
( 3522)     ELSE
( 3523)       CALL clover_pack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 3524)                                         chunks(chunk)%field%x_max,                    &
( 3525)                                         chunks(chunk)%field%y_min,                    &
( 3526)                                         chunks(chunk)%field%y_max,                    &
( 3527)                                         chunks(chunk)%field%energy1,                  &
( 3528)                                         chunks(chunk)%bottom_snd_buffer,              &
( 3529)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3530)                                         depth, CELL_DATA,                             &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 62

( 3531)                                         bottom_top_offset(FIELD_ENERGY1))
( 3532)     ENDIF
( 3533)   ENDIF
( 3534)   IF(fields(FIELD_PRESSURE).EQ.1) THEN
( 3535)     IF(use_fortran_kernels) THEN
( 3536)       CALL clover_pack_message_bottom(chunks(chunk)%field%x_min,                    &
( 3537)                                       chunks(chunk)%field%x_max,                    &
( 3538)                                       chunks(chunk)%field%y_min,                    &
( 3539)                                       chunks(chunk)%field%y_max,                    &
( 3540)                                       chunks(chunk)%field%z_min,                    &
( 3541)                                       chunks(chunk)%field%z_max,                    &
( 3542)                                       chunks(chunk)%field%pressure,                 &
( 3543)                                       chunks(chunk)%bottom_snd_buffer,              &
( 3544)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3545)                                       depth, CELL_DATA,                             &
( 3546)                                       bottom_top_offset(FIELD_PRESSURE))
( 3547)     ELSE
( 3548)       CALL clover_pack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 3549)                                         chunks(chunk)%field%x_max,                    &
( 3550)                                         chunks(chunk)%field%y_min,                    &
( 3551)                                         chunks(chunk)%field%y_max,                    &
( 3552)                                         chunks(chunk)%field%pressure,                 &
( 3553)                                         chunks(chunk)%bottom_snd_buffer,              &
( 3554)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3555)                                         depth, CELL_DATA,                             &
( 3556)                                         bottom_top_offset(FIELD_PRESSURE))
( 3557)     ENDIF
( 3558)   ENDIF
( 3559)   IF(fields(FIELD_VISCOSITY).EQ.1) THEN
( 3560)     IF(use_fortran_kernels) THEN
( 3561)       CALL clover_pack_message_bottom(chunks(chunk)%field%x_min,                    &
( 3562)                                       chunks(chunk)%field%x_max,                    &
( 3563)                                       chunks(chunk)%field%y_min,                    &
( 3564)                                       chunks(chunk)%field%y_max,                    &
( 3565)                                       chunks(chunk)%field%z_min,                    &
( 3566)                                       chunks(chunk)%field%z_max,                    &
( 3567)                                       chunks(chunk)%field%viscosity,                &
( 3568)                                       chunks(chunk)%bottom_snd_buffer,              &
( 3569)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3570)                                       depth, CELL_DATA,                             &
( 3571)                                       bottom_top_offset(FIELD_VISCOSITY))
( 3572)     ELSE
( 3573)       CALL clover_pack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 3574)                                         chunks(chunk)%field%x_max,                    &
( 3575)                                         chunks(chunk)%field%y_min,                    &
( 3576)                                         chunks(chunk)%field%y_max,                    &
( 3577)                                         chunks(chunk)%field%viscosity,                &
( 3578)                                         chunks(chunk)%bottom_snd_buffer,              &
( 3579)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3580)                                         depth, CELL_DATA,                             &
( 3581)                                         bottom_top_offset(FIELD_VISCOSITY))
( 3582)     ENDIF
( 3583)   ENDIF
( 3584)   IF(fields(FIELD_SOUNDSPEED).EQ.1) THEN
( 3585)     IF(use_fortran_kernels) THEN
( 3586)       CALL clover_pack_message_bottom(chunks(chunk)%field%x_min,                    &
( 3587)                                       chunks(chunk)%field%x_max,                    &
( 3588)                                       chunks(chunk)%field%y_min,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 63

( 3589)                                       chunks(chunk)%field%y_max,                    &
( 3590)                                       chunks(chunk)%field%z_min,                    &
( 3591)                                       chunks(chunk)%field%z_max,                    &
( 3592)                                       chunks(chunk)%field%soundspeed,               &
( 3593)                                       chunks(chunk)%bottom_snd_buffer,              &
( 3594)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3595)                                       depth, CELL_DATA,                             &
( 3596)                                       bottom_top_offset(FIELD_SOUNDSPEED))
( 3597)     ELSE
( 3598)       CALL clover_pack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 3599)                                         chunks(chunk)%field%x_max,                    &
( 3600)                                         chunks(chunk)%field%y_min,                    &
( 3601)                                         chunks(chunk)%field%y_max,                    &
( 3602)                                         chunks(chunk)%field%soundspeed,               &
( 3603)                                         chunks(chunk)%bottom_snd_buffer,              &
( 3604)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3605)                                         depth, CELL_DATA,                             &
( 3606)                                         bottom_top_offset(FIELD_SOUNDSPEED))
( 3607)     ENDIF
( 3608)   ENDIF
( 3609)   IF(fields(FIELD_XVEL0).EQ.1) THEN
( 3610)     IF(use_fortran_kernels) THEN
( 3611)       CALL clover_pack_message_bottom(chunks(chunk)%field%x_min,                    &
( 3612)                                       chunks(chunk)%field%x_max,                    &
( 3613)                                       chunks(chunk)%field%y_min,                    &
( 3614)                                       chunks(chunk)%field%y_max,                    &
( 3615)                                       chunks(chunk)%field%z_min,                    &
( 3616)                                       chunks(chunk)%field%z_max,                    &
( 3617)                                       chunks(chunk)%field%xvel0,                    &
( 3618)                                       chunks(chunk)%bottom_snd_buffer,              &
( 3619)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3620)                                       depth, VERTEX_DATA,                           &
( 3621)                                       bottom_top_offset(FIELD_XVEL0))
( 3622)     ELSE
( 3623)       CALL clover_pack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 3624)                                         chunks(chunk)%field%x_max,                    &
( 3625)                                         chunks(chunk)%field%y_min,                    &
( 3626)                                         chunks(chunk)%field%y_max,                    &
( 3627)                                         chunks(chunk)%field%xvel0     ,               &
( 3628)                                         chunks(chunk)%bottom_snd_buffer,              &
( 3629)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3630)                                         depth, VERTEX_DATA,                           &
( 3631)                                         bottom_top_offset(FIELD_XVEL0))
( 3632)     ENDIF
( 3633)   ENDIF
( 3634)   IF(fields(FIELD_XVEL1).EQ.1) THEN
( 3635)     IF(use_fortran_kernels) THEN
( 3636)       CALL clover_pack_message_bottom(chunks(chunk)%field%x_min,                    &
( 3637)                                       chunks(chunk)%field%x_max,                    &
( 3638)                                       chunks(chunk)%field%y_min,                    &
( 3639)                                       chunks(chunk)%field%y_max,                    &
( 3640)                                       chunks(chunk)%field%z_min,                    &
( 3641)                                       chunks(chunk)%field%z_max,                    &
( 3642)                                       chunks(chunk)%field%xvel1,                    &
( 3643)                                       chunks(chunk)%bottom_snd_buffer,              &
( 3644)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3645)                                       depth, VERTEX_DATA,                           &
( 3646)                                       bottom_top_offset(FIELD_XVEL1))






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 64

( 3647)     ELSE
( 3648)       CALL clover_pack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 3649)                                         chunks(chunk)%field%x_max,                    &
( 3650)                                         chunks(chunk)%field%y_min,                    &
( 3651)                                         chunks(chunk)%field%y_max,                    &
( 3652)                                         chunks(chunk)%field%xvel1,                    &
( 3653)                                         chunks(chunk)%bottom_snd_buffer,              &
( 3654)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3655)                                         depth, VERTEX_DATA,                           &
( 3656)                                         bottom_top_offset(FIELD_XVEL1))
( 3657)     ENDIF
( 3658)   ENDIF
( 3659)   IF(fields(FIELD_YVEL0).EQ.1) THEN
( 3660)     IF(use_fortran_kernels) THEN
( 3661)       CALL clover_pack_message_bottom(chunks(chunk)%field%x_min,                    &
( 3662)                                       chunks(chunk)%field%x_max,                    &
( 3663)                                       chunks(chunk)%field%y_min,                    &
( 3664)                                       chunks(chunk)%field%y_max,                    &
( 3665)                                       chunks(chunk)%field%z_min,                    &
( 3666)                                       chunks(chunk)%field%z_max,                    &
( 3667)                                       chunks(chunk)%field%yvel0,                    &
( 3668)                                       chunks(chunk)%bottom_snd_buffer,              &
( 3669)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3670)                                       depth, VERTEX_DATA,                           &
( 3671)                                       bottom_top_offset(FIELD_YVEL0))
( 3672)     ELSE
( 3673)       CALL clover_pack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 3674)                                         chunks(chunk)%field%x_max,                    &
( 3675)                                         chunks(chunk)%field%y_min,                    &
( 3676)                                         chunks(chunk)%field%y_max,                    &
( 3677)                                         chunks(chunk)%field%yvel0,                    &
( 3678)                                         chunks(chunk)%bottom_snd_buffer,              &
( 3679)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3680)                                         depth, VERTEX_DATA,                           &
( 3681)                                         bottom_top_offset(FIELD_YVEL0))
( 3682)     ENDIF
( 3683)   ENDIF
( 3684)   IF(fields(FIELD_YVEL1).EQ.1) THEN
( 3685)     IF(use_fortran_kernels) THEN
( 3686)       CALL clover_pack_message_bottom(chunks(chunk)%field%x_min,                    &
( 3687)                                       chunks(chunk)%field%x_max,                    &
( 3688)                                       chunks(chunk)%field%y_min,                    &
( 3689)                                       chunks(chunk)%field%y_max,                    &
( 3690)                                       chunks(chunk)%field%z_min,                    &
( 3691)                                       chunks(chunk)%field%z_max,                    &
( 3692)                                       chunks(chunk)%field%yvel1,                    &
( 3693)                                       chunks(chunk)%bottom_snd_buffer,              &
( 3694)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3695)                                       depth, VERTEX_DATA,                           &
( 3696)                                       bottom_top_offset(FIELD_YVEL1))
( 3697)     ELSE
( 3698)       CALL clover_pack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 3699)                                         chunks(chunk)%field%x_max,                    &
( 3700)                                         chunks(chunk)%field%y_min,                    &
( 3701)                                         chunks(chunk)%field%y_max,                    &
( 3702)                                         chunks(chunk)%field%yvel1,                    &
( 3703)                                         chunks(chunk)%bottom_snd_buffer,              &
( 3704)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 65

( 3705)                                         depth, VERTEX_DATA,                           &
( 3706)                                         bottom_top_offset(FIELD_YVEL1))
( 3707)     ENDIF
( 3708)   ENDIF
( 3709)   IF(fields(FIELD_ZVEL0).EQ.1) THEN
( 3710)     IF(use_fortran_kernels) THEN
( 3711)       CALL clover_pack_message_bottom(chunks(chunk)%field%x_min,                    &
( 3712)                                       chunks(chunk)%field%x_max,                    &
( 3713)                                       chunks(chunk)%field%y_min,                    &
( 3714)                                       chunks(chunk)%field%y_max,                    &
( 3715)                                       chunks(chunk)%field%z_min,                    &
( 3716)                                       chunks(chunk)%field%z_max,                    &
( 3717)                                       chunks(chunk)%field%zvel0,                    &
( 3718)                                       chunks(chunk)%bottom_snd_buffer,              &
( 3719)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3720)                                       depth, VERTEX_DATA,                           &
( 3721)                                       bottom_top_offset(FIELD_ZVEL0))
( 3722)     ELSE
( 3723)       CALL clover_pack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 3724)                                         chunks(chunk)%field%x_max,                    &
( 3725)                                         chunks(chunk)%field%y_min,                    &
( 3726)                                         chunks(chunk)%field%y_max,                    &
( 3727)                                         chunks(chunk)%field%zvel0,                    &
( 3728)                                         chunks(chunk)%bottom_snd_buffer,              &
( 3729)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3730)                                         depth, VERTEX_DATA,                           &
( 3731)                                         bottom_top_offset(FIELD_ZVEL0))
( 3732)     ENDIF
( 3733)   ENDIF
( 3734)   IF(fields(FIELD_ZVEL1).EQ.1) THEN
( 3735)     IF(use_fortran_kernels) THEN
( 3736)       CALL clover_pack_message_bottom(chunks(chunk)%field%x_min,                    &
( 3737)                                       chunks(chunk)%field%x_max,                    &
( 3738)                                       chunks(chunk)%field%y_min,                    &
( 3739)                                       chunks(chunk)%field%y_max,                    &
( 3740)                                       chunks(chunk)%field%z_min,                    &
( 3741)                                       chunks(chunk)%field%z_max,                    &
( 3742)                                       chunks(chunk)%field%zvel1,                    &
( 3743)                                       chunks(chunk)%bottom_snd_buffer,              &
( 3744)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3745)                                       depth, VERTEX_DATA,                           &
( 3746)                                       bottom_top_offset(FIELD_ZVEL1))
( 3747)     ELSE
( 3748)       CALL clover_pack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 3749)                                         chunks(chunk)%field%x_max,                    &
( 3750)                                         chunks(chunk)%field%y_min,                    &
( 3751)                                         chunks(chunk)%field%y_max,                    &
( 3752)                                         chunks(chunk)%field%zvel1,                    &
( 3753)                                         chunks(chunk)%bottom_snd_buffer,              &
( 3754)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3755)                                         depth, VERTEX_DATA,                           &
( 3756)                                         bottom_top_offset(FIELD_ZVEL1))
( 3757)     ENDIF
( 3758)   ENDIF
( 3759)   IF(fields(FIELD_VOL_FLUX_X).EQ.1) THEN
( 3760)     IF(use_fortran_kernels) THEN
( 3761)       CALL clover_pack_message_bottom(chunks(chunk)%field%x_min,                    &
( 3762)                                       chunks(chunk)%field%x_max,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 66

( 3763)                                       chunks(chunk)%field%y_min,                    &
( 3764)                                       chunks(chunk)%field%y_max,                    &
( 3765)                                       chunks(chunk)%field%z_min,                    &
( 3766)                                       chunks(chunk)%field%z_max,                    &
( 3767)                                       chunks(chunk)%field%vol_flux_x,               &
( 3768)                                       chunks(chunk)%bottom_snd_buffer,              &
( 3769)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3770)                                       depth, X_FACE_DATA,                           &
( 3771)                                       bottom_top_offset(FIELD_VOL_FLUX_X))
( 3772)     ELSE
( 3773)       CALL clover_pack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 3774)                                         chunks(chunk)%field%x_max,                    &
( 3775)                                         chunks(chunk)%field%y_min,                    &
( 3776)                                         chunks(chunk)%field%y_max,                    &
( 3777)                                         chunks(chunk)%field%vol_flux_x,               &
( 3778)                                         chunks(chunk)%bottom_snd_buffer,              &
( 3779)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3780)                                         depth, X_FACE_DATA,                           &
( 3781)                                         bottom_top_offset(FIELD_VOL_FLUX_X))
( 3782)     ENDIF
( 3783)   ENDIF
( 3784)   IF(fields(FIELD_VOL_FLUX_Y).EQ.1) THEN
( 3785)     IF(use_fortran_kernels) THEN
( 3786)       CALL clover_pack_message_bottom(chunks(chunk)%field%x_min,                    &
( 3787)                                       chunks(chunk)%field%x_max,                    &
( 3788)                                       chunks(chunk)%field%y_min,                    &
( 3789)                                       chunks(chunk)%field%y_max,                    &
( 3790)                                       chunks(chunk)%field%z_min,                    &
( 3791)                                       chunks(chunk)%field%z_max,                    &
( 3792)                                       chunks(chunk)%field%vol_flux_y,               &
( 3793)                                       chunks(chunk)%bottom_snd_buffer,              &
( 3794)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3795)                                       depth, Y_FACE_DATA,                           &
( 3796)                                       bottom_top_offset(FIELD_VOL_FLUX_Y))
( 3797)     ELSE
( 3798)       CALL clover_pack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 3799)                                         chunks(chunk)%field%x_max,                    &
( 3800)                                         chunks(chunk)%field%y_min,                    &
( 3801)                                         chunks(chunk)%field%y_max,                    &
( 3802)                                         chunks(chunk)%field%vol_flux_y,               &
( 3803)                                         chunks(chunk)%bottom_snd_buffer,              &
( 3804)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3805)                                         depth, Y_FACE_DATA,                           &
( 3806)                                         bottom_top_offset(FIELD_VOL_FLUX_Y))
( 3807)     ENDIF
( 3808)   ENDIF
( 3809)   IF(fields(FIELD_VOL_FLUX_Z).EQ.1) THEN
( 3810)     IF(use_fortran_kernels) THEN
( 3811)       CALL clover_pack_message_bottom(chunks(chunk)%field%x_min,                    &
( 3812)                                       chunks(chunk)%field%x_max,                    &
( 3813)                                       chunks(chunk)%field%y_min,                    &
( 3814)                                       chunks(chunk)%field%y_max,                    &
( 3815)                                       chunks(chunk)%field%z_min,                    &
( 3816)                                       chunks(chunk)%field%z_max,                    &
( 3817)                                       chunks(chunk)%field%vol_flux_z,               &
( 3818)                                       chunks(chunk)%bottom_snd_buffer,              &
( 3819)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3820)                                       depth, Z_FACE_DATA,                           &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 67

( 3821)                                       bottom_top_offset(FIELD_VOL_FLUX_Z))
( 3822)     ELSE
( 3823)       CALL clover_pack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 3824)                                         chunks(chunk)%field%x_max,                    &
( 3825)                                         chunks(chunk)%field%y_min,                    &
( 3826)                                         chunks(chunk)%field%y_max,                    &
( 3827)                                         chunks(chunk)%field%vol_flux_z,               &
( 3828)                                         chunks(chunk)%bottom_snd_buffer,              &
( 3829)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3830)                                         depth, Z_FACE_DATA,                           &
( 3831)                                         bottom_top_offset(FIELD_VOL_FLUX_Z))
( 3832)     ENDIF
( 3833)   ENDIF
( 3834)   IF(fields(FIELD_MASS_FLUX_X).EQ.1) THEN
( 3835)     IF(use_fortran_kernels) THEN
( 3836)       CALL clover_pack_message_bottom(chunks(chunk)%field%x_min,                    &
( 3837)                                       chunks(chunk)%field%x_max,                    &
( 3838)                                       chunks(chunk)%field%y_min,                    &
( 3839)                                       chunks(chunk)%field%y_max,                    &
( 3840)                                       chunks(chunk)%field%z_min,                    &
( 3841)                                       chunks(chunk)%field%z_max,                    &
( 3842)                                       chunks(chunk)%field%mass_flux_x,              &
( 3843)                                       chunks(chunk)%bottom_snd_buffer,              &
( 3844)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3845)                                       depth, X_FACE_DATA,                           &
( 3846)                                       bottom_top_offset(FIELD_MASS_FLUX_X))
( 3847)     ELSE
( 3848)       CALL clover_pack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 3849)                                         chunks(chunk)%field%x_max,                    &
( 3850)                                         chunks(chunk)%field%y_min,                    &
( 3851)                                         chunks(chunk)%field%y_max,                    &
( 3852)                                         chunks(chunk)%field%mass_flux_x,              &
( 3853)                                         chunks(chunk)%bottom_snd_buffer,              &
( 3854)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3855)                                         depth, X_FACE_DATA,                           &
( 3856)                                         bottom_top_offset(FIELD_MASS_FLUX_X))
( 3857)     ENDIF
( 3858)   ENDIF
( 3859)   IF(fields(FIELD_MASS_FLUX_Y).EQ.1) THEN
( 3860)     IF(use_fortran_kernels) THEN
( 3861)       CALL clover_pack_message_bottom(chunks(chunk)%field%x_min,                    &
( 3862)                                       chunks(chunk)%field%x_max,                    &
( 3863)                                       chunks(chunk)%field%y_min,                    &
( 3864)                                       chunks(chunk)%field%y_max,                    &
( 3865)                                       chunks(chunk)%field%z_min,                    &
( 3866)                                       chunks(chunk)%field%z_max,                    &
( 3867)                                       chunks(chunk)%field%mass_flux_y,              &
( 3868)                                       chunks(chunk)%bottom_snd_buffer,              &
( 3869)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3870)                                       depth, Y_FACE_DATA,                           &
( 3871)                                       bottom_top_offset(FIELD_MASS_FLUX_Y))
( 3872)     ELSE
( 3873)       CALL clover_pack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 3874)                                         chunks(chunk)%field%x_max,                    &
( 3875)                                         chunks(chunk)%field%y_min,                    &
( 3876)                                         chunks(chunk)%field%y_max,                    &
( 3877)                                         chunks(chunk)%field%mass_flux_y,              &
( 3878)                                         chunks(chunk)%bottom_snd_buffer,              &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 68

( 3879)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3880)                                         depth, Y_FACE_DATA,                           &
( 3881)                                         bottom_top_offset(FIELD_MASS_FLUX_Y))
( 3882)     ENDIF
( 3883)   ENDIF
( 3884)   IF(fields(FIELD_MASS_FLUX_Z).EQ.1) THEN
( 3885)     IF(use_fortran_kernels) THEN
( 3886)       CALL clover_pack_message_bottom(chunks(chunk)%field%x_min,                    &
( 3887)                                       chunks(chunk)%field%x_max,                    &
( 3888)                                       chunks(chunk)%field%y_min,                    &
( 3889)                                       chunks(chunk)%field%y_max,                    &
( 3890)                                       chunks(chunk)%field%z_min,                    &
( 3891)                                       chunks(chunk)%field%z_max,                    &
( 3892)                                       chunks(chunk)%field%mass_flux_z,              &
( 3893)                                       chunks(chunk)%bottom_snd_buffer,              &
( 3894)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3895)                                       depth, Z_FACE_DATA,                           &
( 3896)                                       bottom_top_offset(FIELD_MASS_FLUX_Z))
( 3897)     ELSE
( 3898)       CALL clover_pack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 3899)                                         chunks(chunk)%field%x_max,                    &
( 3900)                                         chunks(chunk)%field%y_min,                    &
( 3901)                                         chunks(chunk)%field%y_max,                    &
( 3902)                                         chunks(chunk)%field%mass_flux_z,              &
( 3903)                                         chunks(chunk)%bottom_snd_buffer,              &
( 3904)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3905)                                         depth, Z_FACE_DATA,                           &
( 3906)                                         bottom_top_offset(FIELD_MASS_FLUX_Z))
( 3907)     ENDIF
( 3908)   ENDIF
( 3909) END SUBROUTINE clover_pack_bottom
( 3910) 
( 3911) SUBROUTINE clover_send_recv_message_bottom(bottom_snd_buffer, bottom_rcv_buffer,        &
( 3912)                                            chunk, total_size,                           &   
( 3913)                                            tag_send, tag_recv,                          &
( 3914)                                            req_send, req_recv)
( 3915) 
( 3916)   IMPLICIT NONE
( 3917) 
( 3918)   REAL(KIND=8) :: bottom_snd_buffer(:), bottom_rcv_buffer(:)
( 3919)   INTEGER      :: bottom_task
( 3920)   INTEGER      :: chunk
( 3921)   INTEGER      :: total_size, tag_send, tag_recv, err
( 3922)   INTEGER      :: req_send, req_recv
( 3923) 
( 3924)   bottom_task=chunks(chunk)%chunk_neighbours(chunk_bottom) - 1
( 3925) 
( 3926)   CALL MPI_ISEND(bottom_snd_buffer,total_size,MPI_DOUBLE_PRECISION,bottom_task,tag_send &
( 3927)                 ,MPI_COMM_WORLD,req_send,err)
( 3928) 
( 3929)   CALL MPI_IRECV(bottom_rcv_buffer,total_size,MPI_DOUBLE_PRECISION,bottom_task,tag_recv &
( 3930)                 ,MPI_COMM_WORLD,req_recv,err)
( 3931) 
( 3932) END SUBROUTINE clover_send_recv_message_bottom
( 3933) 
( 3934) SUBROUTINE clover_unpack_bottom(fields, chunk, depth,                        &
( 3935)                              bottom_rcv_buffer,                              &
( 3936)                              bottom_top_offset)






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 69

( 3937) 
( 3938)   USE pack_kernel_module
( 3939) 
( 3940)   IMPLICIT NONE
( 3941) 
( 3942)   INTEGER         :: fields(:), chunk, depth, bottom_top_offset(:)
( 3943)   REAL(KIND=8)    :: bottom_rcv_buffer(:)
( 3944) 
( 3945)   IF(fields(FIELD_DENSITY0).EQ.1) THEN
( 3946)     IF(use_fortran_kernels) THEN
( 3947)       CALL clover_unpack_message_bottom(chunks(chunk)%field%x_min,                    &
( 3948)                                         chunks(chunk)%field%x_max,                    &
( 3949)                                         chunks(chunk)%field%y_min,                    &
( 3950)                                         chunks(chunk)%field%y_max,                    &
( 3951)                                         chunks(chunk)%field%z_min,                    &
( 3952)                                         chunks(chunk)%field%z_max,                    &
( 3953)                                         chunks(chunk)%field%density0,                 &
( 3954)                                         chunks(chunk)%bottom_rcv_buffer,              &
( 3955)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3956)                                         depth, CELL_DATA,                             &
( 3957)                                         bottom_top_offset(FIELD_DENSITY0))
( 3958)     ELSE
( 3959)       CALL clover_unpack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 3960)                                           chunks(chunk)%field%x_max,                    &
( 3961)                                           chunks(chunk)%field%y_min,                    &
( 3962)                                           chunks(chunk)%field%y_max,                    &
( 3963)                                           chunks(chunk)%field%density0,                 &
( 3964)                                           chunks(chunk)%bottom_rcv_buffer,              &
( 3965)                                           CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3966)                                           depth, CELL_DATA,                             &
( 3967)                                           bottom_top_offset(FIELD_DENSITY0))
( 3968)     ENDIF
( 3969)   ENDIF
( 3970)   IF(fields(FIELD_DENSITY1).EQ.1) THEN
( 3971)     IF(use_fortran_kernels) THEN
( 3972)       CALL clover_unpack_message_bottom(chunks(chunk)%field%x_min,                    &
( 3973)                                         chunks(chunk)%field%x_max,                    &
( 3974)                                         chunks(chunk)%field%y_min,                    &
( 3975)                                         chunks(chunk)%field%y_max,                    &
( 3976)                                         chunks(chunk)%field%z_min,                    &
( 3977)                                         chunks(chunk)%field%z_max,                    &
( 3978)                                         chunks(chunk)%field%density1,                 &
( 3979)                                         chunks(chunk)%bottom_rcv_buffer,              &
( 3980)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 3981)                                         depth, CELL_DATA,                             &
( 3982)                                         bottom_top_offset(FIELD_DENSITY1))
( 3983)     ELSE
( 3984)       CALL clover_unpack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 3985)                                           chunks(chunk)%field%x_max,                    &
( 3986)                                           chunks(chunk)%field%y_min,                    &
( 3987)                                           chunks(chunk)%field%y_max,                    &
( 3988)                                           chunks(chunk)%field%density1,                 &
( 3989)                                           chunks(chunk)%bottom_rcv_buffer,              &
( 3990)                                           CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 3991)                                           depth, CELL_DATA,                             &
( 3992)                                           bottom_top_offset(FIELD_DENSITY1))
( 3993)     ENDIF
( 3994)   ENDIF






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 70

( 3995)   IF(fields(FIELD_ENERGY0).EQ.1) THEN
( 3996)     IF(use_fortran_kernels) THEN
( 3997)       CALL clover_unpack_message_bottom(chunks(chunk)%field%x_min,                    &
( 3998)                                         chunks(chunk)%field%x_max,                    &
( 3999)                                         chunks(chunk)%field%y_min,                    &
( 4000)                                         chunks(chunk)%field%y_max,                    &
( 4001)                                         chunks(chunk)%field%z_min,                    &
( 4002)                                         chunks(chunk)%field%z_max,                    &
( 4003)                                         chunks(chunk)%field%energy0,                  &
( 4004)                                         chunks(chunk)%bottom_rcv_buffer,              &
( 4005)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4006)                                         depth, CELL_DATA,                             &
( 4007)                                         bottom_top_offset(FIELD_ENERGY0))
( 4008)     ELSE
( 4009)       CALL clover_unpack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 4010)                                           chunks(chunk)%field%x_max,                    &
( 4011)                                           chunks(chunk)%field%y_min,                    &
( 4012)                                           chunks(chunk)%field%y_max,                    &
( 4013)                                           chunks(chunk)%field%energy0,                  &
( 4014)                                           chunks(chunk)%bottom_rcv_buffer,              &
( 4015)                                           CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4016)                                           depth, CELL_DATA,                             &
( 4017)                                           bottom_top_offset(FIELD_ENERGY0))
( 4018)     ENDIF
( 4019)   ENDIF
( 4020)   IF(fields(FIELD_ENERGY1).EQ.1) THEN
( 4021)     IF(use_fortran_kernels) THEN
( 4022)       CALL clover_unpack_message_bottom(chunks(chunk)%field%x_min,                    &
( 4023)                                         chunks(chunk)%field%x_max,                    &
( 4024)                                         chunks(chunk)%field%y_min,                    &
( 4025)                                         chunks(chunk)%field%y_max,                    &
( 4026)                                         chunks(chunk)%field%z_min,                    &
( 4027)                                         chunks(chunk)%field%z_max,                    &
( 4028)                                         chunks(chunk)%field%energy1,                  &
( 4029)                                         chunks(chunk)%bottom_rcv_buffer,              &
( 4030)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4031)                                         depth, CELL_DATA,                             &
( 4032)                                         bottom_top_offset(FIELD_ENERGY1))
( 4033)     ELSE
( 4034)       CALL clover_unpack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 4035)                                           chunks(chunk)%field%x_max,                    &
( 4036)                                           chunks(chunk)%field%y_min,                    &
( 4037)                                           chunks(chunk)%field%y_max,                    &
( 4038)                                           chunks(chunk)%field%energy1,                  &
( 4039)                                           chunks(chunk)%bottom_rcv_buffer,              &
( 4040)                                           CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4041)                                           depth, CELL_DATA,                             &
( 4042)                                           bottom_top_offset(FIELD_ENERGY1))
( 4043)     ENDIF
( 4044)   ENDIF
( 4045)   IF(fields(FIELD_PRESSURE).EQ.1) THEN
( 4046)     IF(use_fortran_kernels) THEN
( 4047)       CALL clover_unpack_message_bottom(chunks(chunk)%field%x_min,                    &
( 4048)                                         chunks(chunk)%field%x_max,                    &
( 4049)                                         chunks(chunk)%field%y_min,                    &
( 4050)                                         chunks(chunk)%field%y_max,                    &
( 4051)                                         chunks(chunk)%field%z_min,                    &
( 4052)                                         chunks(chunk)%field%z_max,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 71

( 4053)                                         chunks(chunk)%field%pressure,                 &
( 4054)                                         chunks(chunk)%bottom_rcv_buffer,              &
( 4055)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4056)                                         depth, CELL_DATA,                             &
( 4057)                                         bottom_top_offset(FIELD_PRESSURE))
( 4058)     ELSE
( 4059)       CALL clover_unpack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 4060)                                           chunks(chunk)%field%x_max,                    &
( 4061)                                           chunks(chunk)%field%y_min,                    &
( 4062)                                           chunks(chunk)%field%y_max,                    &
( 4063)                                           chunks(chunk)%field%pressure,                 &
( 4064)                                           chunks(chunk)%bottom_rcv_buffer,              &
( 4065)                                           CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4066)                                           depth, CELL_DATA,                             &
( 4067)                                           bottom_top_offset(FIELD_PRESSURE))
( 4068)     ENDIF
( 4069)   ENDIF
( 4070)   IF(fields(FIELD_VISCOSITY).EQ.1) THEN
( 4071)     IF(use_fortran_kernels) THEN
( 4072)       CALL clover_unpack_message_bottom(chunks(chunk)%field%x_min,                    &
( 4073)                                         chunks(chunk)%field%x_max,                    &
( 4074)                                         chunks(chunk)%field%y_min,                    &
( 4075)                                         chunks(chunk)%field%y_max,                    &
( 4076)                                         chunks(chunk)%field%z_min,                    &
( 4077)                                         chunks(chunk)%field%z_max,                    &
( 4078)                                         chunks(chunk)%field%viscosity,                &
( 4079)                                         chunks(chunk)%bottom_rcv_buffer,              &
( 4080)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4081)                                         depth, CELL_DATA,                             &
( 4082)                                         bottom_top_offset(FIELD_VISCOSITY))
( 4083)     ELSE
( 4084)       CALL clover_unpack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 4085)                                           chunks(chunk)%field%x_max,                    &
( 4086)                                           chunks(chunk)%field%y_min,                    &
( 4087)                                           chunks(chunk)%field%y_max,                    &
( 4088)                                           chunks(chunk)%field%viscosity,                &
( 4089)                                           chunks(chunk)%bottom_rcv_buffer,              &
( 4090)                                           CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4091)                                           depth, CELL_DATA,                             &
( 4092)                                           bottom_top_offset(FIELD_VISCOSITY))
( 4093)     ENDIF
( 4094)   ENDIF
( 4095)   IF(fields(FIELD_SOUNDSPEED).EQ.1) THEN
( 4096)     IF(use_fortran_kernels) THEN
( 4097)       CALL clover_unpack_message_bottom(chunks(chunk)%field%x_min,                    &
( 4098)                                         chunks(chunk)%field%x_max,                    &
( 4099)                                         chunks(chunk)%field%y_min,                    &
( 4100)                                         chunks(chunk)%field%y_max,                    &
( 4101)                                         chunks(chunk)%field%z_min,                    &
( 4102)                                         chunks(chunk)%field%z_max,                    &
( 4103)                                         chunks(chunk)%field%soundspeed,               &
( 4104)                                         chunks(chunk)%bottom_rcv_buffer,              &
( 4105)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4106)                                         depth, CELL_DATA,                             &
( 4107)                                         bottom_top_offset(FIELD_SOUNDSPEED))
( 4108)     ELSE
( 4109)       CALL clover_unpack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 4110)                                           chunks(chunk)%field%x_max,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 72

( 4111)                                           chunks(chunk)%field%y_min,                    &
( 4112)                                           chunks(chunk)%field%y_max,                    &
( 4113)                                           chunks(chunk)%field%soundspeed,               &
( 4114)                                           chunks(chunk)%bottom_rcv_buffer,              &
( 4115)                                           CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4116)                                           depth, CELL_DATA,                             &
( 4117)                                           bottom_top_offset(FIELD_SOUNDSPEED))
( 4118)     ENDIF
( 4119)   ENDIF
( 4120)   IF(fields(FIELD_XVEL0).EQ.1) THEN
( 4121)     IF(use_fortran_kernels) THEN
( 4122)       CALL clover_unpack_message_bottom(chunks(chunk)%field%x_min,                    &
( 4123)                                         chunks(chunk)%field%x_max,                    &
( 4124)                                         chunks(chunk)%field%y_min,                    &
( 4125)                                         chunks(chunk)%field%y_max,                    &
( 4126)                                         chunks(chunk)%field%z_min,                    &
( 4127)                                         chunks(chunk)%field%z_max,                    &
( 4128)                                         chunks(chunk)%field%xvel0,                    &
( 4129)                                         chunks(chunk)%bottom_rcv_buffer,              &
( 4130)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4131)                                         depth, VERTEX_DATA,                           &
( 4132)                                         bottom_top_offset(FIELD_XVEL0))
( 4133)     ELSE
( 4134)       CALL clover_unpack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 4135)                                           chunks(chunk)%field%x_max,                    &
( 4136)                                           chunks(chunk)%field%y_min,                    &
( 4137)                                           chunks(chunk)%field%y_max,                    &
( 4138)                                           chunks(chunk)%field%xvel0,                    &
( 4139)                                           chunks(chunk)%bottom_rcv_buffer,              &
( 4140)                                           CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4141)                                           depth, VERTEX_DATA,                           &
( 4142)                                           bottom_top_offset(FIELD_XVEL0))
( 4143)     ENDIF
( 4144)   ENDIF
( 4145)   IF(fields(FIELD_XVEL1).EQ.1) THEN
( 4146)     IF(use_fortran_kernels) THEN
( 4147)       CALL clover_unpack_message_bottom(chunks(chunk)%field%x_min,                    &
( 4148)                                         chunks(chunk)%field%x_max,                    &
( 4149)                                         chunks(chunk)%field%y_min,                    &
( 4150)                                         chunks(chunk)%field%y_max,                    &
( 4151)                                         chunks(chunk)%field%z_min,                    &
( 4152)                                         chunks(chunk)%field%z_max,                    &
( 4153)                                         chunks(chunk)%field%xvel1,                    &
( 4154)                                         chunks(chunk)%bottom_rcv_buffer,              &
( 4155)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4156)                                         depth, VERTEX_DATA,                           &
( 4157)                                         bottom_top_offset(FIELD_XVEL1))
( 4158)     ELSE
( 4159)       CALL clover_unpack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 4160)                                           chunks(chunk)%field%x_max,                    &
( 4161)                                           chunks(chunk)%field%y_min,                    &
( 4162)                                           chunks(chunk)%field%y_max,                    &
( 4163)                                           chunks(chunk)%field%xvel1,                    &
( 4164)                                           chunks(chunk)%bottom_rcv_buffer,              &
( 4165)                                           CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4166)                                           depth, VERTEX_DATA,                           &
( 4167)                                           bottom_top_offset(FIELD_XVEL1))
( 4168)     ENDIF






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 73

( 4169)   ENDIF
( 4170)   IF(fields(FIELD_YVEL0).EQ.1) THEN
( 4171)     IF(use_fortran_kernels) THEN
( 4172)       CALL clover_unpack_message_bottom(chunks(chunk)%field%x_min,                    &
( 4173)                                         chunks(chunk)%field%x_max,                    &
( 4174)                                         chunks(chunk)%field%y_min,                    &
( 4175)                                         chunks(chunk)%field%y_max,                    &
( 4176)                                         chunks(chunk)%field%z_min,                    &
( 4177)                                         chunks(chunk)%field%z_max,                    &
( 4178)                                         chunks(chunk)%field%yvel0,                    &
( 4179)                                         chunks(chunk)%bottom_rcv_buffer,              &
( 4180)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4181)                                         depth, VERTEX_DATA,                           &
( 4182)                                         bottom_top_offset(FIELD_YVEL0))
( 4183)     ELSE
( 4184)       CALL clover_unpack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 4185)                                           chunks(chunk)%field%x_max,                    &
( 4186)                                           chunks(chunk)%field%y_min,                    &
( 4187)                                           chunks(chunk)%field%y_max,                    &
( 4188)                                           chunks(chunk)%field%yvel0,                    &
( 4189)                                           chunks(chunk)%bottom_rcv_buffer,              &
( 4190)                                           CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4191)                                           depth, VERTEX_DATA,                           &
( 4192)                                           bottom_top_offset(FIELD_YVEL0))
( 4193)     ENDIF
( 4194)   ENDIF
( 4195)   IF(fields(FIELD_YVEL1).EQ.1) THEN
( 4196)     IF(use_fortran_kernels) THEN
( 4197)       CALL clover_unpack_message_bottom(chunks(chunk)%field%x_min,                    &
( 4198)                                         chunks(chunk)%field%x_max,                    &
( 4199)                                         chunks(chunk)%field%y_min,                    &
( 4200)                                         chunks(chunk)%field%y_max,                    &
( 4201)                                         chunks(chunk)%field%z_min,                    &
( 4202)                                         chunks(chunk)%field%z_max,                    &
( 4203)                                         chunks(chunk)%field%yvel1,                    &
( 4204)                                         chunks(chunk)%bottom_rcv_buffer,              &
( 4205)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4206)                                         depth, VERTEX_DATA,                           &
( 4207)                                         bottom_top_offset(FIELD_YVEL1))
( 4208)     ELSE
( 4209)       CALL clover_unpack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 4210)                                           chunks(chunk)%field%x_max,                    &
( 4211)                                           chunks(chunk)%field%y_min,                    &
( 4212)                                           chunks(chunk)%field%y_max,                    &
( 4213)                                           chunks(chunk)%field%yvel1,                    &
( 4214)                                           chunks(chunk)%bottom_rcv_buffer,              &
( 4215)                                           CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4216)                                           depth, VERTEX_DATA,                           &
( 4217)                                           bottom_top_offset(FIELD_YVEL1))
( 4218)     ENDIF
( 4219)   ENDIF
( 4220)   IF(fields(FIELD_ZVEL0).EQ.1) THEN
( 4221)     IF(use_fortran_kernels) THEN
( 4222)       CALL clover_unpack_message_bottom(chunks(chunk)%field%x_min,                    &
( 4223)                                         chunks(chunk)%field%x_max,                    &
( 4224)                                         chunks(chunk)%field%y_min,                    &
( 4225)                                         chunks(chunk)%field%y_max,                    &
( 4226)                                         chunks(chunk)%field%z_min,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 74

( 4227)                                         chunks(chunk)%field%z_max,                    &
( 4228)                                         chunks(chunk)%field%zvel0,                    &
( 4229)                                         chunks(chunk)%bottom_rcv_buffer,              &
( 4230)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4231)                                         depth, VERTEX_DATA,                           &
( 4232)                                         bottom_top_offset(FIELD_ZVEL0))
( 4233)     ELSE
( 4234)       CALL clover_unpack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 4235)                                           chunks(chunk)%field%x_max,                    &
( 4236)                                           chunks(chunk)%field%y_min,                    &
( 4237)                                           chunks(chunk)%field%y_max,                    &
( 4238)                                           chunks(chunk)%field%zvel0,                    &
( 4239)                                           chunks(chunk)%bottom_rcv_buffer,              &
( 4240)                                           CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4241)                                           depth, VERTEX_DATA,                           &
( 4242)                                           bottom_top_offset(FIELD_ZVEL0))
( 4243)     ENDIF
( 4244)   ENDIF
( 4245)   IF(fields(FIELD_ZVEL1).EQ.1) THEN
( 4246)     IF(use_fortran_kernels) THEN
( 4247)       CALL clover_unpack_message_bottom(chunks(chunk)%field%x_min,                    &
( 4248)                                         chunks(chunk)%field%x_max,                    &
( 4249)                                         chunks(chunk)%field%y_min,                    &
( 4250)                                         chunks(chunk)%field%y_max,                    &
( 4251)                                         chunks(chunk)%field%z_min,                    &
( 4252)                                         chunks(chunk)%field%z_max,                    &
( 4253)                                         chunks(chunk)%field%zvel1,                    &
( 4254)                                         chunks(chunk)%bottom_rcv_buffer,              &
( 4255)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4256)                                         depth, VERTEX_DATA,                           &
( 4257)                                         bottom_top_offset(FIELD_ZVEL1))
( 4258)     ELSE
( 4259)       CALL clover_unpack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 4260)                                           chunks(chunk)%field%x_max,                    &
( 4261)                                           chunks(chunk)%field%y_min,                    &
( 4262)                                           chunks(chunk)%field%y_max,                    &
( 4263)                                           chunks(chunk)%field%zvel1,                    &
( 4264)                                           chunks(chunk)%bottom_rcv_buffer,              &
( 4265)                                           CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4266)                                           depth, VERTEX_DATA,                           &
( 4267)                                           bottom_top_offset(FIELD_ZVEL1))
( 4268)     ENDIF
( 4269)   ENDIF
( 4270)   IF(fields(FIELD_VOL_FLUX_X).EQ.1) THEN
( 4271)     IF(use_fortran_kernels) THEN
( 4272)       CALL clover_unpack_message_bottom(chunks(chunk)%field%x_min,                    &
( 4273)                                         chunks(chunk)%field%x_max,                    &
( 4274)                                         chunks(chunk)%field%y_min,                    &
( 4275)                                         chunks(chunk)%field%y_max,                    &
( 4276)                                         chunks(chunk)%field%z_min,                    &
( 4277)                                         chunks(chunk)%field%z_max,                    &
( 4278)                                         chunks(chunk)%field%vol_flux_x,               &
( 4279)                                         chunks(chunk)%bottom_rcv_buffer,              &
( 4280)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4281)                                         depth, X_FACE_DATA,                           &
( 4282)                                         bottom_top_offset(FIELD_VOL_FLUX_X))
( 4283)     ELSE
( 4284)       CALL clover_unpack_message_bottom_c(chunks(chunk)%field%x_min,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 75

( 4285)                                           chunks(chunk)%field%x_max,                    &
( 4286)                                           chunks(chunk)%field%y_min,                    &
( 4287)                                           chunks(chunk)%field%y_max,                    &
( 4288)                                           chunks(chunk)%field%vol_flux_x,               &
( 4289)                                           chunks(chunk)%bottom_rcv_buffer,              &
( 4290)                                           CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4291)                                           depth, X_FACE_DATA,                           &
( 4292)                                           bottom_top_offset(FIELD_VOL_FLUX_X))
( 4293)     ENDIF
( 4294)   ENDIF
( 4295)   IF(fields(FIELD_VOL_FLUX_Y).EQ.1) THEN
( 4296)     IF(use_fortran_kernels) THEN
( 4297)       CALL clover_unpack_message_bottom(chunks(chunk)%field%x_min,                    &
( 4298)                                         chunks(chunk)%field%x_max,                    &
( 4299)                                         chunks(chunk)%field%y_min,                    &
( 4300)                                         chunks(chunk)%field%y_max,                    &
( 4301)                                         chunks(chunk)%field%z_min,                    &
( 4302)                                         chunks(chunk)%field%z_max,                    &
( 4303)                                         chunks(chunk)%field%vol_flux_y,               &
( 4304)                                         chunks(chunk)%bottom_rcv_buffer,              &
( 4305)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4306)                                         depth, Y_FACE_DATA,                           &
( 4307)                                         bottom_top_offset(FIELD_VOL_FLUX_Y))
( 4308)     ELSE
( 4309)       CALL clover_unpack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 4310)                                           chunks(chunk)%field%x_max,                    &
( 4311)                                           chunks(chunk)%field%y_min,                    &
( 4312)                                           chunks(chunk)%field%y_max,                    &
( 4313)                                           chunks(chunk)%field%vol_flux_y,               &
( 4314)                                           chunks(chunk)%bottom_rcv_buffer,              &
( 4315)                                           CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4316)                                           depth, Y_FACE_DATA,                           &
( 4317)                                           bottom_top_offset(FIELD_VOL_FLUX_Y))
( 4318)     ENDIF
( 4319)   ENDIF
( 4320)   IF(fields(FIELD_VOL_FLUX_Z).EQ.1) THEN
( 4321)     IF(use_fortran_kernels) THEN
( 4322)       CALL clover_unpack_message_bottom(chunks(chunk)%field%x_min,                    &
( 4323)                                         chunks(chunk)%field%x_max,                    &
( 4324)                                         chunks(chunk)%field%y_min,                    &
( 4325)                                         chunks(chunk)%field%y_max,                    &
( 4326)                                         chunks(chunk)%field%z_min,                    &
( 4327)                                         chunks(chunk)%field%z_max,                    &
( 4328)                                         chunks(chunk)%field%vol_flux_z,               &
( 4329)                                         chunks(chunk)%bottom_rcv_buffer,              &
( 4330)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4331)                                         depth, Z_FACE_DATA,                           &
( 4332)                                         bottom_top_offset(FIELD_VOL_FLUX_Z))
( 4333)     ELSE
( 4334)       CALL clover_unpack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 4335)                                           chunks(chunk)%field%x_max,                    &
( 4336)                                           chunks(chunk)%field%y_min,                    &
( 4337)                                           chunks(chunk)%field%y_max,                    &
( 4338)                                           chunks(chunk)%field%vol_flux_z,               &
( 4339)                                           chunks(chunk)%bottom_rcv_buffer,              &
( 4340)                                           CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4341)                                           depth, Z_FACE_DATA,                           &
( 4342)                                           bottom_top_offset(FIELD_VOL_FLUX_Z))






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 76

( 4343)     ENDIF
( 4344)   ENDIF
( 4345)   IF(fields(FIELD_MASS_FLUX_X).EQ.1) THEN
( 4346)     IF(use_fortran_kernels) THEN
( 4347)       CALL clover_unpack_message_bottom(chunks(chunk)%field%x_min,                    &
( 4348)                                         chunks(chunk)%field%x_max,                    &
( 4349)                                         chunks(chunk)%field%y_min,                    &
( 4350)                                         chunks(chunk)%field%y_max,                    &
( 4351)                                         chunks(chunk)%field%z_min,                    &
( 4352)                                         chunks(chunk)%field%z_max,                    &
( 4353)                                         chunks(chunk)%field%mass_flux_x,              &
( 4354)                                         chunks(chunk)%bottom_rcv_buffer,              &
( 4355)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4356)                                         depth, X_FACE_DATA,                           &
( 4357)                                         bottom_top_offset(FIELD_MASS_FLUX_X))
( 4358)     ELSE
( 4359)       CALL clover_unpack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 4360)                                           chunks(chunk)%field%x_max,                    &
( 4361)                                           chunks(chunk)%field%y_min,                    &
( 4362)                                           chunks(chunk)%field%y_max,                    &
( 4363)                                           chunks(chunk)%field%mass_flux_x,              &
( 4364)                                           chunks(chunk)%bottom_rcv_buffer,              &
( 4365)                                           CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4366)                                           depth, X_FACE_DATA,                           &
( 4367)                                           bottom_top_offset(FIELD_MASS_FLUX_X))
( 4368)     ENDIF
( 4369)   ENDIF
( 4370)   IF(fields(FIELD_MASS_FLUX_Y).EQ.1) THEN
( 4371)     IF(use_fortran_kernels) THEN
( 4372)       CALL clover_unpack_message_bottom(chunks(chunk)%field%x_min,                    &
( 4373)                                         chunks(chunk)%field%x_max,                    &
( 4374)                                         chunks(chunk)%field%y_min,                    &
( 4375)                                         chunks(chunk)%field%y_max,                    &
( 4376)                                         chunks(chunk)%field%z_min,                    &
( 4377)                                         chunks(chunk)%field%z_max,                    &
( 4378)                                         chunks(chunk)%field%mass_flux_y,              &
( 4379)                                         chunks(chunk)%bottom_rcv_buffer,              &
( 4380)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4381)                                         depth, Y_FACE_DATA,                           &
( 4382)                                         bottom_top_offset(FIELD_MASS_FLUX_Y))
( 4383)     ELSE
( 4384)       CALL clover_unpack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 4385)                                           chunks(chunk)%field%x_max,                    &
( 4386)                                           chunks(chunk)%field%y_min,                    &
( 4387)                                           chunks(chunk)%field%y_max,                    &
( 4388)                                           chunks(chunk)%field%mass_flux_y,              &
( 4389)                                           chunks(chunk)%bottom_rcv_buffer,              &
( 4390)                                           CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4391)                                           depth, Y_FACE_DATA,                           &
( 4392)                                           bottom_top_offset(FIELD_MASS_FLUX_Y))
( 4393)     ENDIF
( 4394)   ENDIF
( 4395)   IF(fields(FIELD_MASS_FLUX_Z).EQ.1) THEN
( 4396)     IF(use_fortran_kernels) THEN
( 4397)       CALL clover_unpack_message_bottom(chunks(chunk)%field%x_min,                    &
( 4398)                                         chunks(chunk)%field%x_max,                    &
( 4399)                                         chunks(chunk)%field%y_min,                    &
( 4400)                                         chunks(chunk)%field%y_max,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 77

( 4401)                                         chunks(chunk)%field%z_min,                    &
( 4402)                                         chunks(chunk)%field%z_max,                    &
( 4403)                                         chunks(chunk)%field%mass_flux_z,              &
( 4404)                                         chunks(chunk)%bottom_rcv_buffer,              &
( 4405)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4406)                                         depth, Z_FACE_DATA,                           &
( 4407)                                         bottom_top_offset(FIELD_MASS_FLUX_Z))
( 4408)     ELSE
( 4409)       CALL clover_unpack_message_bottom_c(chunks(chunk)%field%x_min,                    &
( 4410)                                           chunks(chunk)%field%x_max,                    &
( 4411)                                           chunks(chunk)%field%y_min,                    &
( 4412)                                           chunks(chunk)%field%y_max,                    &
( 4413)                                           chunks(chunk)%field%mass_flux_z,              &
( 4414)                                           chunks(chunk)%bottom_rcv_buffer,              &
( 4415)                                           CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4416)                                           depth, Z_FACE_DATA,                           &
( 4417)                                           bottom_top_offset(FIELD_MASS_FLUX_Z))
( 4418)     ENDIF
( 4419)   ENDIF
( 4420) END SUBROUTINE clover_unpack_bottom
( 4421) 
( 4422) SUBROUTINE clover_pack_back(chunk, fields, depth, back_front_offset)
( 4423) 
( 4424)   USE pack_kernel_module
( 4425) 
( 4426)   IMPLICIT NONE
( 4427) 
( 4428)   INTEGER        :: chunk, fields(:), depth, back_front_offset(:)
( 4429) 
( 4430)   IF(fields(FIELD_DENSITY0).EQ.1) THEN
( 4431)     IF(use_fortran_kernels) THEN
( 4432)       CALL clover_pack_message_back(chunks(chunk)%field%x_min,                    &
( 4433)                                     chunks(chunk)%field%x_max,                    &
( 4434)                                     chunks(chunk)%field%y_min,                    &
( 4435)                                     chunks(chunk)%field%y_max,                    &
( 4436)                                     chunks(chunk)%field%z_min,                    &
( 4437)                                     chunks(chunk)%field%z_max,                    &
( 4438)                                     chunks(chunk)%field%density0,                 &
( 4439)                                     chunks(chunk)%back_snd_buffer,                &
( 4440)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4441)                                     depth, CELL_DATA,                             &
( 4442)                                     back_front_offset(FIELD_DENSITY0))
( 4443)     ELSE
( 4444)       CALL clover_pack_message_back_c(chunks(chunk)%field%x_min,                    &
( 4445)                                       chunks(chunk)%field%x_max,                    &
( 4446)                                       chunks(chunk)%field%y_min,                    &
( 4447)                                       chunks(chunk)%field%y_max,                    &
( 4448)                                       chunks(chunk)%field%density0,                 &
( 4449)                                       chunks(chunk)%back_snd_buffer,                &
( 4450)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4451)                                       depth, CELL_DATA,                             &
( 4452)                                       back_front_offset(FIELD_DENSITY0))
( 4453)     ENDIF
( 4454)   ENDIF
( 4455)   IF(fields(FIELD_DENSITY1).EQ.1) THEN
( 4456)     IF(use_fortran_kernels) THEN
( 4457)       CALL clover_pack_message_back(chunks(chunk)%field%x_min,                    &
( 4458)                                     chunks(chunk)%field%x_max,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 78

( 4459)                                     chunks(chunk)%field%y_min,                    &
( 4460)                                     chunks(chunk)%field%y_max,                    &
( 4461)                                     chunks(chunk)%field%z_min,                    &
( 4462)                                     chunks(chunk)%field%z_max,                    &
( 4463)                                     chunks(chunk)%field%density1,                 &
( 4464)                                     chunks(chunk)%back_snd_buffer,                &
( 4465)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4466)                                     depth, CELL_DATA,                             &
( 4467)                                     back_front_offset(FIELD_DENSITY1))
( 4468)     ELSE
( 4469)       CALL clover_pack_message_back_c(chunks(chunk)%field%x_min,                    &
( 4470)                                       chunks(chunk)%field%x_max,                    &
( 4471)                                       chunks(chunk)%field%y_min,                    &
( 4472)                                       chunks(chunk)%field%y_max,                    &
( 4473)                                       chunks(chunk)%field%density1,                 &
( 4474)                                       chunks(chunk)%back_snd_buffer,                &
( 4475)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4476)                                       depth, CELL_DATA,                             &
( 4477)                                       back_front_offset(FIELD_DENSITY1))
( 4478)     ENDIF
( 4479)   ENDIF
( 4480)   IF(fields(FIELD_ENERGY0).EQ.1) THEN
( 4481)     IF(use_fortran_kernels) THEN
( 4482)       CALL clover_pack_message_back(chunks(chunk)%field%x_min,                    &
( 4483)                                     chunks(chunk)%field%x_max,                    &
( 4484)                                     chunks(chunk)%field%y_min,                    &
( 4485)                                     chunks(chunk)%field%y_max,                    &
( 4486)                                     chunks(chunk)%field%z_min,                    &
( 4487)                                     chunks(chunk)%field%z_max,                    &
( 4488)                                     chunks(chunk)%field%energy0,                  &
( 4489)                                     chunks(chunk)%back_snd_buffer,                &
( 4490)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4491)                                     depth, CELL_DATA,                             &
( 4492)                                     back_front_offset(FIELD_ENERGY0))
( 4493)     ELSE
( 4494)       CALL clover_pack_message_back_c(chunks(chunk)%field%x_min,                    &
( 4495)                                       chunks(chunk)%field%x_max,                    &
( 4496)                                       chunks(chunk)%field%y_min,                    &
( 4497)                                       chunks(chunk)%field%y_max,                    &
( 4498)                                       chunks(chunk)%field%energy0,                  &
( 4499)                                       chunks(chunk)%back_snd_buffer,                &
( 4500)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4501)                                       depth, CELL_DATA,                             &
( 4502)                                       back_front_offset(FIELD_ENERGY0))
( 4503)     ENDIF
( 4504)   ENDIF
( 4505)   IF(fields(FIELD_ENERGY1).EQ.1) THEN
( 4506)     IF(use_fortran_kernels) THEN
( 4507)       CALL clover_pack_message_back(chunks(chunk)%field%x_min,                    &
( 4508)                                     chunks(chunk)%field%x_max,                    &
( 4509)                                     chunks(chunk)%field%y_min,                    &
( 4510)                                     chunks(chunk)%field%y_max,                    &
( 4511)                                     chunks(chunk)%field%z_min,                    &
( 4512)                                     chunks(chunk)%field%z_max,                    &
( 4513)                                     chunks(chunk)%field%energy1,                  &
( 4514)                                     chunks(chunk)%back_snd_buffer,                &
( 4515)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4516)                                     depth, CELL_DATA,                             &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 79

( 4517)                                     back_front_offset(FIELD_ENERGY1))
( 4518)     ELSE
( 4519)       CALL clover_pack_message_back_c(chunks(chunk)%field%x_min,                    &
( 4520)                                       chunks(chunk)%field%x_max,                    &
( 4521)                                       chunks(chunk)%field%y_min,                    &
( 4522)                                       chunks(chunk)%field%y_max,                    &
( 4523)                                       chunks(chunk)%field%energy1,                  &
( 4524)                                       chunks(chunk)%back_snd_buffer,                &
( 4525)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4526)                                       depth, CELL_DATA,                             &
( 4527)                                       back_front_offset(FIELD_ENERGY1))
( 4528)     ENDIF
( 4529)   ENDIF
( 4530)   IF(fields(FIELD_PRESSURE).EQ.1) THEN
( 4531)     IF(use_fortran_kernels) THEN
( 4532)       CALL clover_pack_message_back(chunks(chunk)%field%x_min,                    &
( 4533)                                     chunks(chunk)%field%x_max,                    &
( 4534)                                     chunks(chunk)%field%y_min,                    &
( 4535)                                     chunks(chunk)%field%y_max,                    &
( 4536)                                     chunks(chunk)%field%z_min,                    &
( 4537)                                     chunks(chunk)%field%z_max,                    &
( 4538)                                     chunks(chunk)%field%pressure,                 &
( 4539)                                     chunks(chunk)%back_snd_buffer,                &
( 4540)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4541)                                     depth, CELL_DATA,                             &
( 4542)                                     back_front_offset(FIELD_PRESSURE))
( 4543)     ELSE
( 4544)       CALL clover_pack_message_back_c(chunks(chunk)%field%x_min,                    &
( 4545)                                       chunks(chunk)%field%x_max,                    &
( 4546)                                       chunks(chunk)%field%y_min,                    &
( 4547)                                       chunks(chunk)%field%y_max,                    &
( 4548)                                       chunks(chunk)%field%pressure,                 &
( 4549)                                       chunks(chunk)%back_snd_buffer,                &
( 4550)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4551)                                       depth, CELL_DATA,                             &
( 4552)                                       back_front_offset(FIELD_PRESSURE))
( 4553)     ENDIF
( 4554)   ENDIF
( 4555)   IF(fields(FIELD_VISCOSITY).EQ.1) THEN
( 4556)     IF(use_fortran_kernels) THEN
( 4557)       CALL clover_pack_message_back(chunks(chunk)%field%x_min,                    &
( 4558)                                     chunks(chunk)%field%x_max,                    &
( 4559)                                     chunks(chunk)%field%y_min,                    &
( 4560)                                     chunks(chunk)%field%y_max,                    &
( 4561)                                     chunks(chunk)%field%z_min,                    &
( 4562)                                     chunks(chunk)%field%z_max,                    &
( 4563)                                     chunks(chunk)%field%viscosity,                &
( 4564)                                     chunks(chunk)%back_snd_buffer,                &
( 4565)                                    CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4566)                                     depth, CELL_DATA,                             &
( 4567)                                     back_front_offset(FIELD_VISCOSITY))
( 4568)     ELSE
( 4569)       CALL clover_pack_message_back_c(chunks(chunk)%field%x_min,                    &
( 4570)                                       chunks(chunk)%field%x_max,                    &
( 4571)                                       chunks(chunk)%field%y_min,                    &
( 4572)                                       chunks(chunk)%field%y_max,                    &
( 4573)                                       chunks(chunk)%field%viscosity,                &
( 4574)                                       chunks(chunk)%back_snd_buffer,                &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 80

( 4575)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4576)                                       depth, CELL_DATA,                             &
( 4577)                                       back_front_offset(FIELD_VISCOSITY))
( 4578)     ENDIF
( 4579)   ENDIF
( 4580)   IF(fields(FIELD_SOUNDSPEED).EQ.1) THEN
( 4581)     IF(use_fortran_kernels) THEN
( 4582)       CALL clover_pack_message_back(chunks(chunk)%field%x_min,                    &
( 4583)                                     chunks(chunk)%field%x_max,                    &
( 4584)                                     chunks(chunk)%field%y_min,                    &
( 4585)                                     chunks(chunk)%field%y_max,                    &
( 4586)                                     chunks(chunk)%field%z_min,                    &
( 4587)                                     chunks(chunk)%field%z_max,                    &
( 4588)                                     chunks(chunk)%field%soundspeed,               &
( 4589)                                     chunks(chunk)%back_snd_buffer,                &
( 4590)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4591)                                     depth, CELL_DATA,                             &
( 4592)                                     back_front_offset(FIELD_SOUNDSPEED))
( 4593)     ELSE
( 4594)       CALL clover_pack_message_back_c(chunks(chunk)%field%x_min,                    &
( 4595)                                       chunks(chunk)%field%x_max,                    &
( 4596)                                       chunks(chunk)%field%y_min,                    &
( 4597)                                       chunks(chunk)%field%y_max,                    &
( 4598)                                       chunks(chunk)%field%soundspeed,               &
( 4599)                                       chunks(chunk)%back_snd_buffer,                &
( 4600)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4601)                                       depth, CELL_DATA,                             &
( 4602)                                       back_front_offset(FIELD_SOUNDSPEED))
( 4603)     ENDIF
( 4604)   ENDIF
( 4605)   IF(fields(FIELD_XVEL0).EQ.1) THEN
( 4606)     IF(use_fortran_kernels) THEN
( 4607)       CALL clover_pack_message_back(chunks(chunk)%field%x_min,                    &
( 4608)                                     chunks(chunk)%field%x_max,                    &
( 4609)                                     chunks(chunk)%field%y_min,                    &
( 4610)                                     chunks(chunk)%field%y_max,                    &
( 4611)                                     chunks(chunk)%field%z_min,                    &
( 4612)                                     chunks(chunk)%field%z_max,                    &
( 4613)                                     chunks(chunk)%field%xvel0,                    &
( 4614)                                     chunks(chunk)%back_snd_buffer,                &
( 4615)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4616)                                     depth, VERTEX_DATA,                           &
( 4617)                                     back_front_offset(FIELD_XVEL0))
( 4618)     ELSE
( 4619)       CALL clover_pack_message_back_c(chunks(chunk)%field%x_min,                    &
( 4620)                                       chunks(chunk)%field%x_max,                    &
( 4621)                                       chunks(chunk)%field%y_min,                    &
( 4622)                                       chunks(chunk)%field%y_max,                    &
( 4623)                                       chunks(chunk)%field%xvel0,                    &
( 4624)                                       chunks(chunk)%back_snd_buffer,                &
( 4625)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4626)                                       depth, VERTEX_DATA,                           &
( 4627)                                       back_front_offset(FIELD_XVEL0))
( 4628)     ENDIF 
( 4629)   ENDIF
( 4630)   IF(fields(FIELD_XVEL1).EQ.1) THEN
( 4631)     IF(use_fortran_kernels) THEN
( 4632)       CALL clover_pack_message_back(chunks(chunk)%field%x_min,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 81

( 4633)                                     chunks(chunk)%field%x_max,                    &
( 4634)                                     chunks(chunk)%field%y_min,                    &
( 4635)                                     chunks(chunk)%field%y_max,                    &
( 4636)                                     chunks(chunk)%field%z_min,                    &
( 4637)                                     chunks(chunk)%field%z_max,                    &
( 4638)                                     chunks(chunk)%field%xvel1,                    &
( 4639)                                     chunks(chunk)%back_snd_buffer,                &
( 4640)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4641)                                     depth, VERTEX_DATA,                           &
( 4642)                                     back_front_offset(FIELD_XVEL1))
( 4643)     ELSE
( 4644)       CALL clover_pack_message_back_c(chunks(chunk)%field%x_min,                    &
( 4645)                                       chunks(chunk)%field%x_max,                    &
( 4646)                                       chunks(chunk)%field%y_min,                    &
( 4647)                                       chunks(chunk)%field%y_max,                    &
( 4648)                                       chunks(chunk)%field%xvel1,                    &
( 4649)                                       chunks(chunk)%back_snd_buffer,                &
( 4650)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4651)                                       depth, VERTEX_DATA,                           &
( 4652)                                       back_front_offset(FIELD_XVEL1))
( 4653)     ENDIF
( 4654)   ENDIF
( 4655)   IF(fields(FIELD_YVEL0).EQ.1) THEN
( 4656)     IF(use_fortran_kernels) THEN
( 4657)       CALL clover_pack_message_back(chunks(chunk)%field%x_min,                    &
( 4658)                                     chunks(chunk)%field%x_max,                    &
( 4659)                                     chunks(chunk)%field%y_min,                    &
( 4660)                                     chunks(chunk)%field%y_max,                    &
( 4661)                                     chunks(chunk)%field%z_min,                    &
( 4662)                                     chunks(chunk)%field%z_max,                    &
( 4663)                                     chunks(chunk)%field%yvel0,                    &
( 4664)                                     chunks(chunk)%back_snd_buffer,                &
( 4665)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4666)                                     depth, VERTEX_DATA,                           &
( 4667)                                     back_front_offset(FIELD_YVEL0))
( 4668)     ELSE
( 4669)       CALL clover_pack_message_back_c(chunks(chunk)%field%x_min,                    &
( 4670)                                       chunks(chunk)%field%x_max,                    &
( 4671)                                       chunks(chunk)%field%y_min,                    &
( 4672)                                       chunks(chunk)%field%y_max,                    &
( 4673)                                       chunks(chunk)%field%yvel0,                    &
( 4674)                                       chunks(chunk)%back_snd_buffer,                &
( 4675)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4676)                                       depth, VERTEX_DATA,                           &
( 4677)                                       back_front_offset(FIELD_YVEL0))
( 4678)     ENDIF
( 4679)   ENDIF
( 4680)   IF(fields(FIELD_YVEL1).EQ.1) THEN
( 4681)     IF(use_fortran_kernels) THEN
( 4682)       CALL clover_pack_message_back(chunks(chunk)%field%x_min,                    &
( 4683)                                     chunks(chunk)%field%x_max,                    &
( 4684)                                     chunks(chunk)%field%y_min,                    &
( 4685)                                     chunks(chunk)%field%y_max,                    &
( 4686)                                     chunks(chunk)%field%z_min,                    &
( 4687)                                     chunks(chunk)%field%z_max,                    &
( 4688)                                     chunks(chunk)%field%yvel1,                    &
( 4689)                                     chunks(chunk)%back_snd_buffer,                &
( 4690)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 82

( 4691)                                     depth, VERTEX_DATA,                           &
( 4692)                                     back_front_offset(FIELD_YVEL1))
( 4693)     ELSE
( 4694)       CALL clover_pack_message_back_c(chunks(chunk)%field%x_min,                    &
( 4695)                                       chunks(chunk)%field%x_max,                    &
( 4696)                                       chunks(chunk)%field%y_min,                    &
( 4697)                                       chunks(chunk)%field%y_max,                    &
( 4698)                                       chunks(chunk)%field%yvel1,                    &
( 4699)                                       chunks(chunk)%back_snd_buffer,                &
( 4700)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4701)                                       depth, VERTEX_DATA,                           &
( 4702)                                       back_front_offset(FIELD_YVEL1))
( 4703)     ENDIF
( 4704)   ENDIF
( 4705)   IF(fields(FIELD_ZVEL0).EQ.1) THEN
( 4706)     IF(use_fortran_kernels) THEN
( 4707)       CALL clover_pack_message_back(chunks(chunk)%field%x_min,                    &
( 4708)                                     chunks(chunk)%field%x_max,                    &
( 4709)                                     chunks(chunk)%field%y_min,                    &
( 4710)                                     chunks(chunk)%field%y_max,                    &
( 4711)                                     chunks(chunk)%field%z_min,                    &
( 4712)                                     chunks(chunk)%field%z_max,                    &
( 4713)                                     chunks(chunk)%field%zvel0,                    &
( 4714)                                     chunks(chunk)%back_snd_buffer,                &
( 4715)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4716)                                     depth, VERTEX_DATA,                           &
( 4717)                                     back_front_offset(FIELD_ZVEL0))
( 4718)     ELSE
( 4719)       CALL clover_pack_message_back_c(chunks(chunk)%field%x_min,                    &
( 4720)                                       chunks(chunk)%field%x_max,                    &
( 4721)                                       chunks(chunk)%field%y_min,                    &
( 4722)                                       chunks(chunk)%field%y_max,                    &
( 4723)                                       chunks(chunk)%field%zvel0,                    &
( 4724)                                       chunks(chunk)%back_snd_buffer,                &
( 4725)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4726)                                       depth, VERTEX_DATA,                           &
( 4727)                                       back_front_offset(FIELD_ZVEL0))
( 4728)     ENDIF
( 4729)   ENDIF
( 4730)   IF(fields(FIELD_ZVEL1).EQ.1) THEN
( 4731)     IF(use_fortran_kernels) THEN
( 4732)       CALL clover_pack_message_back(chunks(chunk)%field%x_min,                    &
( 4733)                                     chunks(chunk)%field%x_max,                    &
( 4734)                                     chunks(chunk)%field%y_min,                    &
( 4735)                                     chunks(chunk)%field%y_max,                    &
( 4736)                                     chunks(chunk)%field%z_min,                    &
( 4737)                                     chunks(chunk)%field%z_max,                    &
( 4738)                                     chunks(chunk)%field%zvel1,                    &
( 4739)                                     chunks(chunk)%back_snd_buffer,                &
( 4740)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4741)                                     depth, VERTEX_DATA,                           &
( 4742)                                     back_front_offset(FIELD_ZVEL1))
( 4743)     ELSE
( 4744)       CALL clover_pack_message_back_c(chunks(chunk)%field%x_min,                    &
( 4745)                                       chunks(chunk)%field%x_max,                    &
( 4746)                                       chunks(chunk)%field%y_min,                    &
( 4747)                                       chunks(chunk)%field%y_max,                    &
( 4748)                                       chunks(chunk)%field%zvel1,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 83

( 4749)                                       chunks(chunk)%back_snd_buffer,                &
( 4750)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4751)                                       depth, VERTEX_DATA,                           &
( 4752)                                       back_front_offset(FIELD_ZVEL1))
( 4753)     ENDIF
( 4754)   ENDIF
( 4755)   IF(fields(FIELD_VOL_FLUX_X).EQ.1) THEN
( 4756)     IF(use_fortran_kernels) THEN
( 4757)       CALL clover_pack_message_back(chunks(chunk)%field%x_min,                    &
( 4758)                                     chunks(chunk)%field%x_max,                    &
( 4759)                                     chunks(chunk)%field%y_min,                    &
( 4760)                                     chunks(chunk)%field%y_max,                    &
( 4761)                                     chunks(chunk)%field%z_min,                    &
( 4762)                                     chunks(chunk)%field%z_max,                    &
( 4763)                                     chunks(chunk)%field%vol_flux_x,               &
( 4764)                                     chunks(chunk)%back_snd_buffer,                &
( 4765)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4766)                                     depth, X_FACE_DATA,                           &
( 4767)                                     back_front_offset(FIELD_VOL_FLUX_X))
( 4768)     ELSE
( 4769)       CALL clover_pack_message_back_c(chunks(chunk)%field%x_min,                    &
( 4770)                                       chunks(chunk)%field%x_max,                    &
( 4771)                                       chunks(chunk)%field%y_min,                    &
( 4772)                                       chunks(chunk)%field%y_max,                    &
( 4773)                                       chunks(chunk)%field%vol_flux_x,               &
( 4774)                                       chunks(chunk)%back_snd_buffer,                &
( 4775)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4776)                                       depth, X_FACE_DATA,                           &
( 4777)                                       back_front_offset(FIELD_VOL_FLUX_X))
( 4778)     ENDIF
( 4779)   ENDIF
( 4780)   IF(fields(FIELD_VOL_FLUX_Y).EQ.1) THEN
( 4781)     IF(use_fortran_kernels) THEN
( 4782)       CALL clover_pack_message_back(chunks(chunk)%field%x_min,                    &
( 4783)                                     chunks(chunk)%field%x_max,                    &
( 4784)                                     chunks(chunk)%field%y_min,                    &
( 4785)                                     chunks(chunk)%field%y_max,                    &
( 4786)                                     chunks(chunk)%field%z_min,                    &
( 4787)                                     chunks(chunk)%field%z_max,                    &
( 4788)                                     chunks(chunk)%field%vol_flux_y,               &
( 4789)                                     chunks(chunk)%back_snd_buffer,                &
( 4790)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4791)                                     depth, Y_FACE_DATA,                           &
( 4792)                                     back_front_offset(FIELD_VOL_FLUX_Y))
( 4793)     ELSE
( 4794)       CALL clover_pack_message_back_c(chunks(chunk)%field%x_min,                    &
( 4795)                                       chunks(chunk)%field%x_max,                    &
( 4796)                                       chunks(chunk)%field%y_min,                    &
( 4797)                                       chunks(chunk)%field%y_max,                    &
( 4798)                                       chunks(chunk)%field%vol_flux_y,               &
( 4799)                                       chunks(chunk)%back_snd_buffer,                &
( 4800)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4801)                                       depth, Y_FACE_DATA,                           &
( 4802)                                       back_front_offset(FIELD_VOL_FLUX_Y))
( 4803)     ENDIF
( 4804)   ENDIF
( 4805)   IF(fields(FIELD_VOL_FLUX_Z).EQ.1) THEN
( 4806)     IF(use_fortran_kernels) THEN






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 84

( 4807)       CALL clover_pack_message_back(chunks(chunk)%field%x_min,                    &
( 4808)                                     chunks(chunk)%field%x_max,                    &
( 4809)                                     chunks(chunk)%field%y_min,                    &
( 4810)                                     chunks(chunk)%field%y_max,                    &
( 4811)                                     chunks(chunk)%field%z_min,                    &
( 4812)                                     chunks(chunk)%field%z_max,                    &
( 4813)                                     chunks(chunk)%field%vol_flux_z,               &
( 4814)                                     chunks(chunk)%back_snd_buffer,                &
( 4815)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4816)                                     depth, Z_FACE_DATA,                           &
( 4817)                                     back_front_offset(FIELD_VOL_FLUX_Z))
( 4818)     ELSE
( 4819)       CALL clover_pack_message_back_c(chunks(chunk)%field%x_min,                    &
( 4820)                                       chunks(chunk)%field%x_max,                    &
( 4821)                                       chunks(chunk)%field%y_min,                    &
( 4822)                                       chunks(chunk)%field%y_max,                    &
( 4823)                                       chunks(chunk)%field%vol_flux_z,               &
( 4824)                                       chunks(chunk)%back_snd_buffer,                &
( 4825)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4826)                                       depth, Z_FACE_DATA,                           &
( 4827)                                       back_front_offset(FIELD_VOL_FLUX_Z))
( 4828)     ENDIF
( 4829)   ENDIF
( 4830)   IF(fields(FIELD_MASS_FLUX_X).EQ.1) THEN
( 4831)     IF(use_fortran_kernels) THEN
( 4832)       CALL clover_pack_message_back(chunks(chunk)%field%x_min,                    &
( 4833)                                     chunks(chunk)%field%x_max,                    &
( 4834)                                     chunks(chunk)%field%y_min,                    &
( 4835)                                     chunks(chunk)%field%y_max,                    &
( 4836)                                     chunks(chunk)%field%z_min,                    &
( 4837)                                     chunks(chunk)%field%z_max,                    &
( 4838)                                     chunks(chunk)%field%mass_flux_x,              &
( 4839)                                     chunks(chunk)%back_snd_buffer,                &
( 4840)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4841)                                     depth, X_FACE_DATA,                           &
( 4842)                                     back_front_offset(FIELD_MASS_FLUX_X))
( 4843)     ELSE
( 4844)       CALL clover_pack_message_back_c(chunks(chunk)%field%x_min,                    &
( 4845)                                       chunks(chunk)%field%x_max,                    &
( 4846)                                       chunks(chunk)%field%y_min,                    &
( 4847)                                       chunks(chunk)%field%y_max,                    &
( 4848)                                       chunks(chunk)%field%mass_flux_x,              &
( 4849)                                       chunks(chunk)%back_snd_buffer,                &
( 4850)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4851)                                       depth, X_FACE_DATA,                           &
( 4852)                                       back_front_offset(FIELD_MASS_FLUX_X))
( 4853)     ENDIF
( 4854)   ENDIF
( 4855)   IF(fields(FIELD_MASS_FLUX_Y).EQ.1) THEN
( 4856)     IF(use_fortran_kernels) THEN
( 4857)       CALL clover_pack_message_back(chunks(chunk)%field%x_min,                    &
( 4858)                                     chunks(chunk)%field%x_max,                    &
( 4859)                                     chunks(chunk)%field%y_min,                    &
( 4860)                                     chunks(chunk)%field%y_max,                    &
( 4861)                                     chunks(chunk)%field%z_min,                    &
( 4862)                                     chunks(chunk)%field%z_max,                    &
( 4863)                                     chunks(chunk)%field%mass_flux_y,              &
( 4864)                                     chunks(chunk)%back_snd_buffer,                &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 85

( 4865)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4866)                                     depth, Y_FACE_DATA,                           &
( 4867)                                     back_front_offset(FIELD_MASS_FLUX_Y))
( 4868)     ELSE
( 4869)       CALL clover_pack_message_back_c(chunks(chunk)%field%x_min,                    &
( 4870)                                       chunks(chunk)%field%x_max,                    &
( 4871)                                       chunks(chunk)%field%y_min,                    &
( 4872)                                       chunks(chunk)%field%y_max,                    &
( 4873)                                       chunks(chunk)%field%mass_flux_y,              &
( 4874)                                       chunks(chunk)%back_snd_buffer,                &
( 4875)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4876)                                       depth, Y_FACE_DATA,                           &
( 4877)                                       back_front_offset(FIELD_MASS_FLUX_Y))
( 4878)     ENDIF
( 4879)   ENDIF
( 4880)   IF(fields(FIELD_MASS_FLUX_Z).EQ.1) THEN
( 4881)     IF(use_fortran_kernels) THEN
( 4882)       CALL clover_pack_message_back(chunks(chunk)%field%x_min,                    &
( 4883)                                     chunks(chunk)%field%x_max,                    &
( 4884)                                     chunks(chunk)%field%y_min,                    &
( 4885)                                     chunks(chunk)%field%y_max,                    &
( 4886)                                     chunks(chunk)%field%z_min,                    &
( 4887)                                     chunks(chunk)%field%z_max,                    &
( 4888)                                     chunks(chunk)%field%mass_flux_z,              &
( 4889)                                     chunks(chunk)%back_snd_buffer,                &
( 4890)                                     CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4891)                                     depth, Z_FACE_DATA,                           &
( 4892)                                     back_front_offset(FIELD_MASS_FLUX_Z))
( 4893)     ELSE
( 4894)       CALL clover_pack_message_back_c(chunks(chunk)%field%x_min,                    &
( 4895)                                       chunks(chunk)%field%x_max,                    &
( 4896)                                       chunks(chunk)%field%y_min,                    &
( 4897)                                       chunks(chunk)%field%y_max,                    &
( 4898)                                       chunks(chunk)%field%mass_flux_z,              &
( 4899)                                       chunks(chunk)%back_snd_buffer,                &
( 4900)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4901)                                       depth, Z_FACE_DATA,                           &
( 4902)                                       back_front_offset(FIELD_MASS_FLUX_Z))
( 4903)     ENDIF
( 4904)   ENDIF
( 4905) END SUBROUTINE clover_pack_back
( 4906) 
( 4907) SUBROUTINE clover_send_recv_message_back(back_snd_buffer, back_rcv_buffer,     &
( 4908)                                          chunk, total_size,                  &
( 4909)                                          tag_send, tag_recv,                 &
( 4910)                                          req_send, req_recv)
( 4911) 
( 4912)   IMPLICIT NONE
( 4913) 
( 4914)   REAL(KIND=8) :: back_snd_buffer(:), back_rcv_buffer(:)
( 4915)   INTEGER      :: back_task
( 4916)   INTEGER      :: chunk
( 4917)   INTEGER      :: total_size, tag_send, tag_recv, err
( 4918)   INTEGER      :: req_send, req_recv
( 4919) 
( 4920)   back_task=chunks(chunk)%chunk_neighbours(chunk_back)-1
( 4921) 
( 4922)   CALL MPI_ISEND(back_snd_buffer,total_size,MPI_DOUBLE_PRECISION,back_task,tag_send, &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 86

( 4923)                  MPI_COMM_WORLD,req_send,err)
( 4924) 
( 4925)   CALL MPI_IRECV(back_rcv_buffer,total_size,MPI_DOUBLE_PRECISION,back_task,tag_recv, &
( 4926)                  MPI_COMM_WORLD,req_recv,err)
( 4927) 
( 4928) END SUBROUTINE clover_send_recv_message_back
( 4929) 
( 4930) SUBROUTINE clover_unpack_back(fields, chunk, depth,                        &
( 4931)                               back_rcv_buffer,                             &
( 4932)                               back_front_offset)
( 4933) 
( 4934)   USE pack_kernel_module
( 4935) 
( 4936)   IMPLICIT NONE
( 4937) 
( 4938)   INTEGER         :: fields(:), chunk, depth, back_front_offset(:)
( 4939)   REAL(KIND=8)    :: back_rcv_buffer(:)
( 4940) 
( 4941)   IF(fields(FIELD_DENSITY0).EQ.1) THEN
( 4942)     IF(use_fortran_kernels) THEN
( 4943)       CALL clover_unpack_message_back(chunks(chunk)%field%x_min,                    &
( 4944)                                       chunks(chunk)%field%x_max,                    &
( 4945)                                       chunks(chunk)%field%y_min,                    &
( 4946)                                       chunks(chunk)%field%y_max,                    &
( 4947)                                       chunks(chunk)%field%z_min,                    &
( 4948)                                       chunks(chunk)%field%z_max,                    &
( 4949)                                       chunks(chunk)%field%density0,                 &
( 4950)                                       chunks(chunk)%back_rcv_buffer,                &
( 4951)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4952)                                       depth, CELL_DATA,                             &
( 4953)                                       back_front_offset(FIELD_DENSITY0))
( 4954)     ELSE
( 4955)       CALL clover_unpack_message_back_c(chunks(chunk)%field%x_min,                    &
( 4956)                                         chunks(chunk)%field%x_max,                    &
( 4957)                                         chunks(chunk)%field%y_min,                    &
( 4958)                                         chunks(chunk)%field%y_max,                    &
( 4959)                                         chunks(chunk)%field%density0,                 &
( 4960)                                         chunks(chunk)%back_rcv_buffer,                &
( 4961)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4962)                                         depth, CELL_DATA,                             &
( 4963)                                         back_front_offset(FIELD_DENSITY0))
( 4964)     ENDIF
( 4965)   ENDIF
( 4966)   IF(fields(FIELD_DENSITY1).EQ.1) THEN
( 4967)     IF(use_fortran_kernels) THEN
( 4968)       CALL clover_unpack_message_back(chunks(chunk)%field%x_min,                    &
( 4969)                                       chunks(chunk)%field%x_max,                    &
( 4970)                                       chunks(chunk)%field%y_min,                    &
( 4971)                                       chunks(chunk)%field%y_max,                    &
( 4972)                                       chunks(chunk)%field%z_min,                    &
( 4973)                                       chunks(chunk)%field%z_max,                    &
( 4974)                                       chunks(chunk)%field%density1,                 &
( 4975)                                       chunks(chunk)%back_rcv_buffer,                &
( 4976)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 4977)                                       depth, CELL_DATA,                             &
( 4978)                                       back_front_offset(FIELD_DENSITY1))
( 4979)     ELSE
( 4980)       CALL clover_unpack_message_back_c(chunks(chunk)%field%x_min,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 87

( 4981)                                         chunks(chunk)%field%x_max,                    &
( 4982)                                         chunks(chunk)%field%y_min,                    &
( 4983)                                         chunks(chunk)%field%y_max,                    &
( 4984)                                         chunks(chunk)%field%density1,                 &
( 4985)                                         chunks(chunk)%back_rcv_buffer,                &
( 4986)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 4987)                                         depth, CELL_DATA,                             &
( 4988)                                         back_front_offset(FIELD_DENSITY1))
( 4989)     ENDIF
( 4990)   ENDIF
( 4991)   IF(fields(FIELD_ENERGY0).EQ.1) THEN
( 4992)     IF(use_fortran_kernels) THEN
( 4993)       CALL clover_unpack_message_back(chunks(chunk)%field%x_min,                    &
( 4994)                                       chunks(chunk)%field%x_max,                    &
( 4995)                                       chunks(chunk)%field%y_min,                    &
( 4996)                                       chunks(chunk)%field%y_max,                    &
( 4997)                                       chunks(chunk)%field%z_min,                    &
( 4998)                                       chunks(chunk)%field%z_max,                    &
( 4999)                                       chunks(chunk)%field%energy0,                  &
( 5000)                                       chunks(chunk)%back_rcv_buffer,                &
( 5001)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5002)                                       depth, CELL_DATA,                             &
( 5003)                                       back_front_offset(FIELD_ENERGY0))
( 5004)     ELSE
( 5005)       CALL clover_unpack_message_back_c(chunks(chunk)%field%x_min,                    &
( 5006)                                         chunks(chunk)%field%x_max,                    &
( 5007)                                         chunks(chunk)%field%y_min,                    &
( 5008)                                         chunks(chunk)%field%y_max,                    &
( 5009)                                         chunks(chunk)%field%energy0,                  &
( 5010)                                         chunks(chunk)%back_rcv_buffer,                &
( 5011)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5012)                                         depth, CELL_DATA,                             &
( 5013)                                         back_front_offset(FIELD_ENERGY0))
( 5014)     ENDIF
( 5015)   ENDIF
( 5016)   IF(fields(FIELD_ENERGY1).EQ.1) THEN
( 5017)     IF(use_fortran_kernels) THEN
( 5018)       CALL clover_unpack_message_back(chunks(chunk)%field%x_min,                    &
( 5019)                                       chunks(chunk)%field%x_max,                    &
( 5020)                                       chunks(chunk)%field%y_min,                    &
( 5021)                                       chunks(chunk)%field%y_max,                    &
( 5022)                                       chunks(chunk)%field%z_min,                    &
( 5023)                                       chunks(chunk)%field%z_max,                    &
( 5024)                                       chunks(chunk)%field%energy1,                  &
( 5025)                                       chunks(chunk)%back_rcv_buffer,                &
( 5026)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5027)                                       depth, CELL_DATA,                             &
( 5028)                                       back_front_offset(FIELD_ENERGY1))
( 5029)     ELSE
( 5030)       CALL clover_unpack_message_back_c(chunks(chunk)%field%x_min,                    &
( 5031)                                         chunks(chunk)%field%x_max,                    &
( 5032)                                         chunks(chunk)%field%y_min,                    &
( 5033)                                         chunks(chunk)%field%y_max,                    &
( 5034)                                         chunks(chunk)%field%energy1,                  &
( 5035)                                         chunks(chunk)%back_rcv_buffer,                &
( 5036)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5037)                                         depth, CELL_DATA,                             &
( 5038)                                         back_front_offset(FIELD_ENERGY1))






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 88

( 5039)     ENDIF
( 5040)   ENDIF
( 5041)   IF(fields(FIELD_PRESSURE).EQ.1) THEN
( 5042)     IF(use_fortran_kernels) THEN
( 5043)       CALL clover_unpack_message_back(chunks(chunk)%field%x_min,                    &
( 5044)                                       chunks(chunk)%field%x_max,                    &
( 5045)                                       chunks(chunk)%field%y_min,                    &
( 5046)                                       chunks(chunk)%field%y_max,                    &
( 5047)                                       chunks(chunk)%field%z_min,                    &
( 5048)                                       chunks(chunk)%field%z_max,                    &
( 5049)                                       chunks(chunk)%field%pressure,                 &
( 5050)                                       chunks(chunk)%back_rcv_buffer,                &
( 5051)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5052)                                       depth, CELL_DATA,                             &
( 5053)                                       back_front_offset(FIELD_PRESSURE))
( 5054)     ELSE
( 5055)       CALL clover_unpack_message_back_c(chunks(chunk)%field%x_min,                    &
( 5056)                                         chunks(chunk)%field%x_max,                    &
( 5057)                                         chunks(chunk)%field%y_min,                    &
( 5058)                                         chunks(chunk)%field%y_max,                    &
( 5059)                                         chunks(chunk)%field%pressure,                 &
( 5060)                                         chunks(chunk)%back_rcv_buffer,                &
( 5061)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5062)                                         depth, CELL_DATA,                             &
( 5063)                                         back_front_offset(FIELD_PRESSURE))
( 5064)     ENDIF
( 5065)   ENDIF
( 5066)   IF(fields(FIELD_VISCOSITY).EQ.1) THEN
( 5067)     IF(use_fortran_kernels) THEN
( 5068)       CALL clover_unpack_message_back(chunks(chunk)%field%x_min,                    &
( 5069)                                       chunks(chunk)%field%x_max,                    &
( 5070)                                       chunks(chunk)%field%y_min,                    &
( 5071)                                       chunks(chunk)%field%y_max,                    &
( 5072)                                       chunks(chunk)%field%z_min,                    &
( 5073)                                       chunks(chunk)%field%z_max,                    &
( 5074)                                       chunks(chunk)%field%viscosity,                &
( 5075)                                       chunks(chunk)%back_rcv_buffer,                &
( 5076)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5077)                                       depth, CELL_DATA,                             &
( 5078)                                       back_front_offset(FIELD_VISCOSITY))
( 5079)     ELSE
( 5080)       CALL clover_unpack_message_back_c(chunks(chunk)%field%x_min,                    &
( 5081)                                         chunks(chunk)%field%x_max,                    &
( 5082)                                         chunks(chunk)%field%y_min,                    &
( 5083)                                         chunks(chunk)%field%y_max,                    &
( 5084)                                         chunks(chunk)%field%viscosity,                &
( 5085)                                         chunks(chunk)%back_rcv_buffer,                &
( 5086)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5087)                                         depth, CELL_DATA,                             &
( 5088)                                         back_front_offset(FIELD_VISCOSITY))
( 5089)     ENDIF
( 5090)   ENDIF
( 5091)   IF(fields(FIELD_SOUNDSPEED).EQ.1) THEN
( 5092)     IF(use_fortran_kernels) THEN
( 5093)       CALL clover_unpack_message_back(chunks(chunk)%field%x_min,                    &
( 5094)                                       chunks(chunk)%field%x_max,                    &
( 5095)                                       chunks(chunk)%field%y_min,                    &
( 5096)                                       chunks(chunk)%field%y_max,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 89

( 5097)                                       chunks(chunk)%field%z_min,                    &
( 5098)                                       chunks(chunk)%field%z_max,                    &
( 5099)                                       chunks(chunk)%field%soundspeed,               &
( 5100)                                       chunks(chunk)%back_rcv_buffer,                &
( 5101)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5102)                                       depth, CELL_DATA,                             &
( 5103)                                       back_front_offset(FIELD_SOUNDSPEED))
( 5104)     ELSE
( 5105)       CALL clover_unpack_message_back_c(chunks(chunk)%field%x_min,                    &
( 5106)                                         chunks(chunk)%field%x_max,                    &
( 5107)                                         chunks(chunk)%field%y_min,                    &
( 5108)                                         chunks(chunk)%field%y_max,                    &
( 5109)                                         chunks(chunk)%field%soundspeed,               &
( 5110)                                         chunks(chunk)%back_rcv_buffer,                &
( 5111)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5112)                                         depth, CELL_DATA,                             &
( 5113)                                         back_front_offset(FIELD_SOUNDSPEED))
( 5114)     ENDIF
( 5115)   ENDIF
( 5116)   IF(fields(FIELD_XVEL0).EQ.1) THEN
( 5117)     IF(use_fortran_kernels) THEN
( 5118)       CALL clover_unpack_message_back(chunks(chunk)%field%x_min,                    &
( 5119)                                       chunks(chunk)%field%x_max,                    &
( 5120)                                       chunks(chunk)%field%y_min,                    &
( 5121)                                       chunks(chunk)%field%y_max,                    &
( 5122)                                       chunks(chunk)%field%z_min,                    &
( 5123)                                       chunks(chunk)%field%z_max,                    &
( 5124)                                       chunks(chunk)%field%xvel0,                    &
( 5125)                                       chunks(chunk)%back_rcv_buffer,                &
( 5126)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5127)                                       depth, VERTEX_DATA,                           &
( 5128)                                       back_front_offset(FIELD_XVEL0))
( 5129)     ELSE
( 5130)       CALL clover_unpack_message_back_c(chunks(chunk)%field%x_min,                    &
( 5131)                                         chunks(chunk)%field%x_max,                    &
( 5132)                                         chunks(chunk)%field%y_min,                    &
( 5133)                                         chunks(chunk)%field%y_max,                    &
( 5134)                                         chunks(chunk)%field%xvel0,                    &
( 5135)                                         chunks(chunk)%back_rcv_buffer,                &
( 5136)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5137)                                         depth, VERTEX_DATA,                           &
( 5138)                                         back_front_offset(FIELD_XVEL0))
( 5139)     ENDIF
( 5140)   ENDIF
( 5141)   IF(fields(FIELD_XVEL1).EQ.1) THEN
( 5142)     IF(use_fortran_kernels) THEN
( 5143)       CALL clover_unpack_message_back(chunks(chunk)%field%x_min,                    &
( 5144)                                       chunks(chunk)%field%x_max,                    &
( 5145)                                       chunks(chunk)%field%y_min,                    &
( 5146)                                       chunks(chunk)%field%y_max,                    &
( 5147)                                       chunks(chunk)%field%z_min,                    &
( 5148)                                       chunks(chunk)%field%z_max,                    &
( 5149)                                       chunks(chunk)%field%xvel1,                    &
( 5150)                                       chunks(chunk)%back_rcv_buffer,                &
( 5151)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5152)                                       depth, VERTEX_DATA,                           &
( 5153)                                       back_front_offset(FIELD_XVEL1))
( 5154)     ELSE






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 90

( 5155)       CALL clover_unpack_message_back_c(chunks(chunk)%field%x_min,                    &
( 5156)                                         chunks(chunk)%field%x_max,                    &
( 5157)                                         chunks(chunk)%field%y_min,                    &
( 5158)                                         chunks(chunk)%field%y_max,                    &
( 5159)                                         chunks(chunk)%field%xvel1,                    &
( 5160)                                         chunks(chunk)%back_rcv_buffer,                &
( 5161)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5162)                                         depth, VERTEX_DATA,                           &
( 5163)                                         back_front_offset(FIELD_XVEL1))
( 5164)     ENDIF
( 5165)   ENDIF
( 5166)   IF(fields(FIELD_YVEL0).EQ.1) THEN
( 5167)     IF(use_fortran_kernels) THEN
( 5168)       CALL clover_unpack_message_back(chunks(chunk)%field%x_min,                    &
( 5169)                                       chunks(chunk)%field%x_max,                    &
( 5170)                                       chunks(chunk)%field%y_min,                    &
( 5171)                                       chunks(chunk)%field%y_max,                    &
( 5172)                                       chunks(chunk)%field%z_min,                    &
( 5173)                                       chunks(chunk)%field%z_max,                    &
( 5174)                                       chunks(chunk)%field%yvel0,                    &
( 5175)                                       chunks(chunk)%back_rcv_buffer,                &
( 5176)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5177)                                       depth, VERTEX_DATA,                           &
( 5178)                                       back_front_offset(FIELD_YVEL0))
( 5179)     ELSE
( 5180)       CALL clover_unpack_message_back_c(chunks(chunk)%field%x_min,                    &
( 5181)                                         chunks(chunk)%field%x_max,                    &
( 5182)                                         chunks(chunk)%field%y_min,                    &
( 5183)                                         chunks(chunk)%field%y_max,                    &
( 5184)                                         chunks(chunk)%field%yvel0,                    &
( 5185)                                         chunks(chunk)%back_rcv_buffer,                &
( 5186)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5187)                                         depth, VERTEX_DATA,                           &
( 5188)                                         back_front_offset(FIELD_YVEL0))
( 5189)     ENDIF
( 5190)   ENDIF
( 5191)   IF(fields(FIELD_YVEL1).EQ.1) THEN
( 5192)     IF(use_fortran_kernels) THEN
( 5193)       CALL clover_unpack_message_back(chunks(chunk)%field%x_min,                    &
( 5194)                                       chunks(chunk)%field%x_max,                    &
( 5195)                                       chunks(chunk)%field%y_min,                    &
( 5196)                                       chunks(chunk)%field%y_max,                    &
( 5197)                                       chunks(chunk)%field%z_min,                    &
( 5198)                                       chunks(chunk)%field%z_max,                    &
( 5199)                                       chunks(chunk)%field%yvel1,                    &
( 5200)                                       chunks(chunk)%back_rcv_buffer,                &
( 5201)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5202)                                       depth, VERTEX_DATA,                           &
( 5203)                                       back_front_offset(FIELD_YVEL1))
( 5204)     ELSE
( 5205)       CALL clover_unpack_message_back_c(chunks(chunk)%field%x_min,                    &
( 5206)                                         chunks(chunk)%field%x_max,                    &
( 5207)                                         chunks(chunk)%field%y_min,                    &
( 5208)                                         chunks(chunk)%field%y_max,                    &
( 5209)                                         chunks(chunk)%field%yvel1,                    &
( 5210)                                         chunks(chunk)%back_rcv_buffer,                &
( 5211)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5212)                                         depth, VERTEX_DATA,                           &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 91

( 5213)                                         back_front_offset(FIELD_YVEL1))
( 5214)     ENDIF
( 5215)   ENDIF
( 5216)   IF(fields(FIELD_ZVEL0).EQ.1) THEN
( 5217)     IF(use_fortran_kernels) THEN
( 5218)       CALL clover_unpack_message_back(chunks(chunk)%field%x_min,                    &
( 5219)                                       chunks(chunk)%field%x_max,                    &
( 5220)                                       chunks(chunk)%field%y_min,                    &
( 5221)                                       chunks(chunk)%field%y_max,                    &
( 5222)                                       chunks(chunk)%field%z_min,                    &
( 5223)                                       chunks(chunk)%field%z_max,                    &
( 5224)                                       chunks(chunk)%field%zvel0,                    &
( 5225)                                       chunks(chunk)%back_rcv_buffer,                &
( 5226)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5227)                                       depth, VERTEX_DATA,                           &
( 5228)                                       back_front_offset(FIELD_ZVEL0))
( 5229)     ELSE
( 5230)       CALL clover_unpack_message_back_c(chunks(chunk)%field%x_min,                    &
( 5231)                                         chunks(chunk)%field%x_max,                    &
( 5232)                                         chunks(chunk)%field%y_min,                    &
( 5233)                                         chunks(chunk)%field%y_max,                    &
( 5234)                                         chunks(chunk)%field%zvel0,                    &
( 5235)                                         chunks(chunk)%back_rcv_buffer,                &
( 5236)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5237)                                         depth, VERTEX_DATA,                           &
( 5238)                                         back_front_offset(FIELD_ZVEL0))
( 5239)     ENDIF
( 5240)   ENDIF
( 5241)   IF(fields(FIELD_ZVEL1).EQ.1) THEN
( 5242)     IF(use_fortran_kernels) THEN
( 5243)       CALL clover_unpack_message_back(chunks(chunk)%field%x_min,                    &
( 5244)                                       chunks(chunk)%field%x_max,                    &
( 5245)                                       chunks(chunk)%field%y_min,                    &
( 5246)                                       chunks(chunk)%field%y_max,                    &
( 5247)                                       chunks(chunk)%field%z_min,                    &
( 5248)                                       chunks(chunk)%field%z_max,                    &
( 5249)                                       chunks(chunk)%field%zvel1,                    &
( 5250)                                       chunks(chunk)%back_rcv_buffer,                &
( 5251)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5252)                                       depth, VERTEX_DATA,                           &
( 5253)                                       back_front_offset(FIELD_ZVEL1))
( 5254)     ELSE
( 5255)       CALL clover_unpack_message_back_c(chunks(chunk)%field%x_min,                    &
( 5256)                                         chunks(chunk)%field%x_max,                    &
( 5257)                                         chunks(chunk)%field%y_min,                    &
( 5258)                                         chunks(chunk)%field%y_max,                    &
( 5259)                                         chunks(chunk)%field%zvel1,                    &
( 5260)                                         chunks(chunk)%back_rcv_buffer,                &
( 5261)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5262)                                         depth, VERTEX_DATA,                           &
( 5263)                                         back_front_offset(FIELD_ZVEL1))
( 5264)     ENDIF
( 5265)   ENDIF
( 5266)   IF(fields(FIELD_VOL_FLUX_X).EQ.1) THEN
( 5267)     IF(use_fortran_kernels) THEN
( 5268)       CALL clover_unpack_message_back(chunks(chunk)%field%x_min,                    &
( 5269)                                       chunks(chunk)%field%x_max,                    &
( 5270)                                       chunks(chunk)%field%y_min,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 92

( 5271)                                       chunks(chunk)%field%y_max,                    &
( 5272)                                       chunks(chunk)%field%z_min,                    &
( 5273)                                       chunks(chunk)%field%z_max,                    &
( 5274)                                       chunks(chunk)%field%vol_flux_x,               &
( 5275)                                       chunks(chunk)%back_rcv_buffer,                &
( 5276)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5277)                                       depth, X_FACE_DATA,                           &
( 5278)                                       back_front_offset(FIELD_VOL_FLUX_X))
( 5279)     ELSE
( 5280)       CALL clover_unpack_message_back_c(chunks(chunk)%field%x_min,                    &
( 5281)                                         chunks(chunk)%field%x_max,                    &
( 5282)                                         chunks(chunk)%field%y_min,                    &
( 5283)                                         chunks(chunk)%field%y_max,                    &
( 5284)                                         chunks(chunk)%field%vol_flux_x,               &
( 5285)                                         chunks(chunk)%back_rcv_buffer,                &
( 5286)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5287)                                         depth, X_FACE_DATA,                           &
( 5288)                                         back_front_offset(FIELD_VOL_FLUX_X))
( 5289)     ENDIF
( 5290)   ENDIF
( 5291)   IF(fields(FIELD_VOL_FLUX_Y).EQ.1) THEN
( 5292)     IF(use_fortran_kernels) THEN
( 5293)       CALL clover_unpack_message_back(chunks(chunk)%field%x_min,                    &
( 5294)                                       chunks(chunk)%field%x_max,                    &
( 5295)                                       chunks(chunk)%field%y_min,                    &
( 5296)                                       chunks(chunk)%field%y_max,                    &
( 5297)                                       chunks(chunk)%field%z_min,                    &
( 5298)                                       chunks(chunk)%field%z_max,                    &
( 5299)                                       chunks(chunk)%field%vol_flux_y,               &
( 5300)                                       chunks(chunk)%back_rcv_buffer,                &
( 5301)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5302)                                       depth, Y_FACE_DATA,                           &
( 5303)                                       back_front_offset(FIELD_VOL_FLUX_Y))
( 5304)     ELSE
( 5305)       CALL clover_unpack_message_back_c(chunks(chunk)%field%x_min,                    &
( 5306)                                         chunks(chunk)%field%x_max,                    &
( 5307)                                         chunks(chunk)%field%y_min,                    &
( 5308)                                         chunks(chunk)%field%y_max,                    &
( 5309)                                         chunks(chunk)%field%vol_flux_y,               &
( 5310)                                         chunks(chunk)%back_rcv_buffer,                &
( 5311)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5312)                                         depth, Y_FACE_DATA,                           &
( 5313)                                         back_front_offset(FIELD_VOL_FLUX_Y))
( 5314)     ENDIF
( 5315)   ENDIF
( 5316)   IF(fields(FIELD_VOL_FLUX_Z).EQ.1) THEN
( 5317)     IF(use_fortran_kernels) THEN
( 5318)       CALL clover_unpack_message_back(chunks(chunk)%field%x_min,                    &
( 5319)                                       chunks(chunk)%field%x_max,                    &
( 5320)                                       chunks(chunk)%field%y_min,                    &
( 5321)                                       chunks(chunk)%field%y_max,                    &
( 5322)                                       chunks(chunk)%field%z_min,                    &
( 5323)                                       chunks(chunk)%field%z_max,                    &
( 5324)                                       chunks(chunk)%field%vol_flux_z,               &
( 5325)                                       chunks(chunk)%back_rcv_buffer,                &
( 5326)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5327)                                       depth, Z_FACE_DATA,                           &
( 5328)                                       back_front_offset(FIELD_VOL_FLUX_Z))






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 93

( 5329)     ELSE
( 5330)       CALL clover_unpack_message_back_c(chunks(chunk)%field%x_min,                    &
( 5331)                                         chunks(chunk)%field%x_max,                    &
( 5332)                                         chunks(chunk)%field%y_min,                    &
( 5333)                                         chunks(chunk)%field%y_max,                    &
( 5334)                                         chunks(chunk)%field%vol_flux_z,               &
( 5335)                                         chunks(chunk)%back_rcv_buffer,                &
( 5336)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5337)                                         depth, Z_FACE_DATA,                           &
( 5338)                                         back_front_offset(FIELD_VOL_FLUX_Z))
( 5339)     ENDIF
( 5340)   ENDIF
( 5341)   IF(fields(FIELD_MASS_FLUX_X).EQ.1) THEN
( 5342)     IF(use_fortran_kernels) THEN
( 5343)       CALL clover_unpack_message_back(chunks(chunk)%field%x_min,                    &
( 5344)                                       chunks(chunk)%field%x_max,                    &
( 5345)                                       chunks(chunk)%field%y_min,                    &
( 5346)                                       chunks(chunk)%field%y_max,                    &
( 5347)                                       chunks(chunk)%field%z_min,                    &
( 5348)                                       chunks(chunk)%field%z_max,                    &
( 5349)                                       chunks(chunk)%field%mass_flux_x,              &
( 5350)                                       chunks(chunk)%back_rcv_buffer,                &
( 5351)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5352)                                       depth, X_FACE_DATA,                           &
( 5353)                                       back_front_offset(FIELD_MASS_FLUX_X))
( 5354)     ELSE
( 5355)       CALL clover_unpack_message_back_c(chunks(chunk)%field%x_min,                    &
( 5356)                                         chunks(chunk)%field%x_max,                    &
( 5357)                                         chunks(chunk)%field%y_min,                    &
( 5358)                                         chunks(chunk)%field%y_max,                    &
( 5359)                                         chunks(chunk)%field%mass_flux_x,              &
( 5360)                                         chunks(chunk)%back_rcv_buffer,                &
( 5361)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5362)                                         depth, X_FACE_DATA,                           &
( 5363)                                         back_front_offset(FIELD_MASS_FLUX_X))
( 5364)     ENDIF
( 5365)   ENDIF
( 5366)   IF(fields(FIELD_MASS_FLUX_Y).EQ.1) THEN
( 5367)     IF(use_fortran_kernels) THEN
( 5368)       CALL clover_unpack_message_back(chunks(chunk)%field%x_min,                    &
( 5369)                                       chunks(chunk)%field%x_max,                    &
( 5370)                                       chunks(chunk)%field%y_min,                    &
( 5371)                                       chunks(chunk)%field%y_max,                    &
( 5372)                                       chunks(chunk)%field%z_min,                    &
( 5373)                                       chunks(chunk)%field%z_max,                    &
( 5374)                                       chunks(chunk)%field%mass_flux_y,              &
( 5375)                                       chunks(chunk)%back_rcv_buffer,                &
( 5376)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5377)                                       depth, Y_FACE_DATA,                           &
( 5378)                                       back_front_offset(FIELD_MASS_FLUX_Y))
( 5379)     ELSE
( 5380)       CALL clover_unpack_message_back_c(chunks(chunk)%field%x_min,                    &
( 5381)                                         chunks(chunk)%field%x_max,                    &
( 5382)                                         chunks(chunk)%field%y_min,                    &
( 5383)                                         chunks(chunk)%field%y_max,                    &
( 5384)                                         chunks(chunk)%field%mass_flux_y,              &
( 5385)                                         chunks(chunk)%back_rcv_buffer,                &
( 5386)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 94

( 5387)                                         depth, Y_FACE_DATA,                           &
( 5388)                                         back_front_offset(FIELD_MASS_FLUX_Y))
( 5389)     ENDIF
( 5390)   ENDIF
( 5391)   IF(fields(FIELD_MASS_FLUX_Z).EQ.1) THEN
( 5392)     IF(use_fortran_kernels) THEN
( 5393)       CALL clover_unpack_message_back(chunks(chunk)%field%x_min,                    &
( 5394)                                       chunks(chunk)%field%x_max,                    &
( 5395)                                       chunks(chunk)%field%y_min,                    &
( 5396)                                       chunks(chunk)%field%y_max,                    &
( 5397)                                       chunks(chunk)%field%z_min,                    &
( 5398)                                       chunks(chunk)%field%z_max,                    &
( 5399)                                       chunks(chunk)%field%mass_flux_z,              &
( 5400)                                       chunks(chunk)%back_rcv_buffer,                &
( 5401)                                       CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5402)                                       depth, Z_FACE_DATA,                           &
( 5403)                                       back_front_offset(FIELD_MASS_FLUX_Z))
( 5404)     ELSE
( 5405)       CALL clover_unpack_message_back_c(chunks(chunk)%field%x_min,                    &
( 5406)                                         chunks(chunk)%field%x_max,                    &
( 5407)                                         chunks(chunk)%field%y_min,                    &
( 5408)                                         chunks(chunk)%field%y_max,                    &
( 5409)                                         chunks(chunk)%field%mass_flux_z,              &
( 5410)                                         chunks(chunk)%back_rcv_buffer,                &
( 5411)                                         CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5412)                                         depth, Z_FACE_DATA,                           &
( 5413)                                         back_front_offset(FIELD_MASS_FLUX_Z))
( 5414)     ENDIF
( 5415)   ENDIF
( 5416) END SUBROUTINE clover_unpack_back
( 5417) 
( 5418) SUBROUTINE clover_pack_front(chunk, fields, depth, back_front_offset)
( 5419) 
( 5420)   USE pack_kernel_module
( 5421) 
( 5422)   IMPLICIT NONE
( 5423) 
( 5424)   INTEGER        :: chunk, fields(:), depth, tot_packb, back_front_offset(:)
( 5425) 
( 5426)   IF(fields(FIELD_DENSITY0).EQ.1) THEN
( 5427)     IF(use_fortran_kernels) THEN
( 5428)       CALL clover_pack_message_front(chunks(chunk)%field%x_min,                    &
( 5429)                                      chunks(chunk)%field%x_max,                    &
( 5430)                                      chunks(chunk)%field%y_min,                    &
( 5431)                                      chunks(chunk)%field%y_max,                    &
( 5432)                                      chunks(chunk)%field%z_min,                    &
( 5433)                                      chunks(chunk)%field%z_max,                    &
( 5434)                                      chunks(chunk)%field%density0,                 &
( 5435)                                      chunks(chunk)%front_snd_buffer,               &
( 5436)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5437)                                      depth, CELL_DATA,                             &
( 5438)                                      back_front_offset(FIELD_DENSITY0))
( 5439)     ELSE
( 5440)       CALL clover_pack_message_front_c(chunks(chunk)%field%x_min,                    &
( 5441)                                        chunks(chunk)%field%x_max,                    &
( 5442)                                        chunks(chunk)%field%y_min,                    &
( 5443)                                        chunks(chunk)%field%y_max,                    &
( 5444)                                        chunks(chunk)%field%density0,                 &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 95

( 5445)                                        chunks(chunk)%front_snd_buffer,               &
( 5446)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5447)                                        depth, CELL_DATA,                             &
( 5448)                                        back_front_offset(FIELD_DENSITY0))
( 5449)     ENDIF
( 5450)   ENDIF
( 5451)   IF(fields(FIELD_DENSITY1).EQ.1) THEN
( 5452)     IF(use_fortran_kernels) THEN
( 5453)       CALL clover_pack_message_front(chunks(chunk)%field%x_min,                    &
( 5454)                                      chunks(chunk)%field%x_max,                    &
( 5455)                                      chunks(chunk)%field%y_min,                    &
( 5456)                                      chunks(chunk)%field%y_max,                    &
( 5457)                                      chunks(chunk)%field%z_min,                    &
( 5458)                                      chunks(chunk)%field%z_max,                    &
( 5459)                                      chunks(chunk)%field%density1,                 &
( 5460)                                      chunks(chunk)%front_snd_buffer,               &
( 5461)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5462)                                      depth, CELL_DATA,                             &
( 5463)                                      back_front_offset(FIELD_DENSITY1))
( 5464)     ELSE
( 5465)       CALL clover_pack_message_front_c(chunks(chunk)%field%x_min,                    &
( 5466)                                        chunks(chunk)%field%x_max,                    &
( 5467)                                        chunks(chunk)%field%y_min,                    &
( 5468)                                        chunks(chunk)%field%y_max,                    &
( 5469)                                        chunks(chunk)%field%density1,                 &
( 5470)                                        chunks(chunk)%front_snd_buffer,               &
( 5471)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5472)                                        depth, CELL_DATA,                             &
( 5473)                                        back_front_offset(FIELD_DENSITY1))
( 5474)     ENDIF
( 5475)   ENDIF
( 5476)   IF(fields(FIELD_ENERGY0).EQ.1) THEN
( 5477)     IF(use_fortran_kernels) THEN
( 5478)       CALL clover_pack_message_front(chunks(chunk)%field%x_min,                    &
( 5479)                                      chunks(chunk)%field%x_max,                    &
( 5480)                                      chunks(chunk)%field%y_min,                    &
( 5481)                                      chunks(chunk)%field%y_max,                    &
( 5482)                                      chunks(chunk)%field%z_min,                    &
( 5483)                                      chunks(chunk)%field%z_max,                    &
( 5484)                                      chunks(chunk)%field%energy0,                  &
( 5485)                                      chunks(chunk)%front_snd_buffer,               &
( 5486)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5487)                                      depth, CELL_DATA,                             &
( 5488)                                      back_front_offset(FIELD_ENERGY0))
( 5489)     ELSE
( 5490)       CALL clover_pack_message_front_c(chunks(chunk)%field%x_min,                    &
( 5491)                                        chunks(chunk)%field%x_max,                    &
( 5492)                                        chunks(chunk)%field%y_min,                    &
( 5493)                                        chunks(chunk)%field%y_max,                    &
( 5494)                                        chunks(chunk)%field%energy0,                  &
( 5495)                                        chunks(chunk)%front_snd_buffer,               &
( 5496)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5497)                                        depth, CELL_DATA,                             &
( 5498)                                        back_front_offset(FIELD_ENERGY0))
( 5499)     ENDIF
( 5500)   ENDIF
( 5501)   IF(fields(FIELD_ENERGY1).EQ.1) THEN
( 5502)     IF(use_fortran_kernels) THEN






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 96

( 5503)       CALL clover_pack_message_front(chunks(chunk)%field%x_min,                    &
( 5504)                                      chunks(chunk)%field%x_max,                    &
( 5505)                                      chunks(chunk)%field%y_min,                    &
( 5506)                                      chunks(chunk)%field%y_max,                    &
( 5507)                                      chunks(chunk)%field%z_min,                    &
( 5508)                                      chunks(chunk)%field%z_max,                    &
( 5509)                                      chunks(chunk)%field%energy1,                  &
( 5510)                                      chunks(chunk)%front_snd_buffer,               &
( 5511)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5512)                                      depth, CELL_DATA,                             &
( 5513)                                      back_front_offset(FIELD_ENERGY1))
( 5514)     ELSE
( 5515)       CALL clover_pack_message_front_c(chunks(chunk)%field%x_min,                    &
( 5516)                                        chunks(chunk)%field%x_max,                    &
( 5517)                                        chunks(chunk)%field%y_min,                    &
( 5518)                                        chunks(chunk)%field%y_max,                    &
( 5519)                                        chunks(chunk)%field%energy1,                  &
( 5520)                                        chunks(chunk)%front_snd_buffer,               &
( 5521)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5522)                                        depth, CELL_DATA,                             &
( 5523)                                        back_front_offset(FIELD_ENERGY1))
( 5524)     ENDIF
( 5525)   ENDIF
( 5526)   IF(fields(FIELD_PRESSURE).EQ.1) THEN
( 5527)     IF(use_fortran_kernels) THEN
( 5528)       CALL clover_pack_message_front(chunks(chunk)%field%x_min,                    &
( 5529)                                      chunks(chunk)%field%x_max,                    &
( 5530)                                      chunks(chunk)%field%y_min,                    &
( 5531)                                      chunks(chunk)%field%y_max,                    &
( 5532)                                      chunks(chunk)%field%z_min,                    &
( 5533)                                      chunks(chunk)%field%z_max,                    &
( 5534)                                      chunks(chunk)%field%pressure,                 &
( 5535)                                      chunks(chunk)%front_snd_buffer,               &
( 5536)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5537)                                      depth, CELL_DATA,                             &
( 5538)                                      back_front_offset(FIELD_PRESSURE))
( 5539)     ELSE
( 5540)       CALL clover_pack_message_front_c(chunks(chunk)%field%x_min,                    &
( 5541)                                        chunks(chunk)%field%x_max,                    &
( 5542)                                        chunks(chunk)%field%y_min,                    &
( 5543)                                        chunks(chunk)%field%y_max,                    &
( 5544)                                        chunks(chunk)%field%pressure,                 &
( 5545)                                        chunks(chunk)%front_snd_buffer,               &
( 5546)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5547)                                        depth, CELL_DATA,                             &
( 5548)                                        back_front_offset(FIELD_PRESSURE))
( 5549)     ENDIF
( 5550)   ENDIF
( 5551)   IF(fields(FIELD_VISCOSITY).EQ.1) THEN
( 5552)     IF(use_fortran_kernels) THEN
( 5553)       CALL clover_pack_message_front(chunks(chunk)%field%x_min,                    &
( 5554)                                      chunks(chunk)%field%x_max,                    &
( 5555)                                      chunks(chunk)%field%y_min,                    &
( 5556)                                      chunks(chunk)%field%y_max,                    &
( 5557)                                      chunks(chunk)%field%z_min,                    &
( 5558)                                      chunks(chunk)%field%z_max,                    &
( 5559)                                      chunks(chunk)%field%viscosity,                &
( 5560)                                      chunks(chunk)%front_snd_buffer,               &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 97

( 5561)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5562)                                      depth, CELL_DATA,                             &
( 5563)                                      back_front_offset(FIELD_VISCOSITY))
( 5564)     ELSE
( 5565)       CALL clover_pack_message_front_c(chunks(chunk)%field%x_min,                    &
( 5566)                                        chunks(chunk)%field%x_max,                    &
( 5567)                                        chunks(chunk)%field%y_min,                    &
( 5568)                                        chunks(chunk)%field%y_max,                    &
( 5569)                                        chunks(chunk)%field%viscosity,                &
( 5570)                                        chunks(chunk)%front_snd_buffer,               &
( 5571)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5572)                                        depth, CELL_DATA,                             &
( 5573)                                        back_front_offset(FIELD_VISCOSITY))
( 5574)     ENDIF
( 5575)   ENDIF
( 5576)   IF(fields(FIELD_SOUNDSPEED).EQ.1) THEN
( 5577)     IF(use_fortran_kernels) THEN
( 5578)       CALL clover_pack_message_front(chunks(chunk)%field%x_min,                    &
( 5579)                                      chunks(chunk)%field%x_max,                    &
( 5580)                                      chunks(chunk)%field%y_min,                    &
( 5581)                                      chunks(chunk)%field%y_max,                    &
( 5582)                                      chunks(chunk)%field%z_min,                    &
( 5583)                                      chunks(chunk)%field%z_max,                    &
( 5584)                                      chunks(chunk)%field%soundspeed,               &
( 5585)                                      chunks(chunk)%front_snd_buffer,               &
( 5586)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5587)                                      depth, CELL_DATA,                             &
( 5588)                                      back_front_offset(FIELD_SOUNDSPEED))
( 5589)     ELSE
( 5590)       CALL clover_pack_message_front_c(chunks(chunk)%field%x_min,                    &
( 5591)                                        chunks(chunk)%field%x_max,                    &
( 5592)                                        chunks(chunk)%field%y_min,                    &
( 5593)                                        chunks(chunk)%field%y_max,                    &
( 5594)                                        chunks(chunk)%field%soundspeed,               &
( 5595)                                        chunks(chunk)%front_snd_buffer,               &
( 5596)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5597)                                        depth, CELL_DATA,                             &
( 5598)                                        back_front_offset(FIELD_SOUNDSPEED))
( 5599)     ENDIF
( 5600)   ENDIF
( 5601)   IF(fields(FIELD_XVEL0).EQ.1) THEN
( 5602)     IF(use_fortran_kernels) THEN
( 5603)       CALL clover_pack_message_front(chunks(chunk)%field%x_min,                    &
( 5604)                                      chunks(chunk)%field%x_max,                    &
( 5605)                                      chunks(chunk)%field%y_min,                    &
( 5606)                                      chunks(chunk)%field%y_max,                    &
( 5607)                                      chunks(chunk)%field%z_min,                    &
( 5608)                                      chunks(chunk)%field%z_max,                    &
( 5609)                                      chunks(chunk)%field%xvel0,                    &
( 5610)                                      chunks(chunk)%front_snd_buffer,               &
( 5611)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5612)                                      depth, VERTEX_DATA,                           &
( 5613)                                      back_front_offset(FIELD_XVEL0))
( 5614)     ELSE
( 5615)       CALL clover_pack_message_front_c(chunks(chunk)%field%x_min,                    &
( 5616)                                        chunks(chunk)%field%x_max,                    &
( 5617)                                        chunks(chunk)%field%y_min,                    &
( 5618)                                        chunks(chunk)%field%y_max,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 98

( 5619)                                        chunks(chunk)%field%xvel0     ,               &
( 5620)                                        chunks(chunk)%front_snd_buffer,               &
( 5621)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5622)                                        depth, VERTEX_DATA,                           &
( 5623)                                        back_front_offset(FIELD_XVEL0))
( 5624)     ENDIF
( 5625)   ENDIF
( 5626)   IF(fields(FIELD_XVEL1).EQ.1) THEN
( 5627)     IF(use_fortran_kernels) THEN
( 5628)       CALL clover_pack_message_front(chunks(chunk)%field%x_min,                    &
( 5629)                                      chunks(chunk)%field%x_max,                    &
( 5630)                                      chunks(chunk)%field%y_min,                    &
( 5631)                                      chunks(chunk)%field%y_max,                    &
( 5632)                                      chunks(chunk)%field%z_min,                    &
( 5633)                                      chunks(chunk)%field%z_max,                    &
( 5634)                                      chunks(chunk)%field%xvel1,                    &
( 5635)                                      chunks(chunk)%front_snd_buffer,               &
( 5636)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5637)                                      depth, VERTEX_DATA,                           &
( 5638)                                      back_front_offset(FIELD_XVEL1))
( 5639)     ELSE
( 5640)       CALL clover_pack_message_front_c(chunks(chunk)%field%x_min,                    &
( 5641)                                        chunks(chunk)%field%x_max,                    &
( 5642)                                        chunks(chunk)%field%y_min,                    &
( 5643)                                        chunks(chunk)%field%y_max,                    &
( 5644)                                        chunks(chunk)%field%xvel1,                    &
( 5645)                                        chunks(chunk)%front_snd_buffer,               &
( 5646)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5647)                                        depth, VERTEX_DATA,                           &
( 5648)                                        back_front_offset(FIELD_XVEL1))
( 5649)     ENDIF
( 5650)   ENDIF
( 5651)   IF(fields(FIELD_YVEL0).EQ.1) THEN
( 5652)     IF(use_fortran_kernels) THEN
( 5653)       CALL clover_pack_message_front(chunks(chunk)%field%x_min,                    &
( 5654)                                      chunks(chunk)%field%x_max,                    &
( 5655)                                      chunks(chunk)%field%y_min,                    &
( 5656)                                      chunks(chunk)%field%y_max,                    &
( 5657)                                      chunks(chunk)%field%z_min,                    &
( 5658)                                      chunks(chunk)%field%z_max,                    &
( 5659)                                      chunks(chunk)%field%yvel0,                    &
( 5660)                                      chunks(chunk)%front_snd_buffer,               &
( 5661)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5662)                                      depth, VERTEX_DATA,                           &
( 5663)                                      back_front_offset(FIELD_YVEL0))
( 5664)     ELSE
( 5665)       CALL clover_pack_message_front_c(chunks(chunk)%field%x_min,                    &
( 5666)                                        chunks(chunk)%field%x_max,                    &
( 5667)                                        chunks(chunk)%field%y_min,                    &
( 5668)                                        chunks(chunk)%field%y_max,                    &
( 5669)                                        chunks(chunk)%field%yvel0,                    &
( 5670)                                        chunks(chunk)%front_snd_buffer,               &
( 5671)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5672)                                        depth, VERTEX_DATA,                           &
( 5673)                                        back_front_offset(FIELD_YVEL0))
( 5674)     ENDIF
( 5675)   ENDIF
( 5676)   IF(fields(FIELD_YVEL1).EQ.1) THEN






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 99

( 5677)     IF(use_fortran_kernels) THEN
( 5678)       CALL clover_pack_message_front(chunks(chunk)%field%x_min,                    &
( 5679)                                      chunks(chunk)%field%x_max,                    &
( 5680)                                      chunks(chunk)%field%y_min,                    &
( 5681)                                      chunks(chunk)%field%y_max,                    &
( 5682)                                      chunks(chunk)%field%z_min,                    &
( 5683)                                      chunks(chunk)%field%z_max,                    &
( 5684)                                      chunks(chunk)%field%yvel1,                    &
( 5685)                                      chunks(chunk)%front_snd_buffer,               &
( 5686)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5687)                                      depth, VERTEX_DATA,                           &
( 5688)                                      back_front_offset(FIELD_YVEL1))
( 5689)     ELSE
( 5690)       CALL clover_pack_message_front_c(chunks(chunk)%field%x_min,                    &
( 5691)                                        chunks(chunk)%field%x_max,                    &
( 5692)                                        chunks(chunk)%field%y_min,                    &
( 5693)                                        chunks(chunk)%field%y_max,                    &
( 5694)                                        chunks(chunk)%field%yvel1,                    &
( 5695)                                        chunks(chunk)%front_snd_buffer,               &
( 5696)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5697)                                        depth, VERTEX_DATA,                           &
( 5698)                                        back_front_offset(FIELD_YVEL1))
( 5699)     ENDIF
( 5700)   ENDIF
( 5701)   IF(fields(FIELD_ZVEL0).EQ.1) THEN
( 5702)     IF(use_fortran_kernels) THEN
( 5703)       CALL clover_pack_message_front(chunks(chunk)%field%x_min,                    &
( 5704)                                      chunks(chunk)%field%x_max,                    &
( 5705)                                      chunks(chunk)%field%y_min,                    &
( 5706)                                      chunks(chunk)%field%y_max,                    &
( 5707)                                      chunks(chunk)%field%z_min,                    &
( 5708)                                      chunks(chunk)%field%z_max,                    &
( 5709)                                      chunks(chunk)%field%zvel0,                    &
( 5710)                                      chunks(chunk)%front_snd_buffer,               &
( 5711)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5712)                                      depth, VERTEX_DATA,                           &
( 5713)                                      back_front_offset(FIELD_ZVEL0))
( 5714)     ELSE
( 5715)       CALL clover_pack_message_front_c(chunks(chunk)%field%x_min,                    &
( 5716)                                        chunks(chunk)%field%x_max,                    &
( 5717)                                        chunks(chunk)%field%y_min,                    &
( 5718)                                        chunks(chunk)%field%y_max,                    &
( 5719)                                        chunks(chunk)%field%zvel0,                    &
( 5720)                                        chunks(chunk)%front_snd_buffer,               &
( 5721)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5722)                                        depth, VERTEX_DATA,                           &
( 5723)                                        back_front_offset(FIELD_ZVEL0))
( 5724)     ENDIF
( 5725)   ENDIF
( 5726)   IF(fields(FIELD_ZVEL1).EQ.1) THEN
( 5727)     IF(use_fortran_kernels) THEN
( 5728)       CALL clover_pack_message_front(chunks(chunk)%field%x_min,                    &
( 5729)                                      chunks(chunk)%field%x_max,                    &
( 5730)                                      chunks(chunk)%field%y_min,                    &
( 5731)                                      chunks(chunk)%field%y_max,                    &
( 5732)                                      chunks(chunk)%field%z_min,                    &
( 5733)                                      chunks(chunk)%field%z_max,                    &
( 5734)                                      chunks(chunk)%field%zvel1,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 100

( 5735)                                      chunks(chunk)%front_snd_buffer,               &
( 5736)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5737)                                      depth, VERTEX_DATA,                           &
( 5738)                                      back_front_offset(FIELD_ZVEL1))
( 5739)     ELSE
( 5740)       CALL clover_pack_message_front_c(chunks(chunk)%field%x_min,                    &
( 5741)                                        chunks(chunk)%field%x_max,                    &
( 5742)                                        chunks(chunk)%field%y_min,                    &
( 5743)                                        chunks(chunk)%field%y_max,                    &
( 5744)                                        chunks(chunk)%field%zvel1,                    &
( 5745)                                        chunks(chunk)%front_snd_buffer,               &
( 5746)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5747)                                        depth, VERTEX_DATA,                           &
( 5748)                                        back_front_offset(FIELD_ZVEL1))
( 5749)     ENDIF
( 5750)   ENDIF
( 5751)   IF(fields(FIELD_VOL_FLUX_X).EQ.1) THEN
( 5752)     IF(use_fortran_kernels) THEN
( 5753)       CALL clover_pack_message_front(chunks(chunk)%field%x_min,                    &
( 5754)                                      chunks(chunk)%field%x_max,                    &
( 5755)                                      chunks(chunk)%field%y_min,                    &
( 5756)                                      chunks(chunk)%field%y_max,                    &
( 5757)                                      chunks(chunk)%field%z_min,                    &
( 5758)                                      chunks(chunk)%field%z_max,                    &
( 5759)                                      chunks(chunk)%field%vol_flux_x,               &
( 5760)                                      chunks(chunk)%front_snd_buffer,               &
( 5761)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5762)                                      depth, X_FACE_DATA,                           &
( 5763)                                      back_front_offset(FIELD_VOL_FLUX_X))
( 5764)     ELSE
( 5765)       CALL clover_pack_message_front_c(chunks(chunk)%field%x_min,                    &
( 5766)                                        chunks(chunk)%field%x_max,                    &
( 5767)                                        chunks(chunk)%field%y_min,                    &
( 5768)                                        chunks(chunk)%field%y_max,                    &
( 5769)                                        chunks(chunk)%field%vol_flux_x,               &
( 5770)                                        chunks(chunk)%front_snd_buffer,               &
( 5771)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5772)                                        depth, X_FACE_DATA,                           &
( 5773)                                        back_front_offset(FIELD_VOL_FLUX_X))
( 5774)     ENDIF
( 5775)   ENDIF
( 5776)   IF(fields(FIELD_VOL_FLUX_Y).EQ.1) THEN
( 5777)     IF(use_fortran_kernels) THEN
( 5778)       CALL clover_pack_message_front(chunks(chunk)%field%x_min,                    &
( 5779)                                      chunks(chunk)%field%x_max,                    &
( 5780)                                      chunks(chunk)%field%y_min,                    &
( 5781)                                      chunks(chunk)%field%y_max,                    &
( 5782)                                      chunks(chunk)%field%z_min,                    &
( 5783)                                      chunks(chunk)%field%z_max,                    &
( 5784)                                      chunks(chunk)%field%vol_flux_y,               &
( 5785)                                      chunks(chunk)%front_snd_buffer,               &
( 5786)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5787)                                      depth, Y_FACE_DATA,                           &
( 5788)                                      back_front_offset(FIELD_VOL_FLUX_Y))
( 5789)     ELSE
( 5790)       CALL clover_pack_message_front_c(chunks(chunk)%field%x_min,                    &
( 5791)                                        chunks(chunk)%field%x_max,                    &
( 5792)                                        chunks(chunk)%field%y_min,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 101

( 5793)                                        chunks(chunk)%field%y_max,                    &
( 5794)                                        chunks(chunk)%field%vol_flux_y,               &
( 5795)                                        chunks(chunk)%front_snd_buffer,               &
( 5796)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5797)                                        depth, Y_FACE_DATA,                           &
( 5798)                                        back_front_offset(FIELD_VOL_FLUX_Y))
( 5799)     ENDIF
( 5800)   ENDIF
( 5801)   IF(fields(FIELD_VOL_FLUX_Z).EQ.1) THEN
( 5802)     IF(use_fortran_kernels) THEN
( 5803)       CALL clover_pack_message_front(chunks(chunk)%field%x_min,                    &
( 5804)                                      chunks(chunk)%field%x_max,                    &
( 5805)                                      chunks(chunk)%field%y_min,                    &
( 5806)                                      chunks(chunk)%field%y_max,                    &
( 5807)                                      chunks(chunk)%field%z_min,                    &
( 5808)                                      chunks(chunk)%field%z_max,                    &
( 5809)                                      chunks(chunk)%field%vol_flux_z,               &
( 5810)                                      chunks(chunk)%front_snd_buffer,               &
( 5811)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5812)                                      depth, Z_FACE_DATA,                           &
( 5813)                                      back_front_offset(FIELD_VOL_FLUX_Z))
( 5814)     ELSE
( 5815)       CALL clover_pack_message_front_c(chunks(chunk)%field%x_min,                    &
( 5816)                                        chunks(chunk)%field%x_max,                    &
( 5817)                                        chunks(chunk)%field%y_min,                    &
( 5818)                                        chunks(chunk)%field%y_max,                    &
( 5819)                                        chunks(chunk)%field%vol_flux_z,               &
( 5820)                                        chunks(chunk)%front_snd_buffer,               &
( 5821)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5822)                                        depth, Z_FACE_DATA,                           &
( 5823)                                        back_front_offset(FIELD_VOL_FLUX_Z))
( 5824)     ENDIF
( 5825)   ENDIF
( 5826)   IF(fields(FIELD_MASS_FLUX_X).EQ.1) THEN
( 5827)     IF(use_fortran_kernels) THEN
( 5828)       CALL clover_pack_message_front(chunks(chunk)%field%x_min,                    &
( 5829)                                      chunks(chunk)%field%x_max,                    &
( 5830)                                      chunks(chunk)%field%y_min,                    &
( 5831)                                      chunks(chunk)%field%y_max,                    &
( 5832)                                      chunks(chunk)%field%z_min,                    &
( 5833)                                      chunks(chunk)%field%z_max,                    &
( 5834)                                      chunks(chunk)%field%mass_flux_x,              &
( 5835)                                      chunks(chunk)%front_snd_buffer,               &
( 5836)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5837)                                      depth, X_FACE_DATA,                           &
( 5838)                                      back_front_offset(FIELD_MASS_FLUX_X))
( 5839)     ELSE
( 5840)       CALL clover_pack_message_front_c(chunks(chunk)%field%x_min,                    &
( 5841)                                        chunks(chunk)%field%x_max,                    &
( 5842)                                        chunks(chunk)%field%y_min,                    &
( 5843)                                        chunks(chunk)%field%y_max,                    &
( 5844)                                        chunks(chunk)%field%mass_flux_x,              &
( 5845)                                        chunks(chunk)%front_snd_buffer,               &
( 5846)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5847)                                        depth, X_FACE_DATA,                           &
( 5848)                                        back_front_offset(FIELD_MASS_FLUX_X))
( 5849)     ENDIF
( 5850)   ENDIF






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 102

( 5851)   IF(fields(FIELD_MASS_FLUX_Y).EQ.1) THEN
( 5852)     IF(use_fortran_kernels) THEN
( 5853)       CALL clover_pack_message_front(chunks(chunk)%field%x_min,                    &
( 5854)                                      chunks(chunk)%field%x_max,                    &
( 5855)                                      chunks(chunk)%field%y_min,                    &
( 5856)                                      chunks(chunk)%field%y_max,                    &
( 5857)                                      chunks(chunk)%field%z_min,                    &
( 5858)                                      chunks(chunk)%field%z_max,                    &
( 5859)                                      chunks(chunk)%field%mass_flux_y,              &
( 5860)                                      chunks(chunk)%front_snd_buffer,               &
( 5861)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5862)                                      depth, Y_FACE_DATA,                           &
( 5863)                                      back_front_offset(FIELD_MASS_FLUX_Y))
( 5864)     ELSE
( 5865)       CALL clover_pack_message_front_c(chunks(chunk)%field%x_min,                    &
( 5866)                                        chunks(chunk)%field%x_max,                    &
( 5867)                                        chunks(chunk)%field%y_min,                    &
( 5868)                                        chunks(chunk)%field%y_max,                    &
( 5869)                                        chunks(chunk)%field%mass_flux_y,              &
( 5870)                                        chunks(chunk)%front_snd_buffer,               &
( 5871)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5872)                                        depth, Y_FACE_DATA,                           &
( 5873)                                        back_front_offset(FIELD_MASS_FLUX_Y))
( 5874)     ENDIF
( 5875)   ENDIF
( 5876)   IF(fields(FIELD_MASS_FLUX_Z).EQ.1) THEN
( 5877)     IF(use_fortran_kernels) THEN
( 5878)       CALL clover_pack_message_front(chunks(chunk)%field%x_min,                    &
( 5879)                                      chunks(chunk)%field%x_max,                    &
( 5880)                                      chunks(chunk)%field%y_min,                    &
( 5881)                                      chunks(chunk)%field%y_max,                    &
( 5882)                                      chunks(chunk)%field%z_min,                    &
( 5883)                                      chunks(chunk)%field%z_max,                    &
( 5884)                                      chunks(chunk)%field%mass_flux_z,              &
( 5885)                                      chunks(chunk)%front_snd_buffer,               &
( 5886)                                      CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5887)                                      depth, Z_FACE_DATA,                           &
( 5888)                                      back_front_offset(FIELD_MASS_FLUX_Z))
( 5889)     ELSE
( 5890)       CALL clover_pack_message_front_c(chunks(chunk)%field%x_min,                    &
( 5891)                                        chunks(chunk)%field%x_max,                    &
( 5892)                                        chunks(chunk)%field%y_min,                    &
( 5893)                                        chunks(chunk)%field%y_max,                    &
( 5894)                                        chunks(chunk)%field%mass_flux_z,              &
( 5895)                                        chunks(chunk)%front_snd_buffer,               &
( 5896)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5897)                                        depth, Z_FACE_DATA,                           &
( 5898)                                        back_front_offset(FIELD_MASS_FLUX_Z))
( 5899)     ENDIF
( 5900)   ENDIF
( 5901) END SUBROUTINE clover_pack_front
( 5902) 
( 5903) SUBROUTINE clover_send_recv_message_front(front_snd_buffer, front_rcv_buffer,        &
( 5904)                                           chunk, total_size,                         &   
( 5905)                                           tag_send, tag_recv,                        &
( 5906)                                           req_send, req_recv)
( 5907) 
( 5908)   IMPLICIT NONE






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 103

( 5909) 
( 5910)   REAL(KIND=8) :: front_snd_buffer(:), front_rcv_buffer(:)
( 5911)   INTEGER      :: front_task
( 5912)   INTEGER      :: chunk
( 5913)   INTEGER      :: total_size, tag_send, tag_recv, err
( 5914)   INTEGER      :: req_send, req_recv
( 5915) 
( 5916)   front_task=chunks(chunk)%chunk_neighbours(chunk_front)-1
( 5917) 
( 5918)   CALL MPI_ISEND(front_snd_buffer,total_size,MPI_DOUBLE_PRECISION,front_task,tag_send &
( 5919)                 ,MPI_COMM_WORLD,req_send,err)
( 5920) 
( 5921)   CALL MPI_IRECV(front_rcv_buffer,total_size,MPI_DOUBLE_PRECISION,front_task,tag_recv &
( 5922)                 ,MPI_COMM_WORLD,req_recv,err)
( 5923) 
( 5924) END SUBROUTINE clover_send_recv_message_front
( 5925) 
( 5926) SUBROUTINE clover_unpack_front(fields, chunk, depth,                        &
( 5927)                                front_rcv_buffer,                            &
( 5928)                                back_front_offset)
( 5929) 
( 5930)   USE pack_kernel_module
( 5931) 
( 5932)   IMPLICIT NONE
( 5933) 
( 5934)   INTEGER         :: fields(:), chunk, depth, back_front_offset(:)
( 5935)   REAL(KIND=8)    :: front_rcv_buffer(:)
( 5936) 
( 5937)   IF(fields(FIELD_DENSITY0).EQ.1) THEN
( 5938)     IF(use_fortran_kernels) THEN
( 5939)       CALL clover_unpack_message_front(chunks(chunk)%field%x_min,                    &
( 5940)                                        chunks(chunk)%field%x_max,                    &
( 5941)                                        chunks(chunk)%field%y_min,                    &
( 5942)                                        chunks(chunk)%field%y_max,                    &
( 5943)                                        chunks(chunk)%field%z_min,                    &
( 5944)                                        chunks(chunk)%field%z_max,                    &
( 5945)                                        chunks(chunk)%field%density0,                 &
( 5946)                                        chunks(chunk)%front_rcv_buffer,               &
( 5947)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5948)                                        depth, CELL_DATA,                             &
( 5949)                                        back_front_offset(FIELD_DENSITY0))
( 5950)     ELSE
( 5951)       CALL clover_unpack_message_front_c(chunks(chunk)%field%x_min,                    &
( 5952)                                          chunks(chunk)%field%x_max,                    &
( 5953)                                          chunks(chunk)%field%y_min,                    &
( 5954)                                          chunks(chunk)%field%y_max,                    &
( 5955)                                          chunks(chunk)%field%density0,                 &
( 5956)                                          chunks(chunk)%front_rcv_buffer,               &
( 5957)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5958)                                          depth, CELL_DATA,                             &
( 5959)                                          back_front_offset(FIELD_DENSITY0))
( 5960)     ENDIF
( 5961)   ENDIF
( 5962)   IF(fields(FIELD_DENSITY1).EQ.1) THEN
( 5963)     IF(use_fortran_kernels) THEN
( 5964)       CALL clover_unpack_message_front(chunks(chunk)%field%x_min,                    &
( 5965)                                        chunks(chunk)%field%x_max,                    &
( 5966)                                        chunks(chunk)%field%y_min,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 104

( 5967)                                        chunks(chunk)%field%y_max,                    &
( 5968)                                        chunks(chunk)%field%z_min,                    &
( 5969)                                        chunks(chunk)%field%z_max,                    &
( 5970)                                        chunks(chunk)%field%density1,                 &
( 5971)                                        chunks(chunk)%front_rcv_buffer,               &
( 5972)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5973)                                        depth, CELL_DATA,                             &
( 5974)                                        back_front_offset(FIELD_DENSITY1))
( 5975)     ELSE
( 5976)       CALL clover_unpack_message_front_c(chunks(chunk)%field%x_min,                    &
( 5977)                                          chunks(chunk)%field%x_max,                    &
( 5978)                                          chunks(chunk)%field%y_min,                    &
( 5979)                                          chunks(chunk)%field%y_max,                    &
( 5980)                                          chunks(chunk)%field%density1,                 &
( 5981)                                          chunks(chunk)%front_rcv_buffer,               &
( 5982)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 5983)                                          depth, CELL_DATA,                             &
( 5984)                                          back_front_offset(FIELD_DENSITY1))
( 5985)     ENDIF
( 5986)   ENDIF
( 5987)   IF(fields(FIELD_ENERGY0).EQ.1) THEN
( 5988)     IF(use_fortran_kernels) THEN
( 5989)       CALL clover_unpack_message_front(chunks(chunk)%field%x_min,                    &
( 5990)                                        chunks(chunk)%field%x_max,                    &
( 5991)                                        chunks(chunk)%field%y_min,                    &
( 5992)                                        chunks(chunk)%field%y_max,                    &
( 5993)                                        chunks(chunk)%field%z_min,                    &
( 5994)                                        chunks(chunk)%field%z_max,                    &
( 5995)                                        chunks(chunk)%field%energy0,                  &
( 5996)                                        chunks(chunk)%front_rcv_buffer,               &
( 5997)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 5998)                                        depth, CELL_DATA,                             &
( 5999)                                        back_front_offset(FIELD_ENERGY0))
( 6000)     ELSE
( 6001)       CALL clover_unpack_message_front_c(chunks(chunk)%field%x_min,                    &
( 6002)                                          chunks(chunk)%field%x_max,                    &
( 6003)                                          chunks(chunk)%field%y_min,                    &
( 6004)                                          chunks(chunk)%field%y_max,                    &
( 6005)                                          chunks(chunk)%field%energy0,                  &
( 6006)                                          chunks(chunk)%front_rcv_buffer,               &
( 6007)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 6008)                                          depth, CELL_DATA,                             &
( 6009)                                          back_front_offset(FIELD_ENERGY0))
( 6010)     ENDIF
( 6011)   ENDIF
( 6012)   IF(fields(FIELD_ENERGY1).EQ.1) THEN
( 6013)     IF(use_fortran_kernels) THEN
( 6014)       CALL clover_unpack_message_front(chunks(chunk)%field%x_min,                    &
( 6015)                                        chunks(chunk)%field%x_max,                    &
( 6016)                                        chunks(chunk)%field%y_min,                    &
( 6017)                                        chunks(chunk)%field%y_max,                    &
( 6018)                                        chunks(chunk)%field%z_min,                    &
( 6019)                                        chunks(chunk)%field%z_max,                    &
( 6020)                                        chunks(chunk)%field%energy1,                  &
( 6021)                                        chunks(chunk)%front_rcv_buffer,               &
( 6022)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 6023)                                        depth, CELL_DATA,                             &
( 6024)                                        back_front_offset(FIELD_ENERGY1))






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 105

( 6025)     ELSE
( 6026)       CALL clover_unpack_message_front_c(chunks(chunk)%field%x_min,                    &
( 6027)                                          chunks(chunk)%field%x_max,                    &
( 6028)                                          chunks(chunk)%field%y_min,                    &
( 6029)                                          chunks(chunk)%field%y_max,                    &
( 6030)                                          chunks(chunk)%field%energy1,                  &
( 6031)                                          chunks(chunk)%front_rcv_buffer,               &
( 6032)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 6033)                                          depth, CELL_DATA,                             &
( 6034)                                          back_front_offset(FIELD_ENERGY1))
( 6035)     ENDIF
( 6036)   ENDIF
( 6037)   IF(fields(FIELD_PRESSURE).EQ.1) THEN
( 6038)     IF(use_fortran_kernels) THEN
( 6039)       CALL clover_unpack_message_front(chunks(chunk)%field%x_min,                    &
( 6040)                                        chunks(chunk)%field%x_max,                    &
( 6041)                                        chunks(chunk)%field%y_min,                    &
( 6042)                                        chunks(chunk)%field%y_max,                    &
( 6043)                                        chunks(chunk)%field%z_min,                    &
( 6044)                                        chunks(chunk)%field%z_max,                    &
( 6045)                                        chunks(chunk)%field%pressure,                 &
( 6046)                                        chunks(chunk)%front_rcv_buffer,               &
( 6047)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 6048)                                        depth, CELL_DATA,                             &
( 6049)                                        back_front_offset(FIELD_PRESSURE))
( 6050)     ELSE
( 6051)       CALL clover_unpack_message_front_c(chunks(chunk)%field%x_min,                    &
( 6052)                                          chunks(chunk)%field%x_max,                    &
( 6053)                                          chunks(chunk)%field%y_min,                    &
( 6054)                                          chunks(chunk)%field%y_max,                    &
( 6055)                                          chunks(chunk)%field%pressure,                 &
( 6056)                                          chunks(chunk)%front_rcv_buffer,               &
( 6057)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 6058)                                          depth, CELL_DATA,                             &
( 6059)                                          back_front_offset(FIELD_PRESSURE))
( 6060)     ENDIF
( 6061)   ENDIF
( 6062)   IF(fields(FIELD_VISCOSITY).EQ.1) THEN
( 6063)     IF(use_fortran_kernels) THEN
( 6064)       CALL clover_unpack_message_front(chunks(chunk)%field%x_min,                    &
( 6065)                                        chunks(chunk)%field%x_max,                    &
( 6066)                                        chunks(chunk)%field%y_min,                    &
( 6067)                                        chunks(chunk)%field%y_max,                    &
( 6068)                                        chunks(chunk)%field%z_min,                    &
( 6069)                                        chunks(chunk)%field%z_max,                    &
( 6070)                                        chunks(chunk)%field%viscosity,                &
( 6071)                                        chunks(chunk)%front_rcv_buffer,               &
( 6072)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 6073)                                        depth, CELL_DATA,                             &
( 6074)                                        back_front_offset(FIELD_VISCOSITY))
( 6075)     ELSE
( 6076)       CALL clover_unpack_message_front_c(chunks(chunk)%field%x_min,                    &
( 6077)                                          chunks(chunk)%field%x_max,                    &
( 6078)                                          chunks(chunk)%field%y_min,                    &
( 6079)                                          chunks(chunk)%field%y_max,                    &
( 6080)                                          chunks(chunk)%field%viscosity,                &
( 6081)                                          chunks(chunk)%front_rcv_buffer,               &
( 6082)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 106

( 6083)                                          depth, CELL_DATA,                             &
( 6084)                                          back_front_offset(FIELD_VISCOSITY))
( 6085)     ENDIF
( 6086)   ENDIF
( 6087)   IF(fields(FIELD_SOUNDSPEED).EQ.1) THEN
( 6088)     IF(use_fortran_kernels) THEN
( 6089)       CALL clover_unpack_message_front(chunks(chunk)%field%x_min,                    &
( 6090)                                        chunks(chunk)%field%x_max,                    &
( 6091)                                        chunks(chunk)%field%y_min,                    &
( 6092)                                        chunks(chunk)%field%y_max,                    &
( 6093)                                        chunks(chunk)%field%z_min,                    &
( 6094)                                        chunks(chunk)%field%z_max,                    &
( 6095)                                        chunks(chunk)%field%soundspeed,               &
( 6096)                                        chunks(chunk)%front_rcv_buffer,               &
( 6097)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 6098)                                        depth, CELL_DATA,                             &
( 6099)                                        back_front_offset(FIELD_SOUNDSPEED))
( 6100)     ELSE
( 6101)       CALL clover_unpack_message_front_c(chunks(chunk)%field%x_min,                    &
( 6102)                                          chunks(chunk)%field%x_max,                    &
( 6103)                                          chunks(chunk)%field%y_min,                    &
( 6104)                                          chunks(chunk)%field%y_max,                    &
( 6105)                                          chunks(chunk)%field%soundspeed,               &
( 6106)                                          chunks(chunk)%front_rcv_buffer,               &
( 6107)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 6108)                                          depth, CELL_DATA,                             &
( 6109)                                          back_front_offset(FIELD_SOUNDSPEED))
( 6110)     ENDIF
( 6111)   ENDIF
( 6112)   IF(fields(FIELD_XVEL0).EQ.1) THEN
( 6113)     IF(use_fortran_kernels) THEN
( 6114)       CALL clover_unpack_message_front(chunks(chunk)%field%x_min,                    &
( 6115)                                        chunks(chunk)%field%x_max,                    &
( 6116)                                        chunks(chunk)%field%y_min,                    &
( 6117)                                        chunks(chunk)%field%y_max,                    &
( 6118)                                        chunks(chunk)%field%z_min,                    &
( 6119)                                        chunks(chunk)%field%z_max,                    &
( 6120)                                        chunks(chunk)%field%xvel0,                    &
( 6121)                                        chunks(chunk)%front_rcv_buffer,               &
( 6122)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 6123)                                        depth, VERTEX_DATA,                           &
( 6124)                                        back_front_offset(FIELD_XVEL0))
( 6125)     ELSE
( 6126)       CALL clover_unpack_message_front_c(chunks(chunk)%field%x_min,                    &
( 6127)                                          chunks(chunk)%field%x_max,                    &
( 6128)                                          chunks(chunk)%field%y_min,                    &
( 6129)                                          chunks(chunk)%field%y_max,                    &
( 6130)                                          chunks(chunk)%field%xvel0,                    &
( 6131)                                          chunks(chunk)%front_rcv_buffer,               &
( 6132)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 6133)                                          depth, VERTEX_DATA,                           &
( 6134)                                          back_front_offset(FIELD_XVEL0))
( 6135)     ENDIF
( 6136)   ENDIF
( 6137)   IF(fields(FIELD_XVEL1).EQ.1) THEN
( 6138)     IF(use_fortran_kernels) THEN
( 6139)       CALL clover_unpack_message_front(chunks(chunk)%field%x_min,                    &
( 6140)                                        chunks(chunk)%field%x_max,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 107

( 6141)                                        chunks(chunk)%field%y_min,                    &
( 6142)                                        chunks(chunk)%field%y_max,                    &
( 6143)                                        chunks(chunk)%field%z_min,                    &
( 6144)                                        chunks(chunk)%field%z_max,                    &
( 6145)                                        chunks(chunk)%field%xvel1,                    &
( 6146)                                        chunks(chunk)%front_rcv_buffer,               &
( 6147)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 6148)                                        depth, VERTEX_DATA,                           &
( 6149)                                        back_front_offset(FIELD_XVEL1))
( 6150)     ELSE
( 6151)       CALL clover_unpack_message_front_c(chunks(chunk)%field%x_min,                    &
( 6152)                                          chunks(chunk)%field%x_max,                    &
( 6153)                                          chunks(chunk)%field%y_min,                    &
( 6154)                                          chunks(chunk)%field%y_max,                    &
( 6155)                                          chunks(chunk)%field%xvel1,                    &
( 6156)                                          chunks(chunk)%front_rcv_buffer,               &
( 6157)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 6158)                                          depth, VERTEX_DATA,                           &
( 6159)                                          back_front_offset(FIELD_XVEL1))
( 6160)     ENDIF
( 6161)   ENDIF
( 6162)   IF(fields(FIELD_YVEL0).EQ.1) THEN
( 6163)     IF(use_fortran_kernels) THEN
( 6164)       CALL clover_unpack_message_front(chunks(chunk)%field%x_min,                    &
( 6165)                                        chunks(chunk)%field%x_max,                    &
( 6166)                                        chunks(chunk)%field%y_min,                    &
( 6167)                                        chunks(chunk)%field%y_max,                    &
( 6168)                                        chunks(chunk)%field%z_min,                    &
( 6169)                                        chunks(chunk)%field%z_max,                    &
( 6170)                                        chunks(chunk)%field%yvel0,                    &
( 6171)                                        chunks(chunk)%front_rcv_buffer,               &
( 6172)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 6173)                                        depth, VERTEX_DATA,                           &
( 6174)                                        back_front_offset(FIELD_YVEL0))
( 6175)     ELSE
( 6176)       CALL clover_unpack_message_front_c(chunks(chunk)%field%x_min,                    &
( 6177)                                          chunks(chunk)%field%x_max,                    &
( 6178)                                          chunks(chunk)%field%y_min,                    &
( 6179)                                          chunks(chunk)%field%y_max,                    &
( 6180)                                          chunks(chunk)%field%yvel0,                    &
( 6181)                                          chunks(chunk)%front_rcv_buffer,               &
( 6182)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 6183)                                          depth, VERTEX_DATA,                           &
( 6184)                                          back_front_offset(FIELD_YVEL0))
( 6185)     ENDIF
( 6186)   ENDIF
( 6187)   IF(fields(FIELD_YVEL1).EQ.1) THEN
( 6188)     IF(use_fortran_kernels) THEN
( 6189)       CALL clover_unpack_message_front(chunks(chunk)%field%x_min,                    &
( 6190)                                        chunks(chunk)%field%x_max,                    &
( 6191)                                        chunks(chunk)%field%y_min,                    &
( 6192)                                        chunks(chunk)%field%y_max,                    &
( 6193)                                        chunks(chunk)%field%z_min,                    &
( 6194)                                        chunks(chunk)%field%z_max,                    &
( 6195)                                        chunks(chunk)%field%yvel1,                    &
( 6196)                                        chunks(chunk)%front_rcv_buffer,               &
( 6197)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 6198)                                        depth, VERTEX_DATA,                           &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 108

( 6199)                                        back_front_offset(FIELD_YVEL1))
( 6200)     ELSE
( 6201)       CALL clover_unpack_message_front_c(chunks(chunk)%field%x_min,                    &
( 6202)                                          chunks(chunk)%field%x_max,                    &
( 6203)                                          chunks(chunk)%field%y_min,                    &
( 6204)                                          chunks(chunk)%field%y_max,                    &
( 6205)                                          chunks(chunk)%field%yvel1,                    &
( 6206)                                          chunks(chunk)%front_rcv_buffer,               &
( 6207)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 6208)                                          depth, VERTEX_DATA,                           &
( 6209)                                          back_front_offset(FIELD_YVEL1))
( 6210)     ENDIF
( 6211)   ENDIF
( 6212)   IF(fields(FIELD_ZVEL0).EQ.1) THEN
( 6213)     IF(use_fortran_kernels) THEN
( 6214)       CALL clover_unpack_message_front(chunks(chunk)%field%x_min,                    &
( 6215)                                        chunks(chunk)%field%x_max,                    &
( 6216)                                        chunks(chunk)%field%y_min,                    &
( 6217)                                        chunks(chunk)%field%y_max,                    &
( 6218)                                        chunks(chunk)%field%z_min,                    &
( 6219)                                        chunks(chunk)%field%z_max,                    &
( 6220)                                        chunks(chunk)%field%zvel0,                    &
( 6221)                                        chunks(chunk)%front_rcv_buffer,               &
( 6222)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 6223)                                        depth, VERTEX_DATA,                           &
( 6224)                                        back_front_offset(FIELD_ZVEL0))
( 6225)     ELSE
( 6226)       CALL clover_unpack_message_front_c(chunks(chunk)%field%x_min,                    &
( 6227)                                          chunks(chunk)%field%x_max,                    &
( 6228)                                          chunks(chunk)%field%y_min,                    &
( 6229)                                          chunks(chunk)%field%y_max,                    &
( 6230)                                          chunks(chunk)%field%zvel0,                    &
( 6231)                                          chunks(chunk)%front_rcv_buffer,               &
( 6232)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 6233)                                          depth, VERTEX_DATA,                           &
( 6234)                                          back_front_offset(FIELD_ZVEL0))
( 6235)     ENDIF
( 6236)   ENDIF
( 6237)   IF(fields(FIELD_ZVEL1).EQ.1) THEN
( 6238)     IF(use_fortran_kernels) THEN
( 6239)       CALL clover_unpack_message_front(chunks(chunk)%field%x_min,                    &
( 6240)                                        chunks(chunk)%field%x_max,                    &
( 6241)                                        chunks(chunk)%field%y_min,                    &
( 6242)                                        chunks(chunk)%field%y_max,                    &
( 6243)                                        chunks(chunk)%field%z_min,                    &
( 6244)                                        chunks(chunk)%field%z_max,                    &
( 6245)                                        chunks(chunk)%field%zvel1,                    &
( 6246)                                        chunks(chunk)%front_rcv_buffer,               &
( 6247)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 6248)                                        depth, VERTEX_DATA,                           &
( 6249)                                        back_front_offset(FIELD_ZVEL1))
( 6250)     ELSE
( 6251)       CALL clover_unpack_message_front_c(chunks(chunk)%field%x_min,                    &
( 6252)                                          chunks(chunk)%field%x_max,                    &
( 6253)                                          chunks(chunk)%field%y_min,                    &
( 6254)                                          chunks(chunk)%field%y_max,                    &
( 6255)                                          chunks(chunk)%field%zvel1,                    &
( 6256)                                          chunks(chunk)%front_rcv_buffer,               &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 109

( 6257)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 6258)                                          depth, VERTEX_DATA,                           &
( 6259)                                          back_front_offset(FIELD_ZVEL1))
( 6260)     ENDIF
( 6261)   ENDIF
( 6262)   IF(fields(FIELD_VOL_FLUX_X).EQ.1) THEN
( 6263)     IF(use_fortran_kernels) THEN
( 6264)       CALL clover_unpack_message_front(chunks(chunk)%field%x_min,                    &
( 6265)                                        chunks(chunk)%field%x_max,                    &
( 6266)                                        chunks(chunk)%field%y_min,                    &
( 6267)                                        chunks(chunk)%field%y_max,                    &
( 6268)                                        chunks(chunk)%field%z_min,                    &
( 6269)                                        chunks(chunk)%field%z_max,                    &
( 6270)                                        chunks(chunk)%field%vol_flux_x,               &
( 6271)                                        chunks(chunk)%front_rcv_buffer,               &
( 6272)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 6273)                                        depth, X_FACE_DATA,                           &
( 6274)                                        back_front_offset(FIELD_VOL_FLUX_X))
( 6275)     ELSE
( 6276)       CALL clover_unpack_message_front_c(chunks(chunk)%field%x_min,                    &
( 6277)                                          chunks(chunk)%field%x_max,                    &
( 6278)                                          chunks(chunk)%field%y_min,                    &
( 6279)                                          chunks(chunk)%field%y_max,                    &
( 6280)                                          chunks(chunk)%field%vol_flux_x,               &
( 6281)                                          chunks(chunk)%front_rcv_buffer,               &
( 6282)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 6283)                                          depth, X_FACE_DATA,                           &
( 6284)                                          back_front_offset(FIELD_VOL_FLUX_X))
( 6285)     ENDIF
( 6286)   ENDIF
( 6287)   IF(fields(FIELD_VOL_FLUX_Y).EQ.1) THEN
( 6288)     IF(use_fortran_kernels) THEN
( 6289)       CALL clover_unpack_message_front(chunks(chunk)%field%x_min,                    &
( 6290)                                        chunks(chunk)%field%x_max,                    &
( 6291)                                        chunks(chunk)%field%y_min,                    &
( 6292)                                        chunks(chunk)%field%y_max,                    &
( 6293)                                        chunks(chunk)%field%z_min,                    &
( 6294)                                        chunks(chunk)%field%z_max,                    &
( 6295)                                        chunks(chunk)%field%vol_flux_y,               &
( 6296)                                        chunks(chunk)%front_rcv_buffer,               &
( 6297)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 6298)                                        depth, Y_FACE_DATA,                           &
( 6299)                                        back_front_offset(FIELD_VOL_FLUX_Y))
( 6300)     ELSE
( 6301)       CALL clover_unpack_message_front_c(chunks(chunk)%field%x_min,                    &
( 6302)                                          chunks(chunk)%field%x_max,                    &
( 6303)                                          chunks(chunk)%field%y_min,                    &
( 6304)                                          chunks(chunk)%field%y_max,                    &
( 6305)                                          chunks(chunk)%field%vol_flux_y,               &
( 6306)                                          chunks(chunk)%front_rcv_buffer,               &
( 6307)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 6308)                                          depth, Y_FACE_DATA,                           &
( 6309)                                          back_front_offset(FIELD_VOL_FLUX_Y))
( 6310)     ENDIF
( 6311)   ENDIF
( 6312)   IF(fields(FIELD_VOL_FLUX_Z).EQ.1) THEN
( 6313)     IF(use_fortran_kernels) THEN
( 6314)       CALL clover_unpack_message_front(chunks(chunk)%field%x_min,                    &






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 110

( 6315)                                        chunks(chunk)%field%x_max,                    &
( 6316)                                        chunks(chunk)%field%y_min,                    &
( 6317)                                        chunks(chunk)%field%y_max,                    &
( 6318)                                        chunks(chunk)%field%z_min,                    &
( 6319)                                        chunks(chunk)%field%z_max,                    &
( 6320)                                        chunks(chunk)%field%vol_flux_z,               &
( 6321)                                        chunks(chunk)%front_rcv_buffer,               &
( 6322)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 6323)                                        depth, Z_FACE_DATA,                           &
( 6324)                                        back_front_offset(FIELD_VOL_FLUX_Z))
( 6325)     ELSE
( 6326)       CALL clover_unpack_message_front_c(chunks(chunk)%field%x_min,                    &
( 6327)                                          chunks(chunk)%field%x_max,                    &
( 6328)                                          chunks(chunk)%field%y_min,                    &
( 6329)                                          chunks(chunk)%field%y_max,                    &
( 6330)                                          chunks(chunk)%field%vol_flux_z,               &
( 6331)                                          chunks(chunk)%front_rcv_buffer,               &
( 6332)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 6333)                                          depth, Z_FACE_DATA,                           &
( 6334)                                          back_front_offset(FIELD_VOL_FLUX_Z))
( 6335)     ENDIF
( 6336)   ENDIF
( 6337)   IF(fields(FIELD_MASS_FLUX_X).EQ.1) THEN
( 6338)     IF(use_fortran_kernels) THEN
( 6339)       CALL clover_unpack_message_front(chunks(chunk)%field%x_min,                    &
( 6340)                                        chunks(chunk)%field%x_max,                    &
( 6341)                                        chunks(chunk)%field%y_min,                    &
( 6342)                                        chunks(chunk)%field%y_max,                    &
( 6343)                                        chunks(chunk)%field%z_min,                    &
( 6344)                                        chunks(chunk)%field%z_max,                    &
( 6345)                                        chunks(chunk)%field%mass_flux_x,              &
( 6346)                                        chunks(chunk)%front_rcv_buffer,               &
( 6347)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 6348)                                        depth, X_FACE_DATA,                           &
( 6349)                                        back_front_offset(FIELD_MASS_FLUX_X))
( 6350)     ELSE
( 6351)       CALL clover_unpack_message_front_c(chunks(chunk)%field%x_min,                    &
( 6352)                                          chunks(chunk)%field%x_max,                    &
( 6353)                                          chunks(chunk)%field%y_min,                    &
( 6354)                                          chunks(chunk)%field%y_max,                    &
( 6355)                                          chunks(chunk)%field%mass_flux_x,              &
( 6356)                                          chunks(chunk)%front_rcv_buffer,               &
( 6357)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 6358)                                          depth, X_FACE_DATA,                           &
( 6359)                                          back_front_offset(FIELD_MASS_FLUX_X))
( 6360)     ENDIF
( 6361)   ENDIF
( 6362)   IF(fields(FIELD_MASS_FLUX_Y).EQ.1) THEN
( 6363)     IF(use_fortran_kernels) THEN
( 6364)       CALL clover_unpack_message_front(chunks(chunk)%field%x_min,                    &
( 6365)                                        chunks(chunk)%field%x_max,                    &
( 6366)                                        chunks(chunk)%field%y_min,                    &
( 6367)                                        chunks(chunk)%field%y_max,                    &
( 6368)                                        chunks(chunk)%field%z_min,                    &
( 6369)                                        chunks(chunk)%field%z_max,                    &
( 6370)                                        chunks(chunk)%field%mass_flux_y,              &
( 6371)                                        chunks(chunk)%front_rcv_buffer,               &
( 6372)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 111

( 6373)                                        depth, Y_FACE_DATA,                           &
( 6374)                                        back_front_offset(FIELD_MASS_FLUX_Y))
( 6375)     ELSE
( 6376)       CALL clover_unpack_message_front_c(chunks(chunk)%field%x_min,                    &
( 6377)                                          chunks(chunk)%field%x_max,                    &
( 6378)                                          chunks(chunk)%field%y_min,                    &
( 6379)                                          chunks(chunk)%field%y_max,                    &
( 6380)                                          chunks(chunk)%field%mass_flux_y,              &
( 6381)                                          chunks(chunk)%front_rcv_buffer,               &
( 6382)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 6383)                                          depth, Y_FACE_DATA,                           &
( 6384)                                          back_front_offset(FIELD_MASS_FLUX_Y))
( 6385)     ENDIF
( 6386)   ENDIF
( 6387)   IF(fields(FIELD_MASS_FLUX_Z).EQ.1) THEN
( 6388)     IF(use_fortran_kernels) THEN
( 6389)       CALL clover_unpack_message_front(chunks(chunk)%field%x_min,                    &
( 6390)                                        chunks(chunk)%field%x_max,                    &
( 6391)                                        chunks(chunk)%field%y_min,                    &
( 6392)                                        chunks(chunk)%field%y_max,                    &
( 6393)                                        chunks(chunk)%field%z_min,                    &
( 6394)                                        chunks(chunk)%field%z_max,                    &
( 6395)                                        chunks(chunk)%field%mass_flux_z,              &
( 6396)                                        chunks(chunk)%front_rcv_buffer,               &
( 6397)                                        CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA,&
( 6398)                                        depth, Z_FACE_DATA,                           &
( 6399)                                        back_front_offset(FIELD_MASS_FLUX_Z))
( 6400)     ELSE
( 6401)       CALL clover_unpack_message_front_c(chunks(chunk)%field%x_min,                    &
( 6402)                                          chunks(chunk)%field%x_max,                    &
( 6403)                                          chunks(chunk)%field%y_min,                    &
( 6404)                                          chunks(chunk)%field%y_max,                    &
( 6405)                                          chunks(chunk)%field%mass_flux_z,              &
( 6406)                                          chunks(chunk)%front_rcv_buffer,               &
( 6407)                                          CELL_DATA,VERTEX_DATA,X_FACE_DATA,Y_FACE_DATA,Z_FACE_DATA, &
( 6408)                                          depth, Z_FACE_DATA,                           &
( 6409)                                          back_front_offset(FIELD_MASS_FLUX_Z))
( 6410)     ENDIF
( 6411)   ENDIF
( 6412) 
( 6413) END SUBROUTINE clover_unpack_front
( 6414) 
( 6415) SUBROUTINE clover_sum(value)
( 6416) 
( 6417)   ! Only sums to the master
( 6418) 
( 6419)   IMPLICIT NONE
( 6420) 
( 6421)   REAL(KIND=8) :: value
( 6422) 
( 6423)   REAL(KIND=8) :: total
( 6424) 
( 6425)   INTEGER :: err
( 6426) 
( 6427)   total=value
( 6428) 
( 6429)   CALL MPI_REDUCE(value,total,1,MPI_DOUBLE_PRECISION,MPI_SUM,0,MPI_COMM_WORLD,err)
( 6430) 






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 112

( 6431)   value=total
( 6432) 
( 6433) END SUBROUTINE clover_sum
( 6434) 
( 6435) SUBROUTINE clover_min(value)
( 6436) 
( 6437)   IMPLICIT NONE
( 6438) 
( 6439)   REAL(KIND=8) :: value
( 6440) 
( 6441)   REAL(KIND=8) :: minimum
( 6442) 
( 6443)   INTEGER :: err
( 6444) 
( 6445)   minimum=value
( 6446) 
( 6447)   CALL MPI_ALLREDUCE(value,minimum,1,MPI_DOUBLE_PRECISION,MPI_MIN,MPI_COMM_WORLD,err)
( 6448) 
( 6449)   value=minimum
( 6450) 
( 6451) END SUBROUTINE clover_min
( 6452) 
( 6453) SUBROUTINE clover_max(value)
( 6454) 
( 6455)   IMPLICIT NONE
( 6456) 
( 6457)   REAL(KIND=8) :: value
( 6458) 
( 6459)   REAL(KIND=8) :: maximum
( 6460) 
( 6461)   INTEGER :: err
( 6462) 
( 6463)   maximum=value
( 6464) 
( 6465)   CALL MPI_ALLREDUCE(value,maximum,1,MPI_DOUBLE_PRECISION,MPI_MAX,MPI_COMM_WORLD,err)
( 6466) 
( 6467)   value=maximum
( 6468) 
( 6469) END SUBROUTINE clover_max
( 6470) 
( 6471) SUBROUTINE clover_allgather(value,values)
( 6472) 
( 6473)   IMPLICIT NONE
( 6474) 
( 6475)   REAL(KIND=8) :: value
( 6476) 
( 6477)   REAL(KIND=8) :: values(parallel%max_task)
( 6478) 
( 6479)   INTEGER :: err
( 6480) 
( 6481)   values(1)=value ! Just to ensure it will work in serial
( 6482) 
( 6483)   CALL MPI_ALLGATHER(value,1,MPI_DOUBLE_PRECISION,values,1,MPI_DOUBLE_PRECISION,MPI_COMM_WORLD,err)
( 6484) 
( 6485) END SUBROUTINE clover_allgather
( 6486) 
( 6487) SUBROUTINE clover_check_error(error)
( 6488) 






PGF90 (Version     13.5)          07/18/2014  14:45:11      page 113

( 6489)   IMPLICIT NONE
( 6490) 
( 6491)   INTEGER :: error
( 6492) 
( 6493)   INTEGER :: maximum
( 6494) 
( 6495)   INTEGER :: err
( 6496) 
( 6497)   maximum=error
( 6498) 
( 6499)   CALL MPI_ALLREDUCE(error,maximum,1,MPI_INTEGER,MPI_MAX,MPI_COMM_WORLD,err)
( 6500) 
( 6501)   error=maximum
( 6502) 
( 6503) END SUBROUTINE clover_check_error
( 6504) 
( 6505) 
( 6506) END MODULE clover_module
